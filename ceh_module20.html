<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH v13 Module 20: Cryptography</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --background-color: #ecf0f1;
            --text-color: #2c3e50;
            --card-background: #ffffff;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 40px 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 5px;
            margin: 20px auto;
            max-width: 400px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #00f2fe, #4facfe);
            height: 30px;
            border-radius: 20px;
            width: 0%;
            transition: all 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .navigation {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .nav-btn {
            background: var(--card-background);
            color: var(--text-color);
            border: 2px solid transparent;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .nav-btn.active {
            background: var(--gradient-primary);
            color: white;
            border-color: var(--secondary-color);
        }

        .content-area {
            background: var(--card-background);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .module-section {
            display: none;
        }

        .module-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 25px;
            border-bottom: 3px solid var(--secondary-color);
            padding-bottom: 10px;
        }

        .card {
            background: var(--card-background);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 4px solid var(--secondary-color);
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .highlight-card {
            background: var(--gradient-secondary);
            color: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .algorithm-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
        }

        .algorithm-card h4 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-radius: 10px;
            overflow: hidden;
        }

        .comparison-table th {
            background: var(--gradient-primary);
            color: white;
            padding: 15px;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            background: white;
        }

        .comparison-table tr:hover td {
            background: #f8f9fa;
        }

        .quiz-container {
            background: var(--card-background);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid var(--secondary-color);
        }

        .question {
            margin-bottom: 20px;
        }

        .question h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .option:hover {
            background: #e9ecef;
            border-color: var(--secondary-color);
        }

        .option.selected {
            background: var(--secondary-color);
            color: white;
        }

        .option.correct {
            background: var(--success-color);
            color: white;
        }

        .option.incorrect {
            background: var(--accent-color);
            color: white;
        }

        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: var(--gradient-success);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: var(--card-background);
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: modalFade 0.3s ease;
        }

        @keyframes modalFade {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .close {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            color: var(--accent-color);
        }

        .close:hover {
            transform: scale(1.2);
        }

        .lab-exercise {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.1), rgba(52, 152, 219, 0.1));
            border: 2px solid var(--success-color);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }

        .warning-box {
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.1), rgba(230, 126, 34, 0.1));
            border: 2px solid var(--warning-color);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }

        .key-concepts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .concept-card {
            background: var(--gradient-primary);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .crypto-visual {
            background: #f8f9fa;
            border: 2px solid var(--secondary-color);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .navigation {
                flex-direction: column;
                align-items: center;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
            }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--warning-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔐 CEH v13 Module 20: Cryptography</h1>
            <p>Advanced Cryptographic Systems & Modern Security</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <p id="progressText">Progress: 0% Complete</p>
            <div style="margin-top: 15px; font-size: 0.9em; color: rgba(255,255,255,0.8);">
                <span style="background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; margin: 0 5px;">
                    ← → Navigate Sections
                </span>
                <span style="background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; margin: 0 5px;">
                    Esc Close Modal
                </span>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('overview')">📋 Overview</button>
            <button class="nav-btn" onclick="showSection('fundamentals')">🔑 Fundamentals</button>
            <button class="nav-btn" onclick="showSection('symmetric')">⚖️ Symmetric</button>
            <button class="nav-btn" onclick="showSection('asymmetric')">🔐 Asymmetric</button>
            <button class="nav-btn" onclick="showSection('hashing')">🔗 Hashing</button>
            <button class="nav-btn" onclick="showSection('pki')">🏛️ PKI</button>
            <button class="nav-btn" onclick="showSection('modern-crypto')">🚀 Modern Crypto</button>
            <button class="nav-btn" onclick="showSection('attacks')">⚔️ Attacks</button>
            <button class="nav-btn" onclick="showSection('tools')">🔧 Tools</button>
            <button class="nav-btn" onclick="showSection('quiz')">📝 Assessment</button>
        </div>

        <div class="content-area">
            <!-- Overview Section -->
            <div id="overview" class="module-section active">
                <h2 class="section-title">🎯 Module 20 Overview</h2>
                
                <div class="card">
                    <h3>🔐 Cryptography: The Guardian of Digital Security</h3>
                    <p>At its core, cryptography involves safeguarding information by transforming it into a code that only the designated recipient can decipher. In today's interconnected world, where Cybersecurity Ventures predicts that cybercrime will inflict damages worth $10.5 trillion annually by 2025, cryptography stands as our most crucial defense mechanism.</p>
                </div>

                <div class="grid">
                    <div class="highlight-card">
                        <h4>🎓 Learning Objectives</h4>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li>Master symmetric and asymmetric encryption</li>
                            <li>Understand cryptographic hash functions</li>
                            <li>Explore Public Key Infrastructure (PKI)</li>
                            <li>Analyze quantum cryptography threats</li>
                            <li>Implement modern cryptographic solutions</li>
                        </ul>
                    </div>
                    
                    <div class="highlight-card">
                        <h4>📊 Module Statistics</h4>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li>⏱️ Estimated Time: 3+ hours</li>
                            <li>🔧 20+ Cryptographic Tools</li>
                            <li>📝 30 Assessment Questions</li>
                            <li>🧪 8 Practical Exercises</li>
                            <li>🎯 15 Key Algorithms</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3>📚 Historical Evolution of Cryptography</h3>
                    <div class="crypto-visual">
                        <p><strong>Ancient Era → Classical Era → Modern Era → Quantum Era</strong></p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0;">
                            <div style="padding: 15px; background: #e8f4f8; border-radius: 8px;">
                                <h5>🏺 Ancient</h5>
                                <p>Egyptian Hieroglyphics<br>Caesar Cipher</p>
                            </div>
                            <div style="padding: 15px; background: #f0e8f8; border-radius: 8px;">
                                <h5>⚙️ Classical</h5>
                                <p>Enigma Machine<br>World War II Era</p>
                            </div>
                            <div style="padding: 15px; background: #e8f8f0; border-radius: 8px;">
                                <h5>💻 Modern</h5>
                                <p>DES, AES<br>RSA Algorithm</p>
                            </div>
                            <div style="padding: 15px; background: #f8f0e8; border-radius: 8px;">
                                <h5>🚀 Quantum</h5>
                                <p>Post-Quantum<br>Quantum-Safe</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="key-concepts">
                    <div class="concept-card">
                        <h4>🔒 Confidentiality</h4>
                        <p>Ensuring data remains private and accessible only to authorized parties</p>
                    </div>
                    <div class="concept-card">
                        <h4>✅ Integrity</h4>
                        <p>Guaranteeing data hasn't been altered during transmission or storage</p>
                    </div>
                    <div class="concept-card">
                        <h4>🔍 Authentication</h4>
                        <p>Verifying the identity of users, systems, and data sources</p>
                    </div>
                    <div class="concept-card">
                        <h4>📄 Non-Repudiation</h4>
                        <p>Preventing denial of actions or transactions by involved parties</p>
                    </div>
                </div>
            </div>

            <!-- Fundamentals Section -->
            <div id="fundamentals" class="module-section">
                <h2 class="section-title">🔑 Cryptographic Fundamentals</h2>
                
                <div class="card">
                    <h3>🧭 Core Cryptographic Principles</h3>
                    <p>Cryptography relies on mathematical algorithms and computational complexity to secure information. Understanding these foundational principles is essential for implementing effective security measures.</p>
                    
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔄 Diffusion</h4>
                            <p>Spreading the influence of plaintext bits across ciphertext bits to hide statistical relationships</p>
                        </div>
                        <div class="algorithm-card">
                            <h4>🌪️ Confusion</h4>
                            <p>Making the relationship between ciphertext and key as complex as possible</p>
                        </div>
                        <div class="algorithm-card">
                            <h4>🔑 Kerckhoff's Principle</h4>
                            <p>Security should depend only on the secrecy of the key, not the algorithm</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>📊 Cryptographic Classifications</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Classification</th>
                                <th>Description</th>
                                <th>Examples</th>
                                <th>Use Cases</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Stream Ciphers</strong></td>
                                <td>Encrypt data bit by bit or byte by byte</td>
                                <td>RC4, ChaCha20</td>
                                <td>Real-time communications</td>
                            </tr>
                            <tr>
                                <td><strong>Block Ciphers</strong></td>
                                <td>Encrypt fixed-size blocks of data</td>
                                <td>AES, DES, 3DES</td>
                                <td>File encryption, databases</td>
                            </tr>
                            <tr>
                                <td><strong>Hash Functions</strong></td>
                                <td>One-way functions producing fixed output</td>
                                <td>SHA-256, MD5</td>
                                <td>Digital signatures, integrity</td>
                            </tr>
                            <tr>
                                <td><strong>Key Exchange</strong></td>
                                <td>Secure methods for sharing keys</td>
                                <td>Diffie-Hellman, ECDH</td>
                                <td>Establishing secure channels</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="warning-box">
                    <h4>⚠️ Common Cryptographic Vulnerabilities</h4>
                    <ul>
                        <li><strong>Weak Key Generation:</strong> Using predictable or insufficient entropy</li>
                        <li><strong>Poor Key Management:</strong> Inadequate storage or rotation practices</li>
                        <li><strong>Implementation Flaws:</strong> Side-channel attacks and timing vulnerabilities</li>
                        <li><strong>Algorithm Weaknesses:</strong> Using deprecated or broken algorithms</li>
                    </ul>
                </div>
            </div>

            <!-- Symmetric Cryptography Section -->
            <div id="symmetric" class="module-section">
                <h2 class="section-title">⚖️ Symmetric Cryptography</h2>
                
                <div class="card">
                    <h3>🔑 Symmetric Encryption Overview</h3>
                    <p>This approach relies on a single key for both encrypting and decrypting data. Symmetric encryption is faster and more efficient than asymmetric encryption, making it ideal for encrypting large amounts of data.</p>
                    
                    <div class="crypto-visual">
                        <h4>🔄 Symmetric Encryption Process</h4>
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0;">
                            <div style="padding: 15px; background: #e3f2fd; border-radius: 10px; border: 2px solid #2196f3;">
                                <strong>Plaintext</strong><br>Original Data
                            </div>
                            <span style="font-size: 2em;">➡️</span>
                            <div style="padding: 15px; background: #fff3e0; border-radius: 10px; border: 2px solid #ff9800;">
                                <strong>Key + Algorithm</strong><br>Encryption Process
                            </div>
                            <span style="font-size: 2em;">➡️</span>
                            <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; border: 2px solid #9c27b0;">
                                <strong>Ciphertext</strong><br>Encrypted Data
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🛡️ Major Symmetric Algorithms</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔐 AES (Advanced Encryption Standard)</h4>
                            <p><strong>Key Sizes:</strong> 128, 192, 256 bits<br>
                            <strong>Block Size:</strong> 128 bits<br>
                            <strong>Status:</strong> Current standard, quantum-resistant with 256-bit keys</p>
                            <p><em>Most widely used encryption algorithm worldwide</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔒 DES (Data Encryption Standard)</h4>
                            <p><strong>Key Size:</strong> 56 bits<br>
                            <strong>Block Size:</strong> 64 bits<br>
                            <strong>Status:</strong> Deprecated due to small key size</p>
                            <p><em>Historical importance but no longer secure</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔐 3DES (Triple DES)</h4>
                            <p><strong>Key Size:</strong> 112 or 168 bits<br>
                            <strong>Block Size:</strong> 64 bits<br>
                            <strong>Status:</strong> Being phased out</p>
                            <p><em>Applies DES algorithm three times</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🚀 ChaCha20</h4>
                            <p><strong>Type:</strong> Stream cipher<br>
                            <strong>Key Size:</strong> 256 bits<br>
                            <strong>Status:</strong> Modern, high-performance</p>
                            <p><em>Excellent for mobile and IoT devices</em></p>
                        </div>
                    </div>
                </div>

                <div class="lab-exercise">
                    <h4>🧪 Practical Exercise: AES Encryption</h4>
                    <p><strong>Objective:</strong> Implement AES encryption with different key sizes</p>
                    <ol>
                        <li>Generate AES keys of 128, 192, and 256 bits</li>
                        <li>Encrypt sample data using each key size</li>
                        <li>Compare performance and security implications</li>
                        <li>Test different modes of operation (CBC, GCM)</li>
                    </ol>
                    <p><strong>Tools Required:</strong> OpenSSL, Python cryptography library</p>
                </div>
            </div>

            <!-- Asymmetric Cryptography Section -->
            <div id="asymmetric" class="module-section">
                <h2 class="section-title">🔐 Asymmetric Cryptography</h2>
                
                <div class="card">
                    <h3>🔑 Public Key Cryptography</h3>
                    <p>This approach uses a pair of keys: one a public key to lock the information and a private key to unlock it. If you've ever visited an HTTPS website, you've used asymmetric encryption.</p>
                    
                    <div class="crypto-visual">
                        <h4>🔐 Asymmetric Encryption Process</h4>
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 15px;">
                                <div style="padding: 15px; background: #e8f5e8; border-radius: 10px;">
                                    <strong>🔑 Public Key</strong><br>Freely shared
                                </div>
                                <div style="padding: 15px; background: #f5e8e8; border-radius: 10px;">
                                    <strong>🗝️ Private Key</strong><br>Kept secret
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <p><strong>Encryption:</strong> Public Key → Ciphertext</p>
                                <p><strong>Decryption:</strong> Private Key → Plaintext</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🛡️ Major Asymmetric Algorithms</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔐 RSA (Rivest-Shamir-Adleman)</h4>
                            <p><strong>Key Sizes:</strong> 1024, 2048, 3072, 4096 bits<br>
                            <strong>Security:</strong> Based on integer factorization<br>
                            <strong>Uses:</strong> Digital signatures, key exchange</p>
                            <p><em>Used in secure emails and digital signatures</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔒 ECC (Elliptic Curve Cryptography)</h4>
                            <p><strong>Key Sizes:</strong> 256, 384, 521 bits<br>
                            <strong>Security:</strong> Elliptic curve discrete logarithm<br>
                            <strong>Advantage:</strong> Strong encryption with smaller key sizes</p>
                            <p><em>Ideal for mobile and IoT applications</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🤝 Diffie-Hellman</h4>
                            <p><strong>Purpose:</strong> Key exchange protocol<br>
                            <strong>Security:</strong> Discrete logarithm problem<br>
                            <strong>Variant:</strong> ECDH (Elliptic Curve Diffie-Hellman)</p>
                            <p><em>Foundation of secure communication</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>✍️ DSA (Digital Signature Algorithm)</h4>
                            <p><strong>Purpose:</strong> Digital signatures only<br>
                            <strong>Key Size:</strong> 1024-3072 bits<br>
                            <strong>Standard:</strong> FIPS 186-4</p>
                            <p><em>Government standard for digital signatures</em></p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>⚖️ Symmetric vs Asymmetric Comparison</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>Symmetric</th>
                                <th>Asymmetric</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Key Management</strong></td>
                                <td>Single shared key</td>
                                <td>Public/private key pairs</td>
                            </tr>
                            <tr>
                                <td><strong>Speed</strong></td>
                                <td>Fast (1000x faster)</td>
                                <td>Slower</td>
                            </tr>
                            <tr>
                                <td><strong>Key Distribution</strong></td>
                                <td>Challenging</td>
                                <td>Easy (public key)</td>
                            </tr>
                            <tr>
                                <td><strong>Scalability</strong></td>
                                <td>n(n-1)/2 keys</td>
                                <td>2n keys</td>
                            </tr>
                            <tr>
                                <td><strong>Digital Signatures</strong></td>
                                <td>Not directly supported</td>
                                <td>Native support</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="warning-box">
                    <h4>⚠️ Quantum Computing Threat</h4>
                    <p>Most widely used public-key algorithms rely on the difficulty of one of three mathematical problems: the integer factorization problem, the discrete logarithm problem or the elliptic-curve discrete logarithm problem. All of these problems could be easily solved on a sufficiently powerful quantum computer running Shor's algorithm.</p>
                    <ul>
                        <li><strong>Current Impact:</strong> No immediate threat (quantum computers still experimental)</li>
                        <li><strong>Future Concern:</strong> "Harvest now, decrypt later" attacks</li>
                        <li><strong>Solution:</strong> Post-quantum cryptography development</li>
                    </ul>
                </div>
            </div>

            <!-- Hashing Section -->
            <div id="hashing" class="module-section">
                <h2 class="section-title">🔗 Cryptographic Hash Functions</h2>
                
                <div class="card">
                    <h3>🔍 Hash Function Fundamentals</h3>
                    <p>Unlike encryption, hashing converts data into a fixed-size hash code through a one-way process that cannot be reversed. Hash functions are essential for data integrity, password storage, and digital signatures.</p>
                    
                    <div class="crypto-visual">
                        <h4>🔗 Hash Function Properties</h4>
                        <div class="key-concepts">
                            <div class="concept-card">
                                <h5>📏 Fixed Output</h5>
                                <p>Always produces same size output regardless of input size</p>
                            </div>
                            <div class="concept-card">
                                <h5>⚡ Deterministic</h5>
                                <p>Same input always produces same output</p>
                            </div>
                            <div class="concept-card">
                                <h5>🌊 Avalanche Effect</h5>
                                <p>Small input change dramatically changes output</p>
                            </div>
                            <div class="concept-card">
                                <h5>🔒 One-Way</h5>
                                <p>Computationally infeasible to reverse</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🏆 Major Hash Algorithms</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔐 SHA-256</h4>
                            <p><strong>Output Size:</strong> 256 bits<br>
                            <strong>Security:</strong> Cryptographically secure<br>
                            <strong>Uses:</strong> A pillar of blockchain security</p>
                            <p><em>Current standard for secure hashing</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔒 SHA-3</h4>
                            <p><strong>Output Size:</strong> Variable (224-512 bits)<br>
                            <strong>Algorithm:</strong> Keccak sponge function<br>
                            <strong>Status:</strong> Latest NIST standard</p>
                            <p><em>Alternative to SHA-2 family</em></p>
                        </div>
                        
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            <h4>⚠️ MD5</h4>
                            <p><strong>Output Size:</strong> 128 bits<br>
                            <strong>Security:</strong> BROKEN - Vulnerable to collisions<br>
                            <strong>Status:</strong> Deprecated for security use</p>
                            <p><em>Use only for non-cryptographic purposes</em></p>
                        </div>
                        
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                            <h4>⚠️ SHA-1</h4>
                            <p><strong>Output Size:</strong> 160 bits<br>
                            <strong>Security:</strong> Deprecated since 2017<br>
                            <strong>Status:</strong> Collision attacks demonstrated</p>
                            <p><em>Legacy systems only</em></p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🛡️ HMAC (Hash-based Message Authentication Code)</h3>
                    <p>HMAC combines a hash function with a secret key to provide both data integrity and authentication.</p>
                    
                    <div class="crypto-visual">
                        <p><strong>HMAC Formula:</strong> HMAC(K, m) = H((K ⊕ opad) || H((K ⊕ ipad) || m))</p>
                        <ul style="text-align: left; margin: 20px 0;">
                            <li><strong>K:</strong> Secret key</li>
                            <li><strong>m:</strong> Message</li>
                            <li><strong>H:</strong> Hash function (e.g., SHA-256)</li>
                            <li><strong>opad/ipad:</strong> Outer/inner padding</li>
                        </ul>
                    </div>
                </div>

                <div class="lab-exercise">
                    <h4>🧪 Practical Exercise: Hash Function Analysis</h4>
                    <p><strong>Objective:</strong> Demonstrate hash function properties and vulnerabilities</p>
                    <ol>
                        <li>Generate SHA-256 hashes for various inputs</li>
                        <li>Demonstrate avalanche effect with similar inputs</li>
                        <li>Compare MD5 vs SHA-256 collision resistance</li>
                        <li>Implement HMAC for message authentication</li>
                        <li>Test rainbow table attacks on unsalted hashes</li>
                    </ol>
                </div>
            </div>

            <!-- PKI Section -->
            <div id="pki" class="module-section">
                <h2 class="section-title">🏛️ Public Key Infrastructure (PKI)</h2>
                
                <div class="card">
                    <h3>🏢 PKI Architecture</h3>
                    <p>A set of hardware, software, people, policies, and procedures required to create, manage, distribute, use, store, and revoke digital certificates and manage public-key encryption infrastructure.</p>
                    
                    <div class="crypto-visual">
                        <h4>🏗️ PKI Components</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="padding: 15px; background: #e3f2fd; border-radius: 10px; text-align: center;">
                                <h5>🏛️ Certificate Authority (CA)</h5>
                                <p>Issues and manages certificates</p>
                            </div>
                            <div style="padding: 15px; background: #f3e5f5; border-radius: 10px; text-align: center;">
                                <h5>📋 Registration Authority (RA)</h5>
                                <p>Verifies certificate requests</p>
                            </div>
                            <div style="padding: 15px; background: #e8f5e8; border-radius: 10px; text-align: center;">
                                <h5>📜 Digital Certificates</h5>
                                <p>Bind public keys to identities</p>
                            </div>
                            <div style="padding: 15px; background: #fff3e0; border-radius: 10px; text-align: center;">
                                <h5>📁 Certificate Repository</h5>
                                <p>Stores and distributes certificates</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>📜 Digital Certificates (X.509)</h3>
                    <p>Digital certificates are electronic documents that use a digital signature to bind a public key with an identity.</p>
                    
                    <div class="crypto-visual">
                        <h4>📋 Certificate Contents</h4>
                        <ul style="text-align: left; columns: 2; gap: 30px;">
                            <li>Certificate version</li>
                            <li>Serial number</li>
                            <li>Signature algorithm</li>
                            <li>Issuer name</li>
                            <li>Validity period</li>
                            <li>Subject name</li>
                            <li>Subject public key</li>
                            <li>Extensions</li>
                            <li>Certificate signature</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3>🔍 Certificate Validation</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>📋 CRL (Certificate Revocation List)</h4>
                            <p><strong>Method:</strong> Periodic list publication<br>
                            <strong>Pros:</strong> Simple, comprehensive<br>
                            <strong>Cons:</strong> Large size, update delays</p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔍 OCSP (Online Certificate Status Protocol)</h4>
                            <p><strong>Method:</strong> Real-time status queries<br>
                            <strong>Pros:</strong> Current status, efficient<br>
                            <strong>Cons:</strong> Dependency on OCSP responder</p>
                        </div>
                    </div>
                </div>

                <div class="lab-exercise">
                    <h4>🧪 Practical Exercise: PKI Implementation</h4>
                    <p><strong>Objective:</strong> Set up and manage a basic PKI infrastructure</p>
                    <ol>
                        <li>Create a root CA and intermediate CA</li>
                        <li>Generate server and client certificates</li>
                        <li>Implement certificate validation</li>
                        <li>Test certificate revocation (CRL/OCSP)</li>
                        <li>Configure SSL/TLS with custom certificates</li>
                    </ol>
                </div>
            </div>

            <!-- Modern Cryptography Section -->
            <div id="modern-crypto" class="module-section">
                <h2 class="section-title">🚀 Modern Cryptographic Technologies</h2>
                
                <div class="card">
                    <h3>⚛️ Quantum Cryptography</h3>
                    <p>Based on quantum mechanics, such as quantum key distribution (QKD), quantum cryptography leverages the principles of quantum physics to provide theoretically unbreakable security.</p>
                    
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔑 Quantum Key Distribution (QKD)</h4>
                            <p><strong>Principle:</strong> Quantum entanglement and no-cloning theorem<br>
                            <strong>Security:</strong> Eavesdropping detectable<br>
                            <strong>Limitation:</strong> Distance and infrastructure requirements</p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🛡️ Post-Quantum Cryptography</h4>
                            <p><strong>Purpose:</strong> Quantum-resistant algorithms<br>
                            <strong>NIST Standards:</strong> CRYSTALS-Kyber, Falcon and CRYSTALS-Dilithium<br>
                            <strong>Timeline:</strong> Standardization completed 2024</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>⛓️ Blockchain Cryptography</h3>
                    <p>Blockchain technology relies heavily on cryptographic primitives to ensure security, immutability, and consensus.</p>
                    
                    <div class="crypto-visual">
                        <h4>🔗 Blockchain Cryptographic Components</h4>
                        <div class="key-concepts">
                            <div class="concept-card">
                                <h5>🔗 Hash Chaining</h5>
                                <p>Links blocks using cryptographic hashes</p>
                            </div>
                            <div class="concept-card">
                                <h5>🔐 Digital Signatures</h5>
                                <p>Verify transaction authenticity</p>
                            </div>
                            <div class="concept-card">
                                <h5>🏗️ Merkle Trees</h5>
                                <p>Efficient transaction verification</p>
                            </div>
                            <div class="concept-card">
                                <h5>⚡ Proof of Work</h5>
                                <p>Consensus mechanism security</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🔒 Advanced Encryption Techniques</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🧮 Homomorphic Encryption</h4>
                            <p><strong>Capability:</strong> Allows users to secure and leave their data in an encrypted format even while it is being processed or manipulated<br>
                            <strong>Types:</strong> Partial, somewhat, fully homomorphic<br>
                            <strong>Applications:</strong> Cloud computing, privacy-preserving analytics</p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🎭 Zero-Knowledge Proofs</h4>
                            <p><strong>Concept:</strong> Prove knowledge without revealing information<br>
                            <strong>Types:</strong> zk-SNARKs, zk-STARKs<br>
                            <strong>Applications:</strong> Privacy coins, authentication</p>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <h4>🔮 Future Cryptographic Trends</h4>
                    <ul>
                        <li><strong>Post-Quantum Migration:</strong> Industry-wide algorithm updates</li>
                        <li><strong>Quantum-Safe PKI:</strong> New certificate infrastructures</li>
                        <li><strong>Privacy-First Design:</strong> Built-in cryptographic privacy</li>
                        <li><strong>Automated Key Management:</strong> AI-driven cryptographic operations</li>
                    </ul>
                </div>
            </div>

            <!-- Attacks Section -->
            <div id="attacks" class="module-section">
                <h2 class="section-title">⚔️ Cryptographic Attacks</h2>
                
                <div class="card">
                    <h3>🎯 Attack Classifications</h3>
                    <p>Understanding cryptographic attacks is crucial for implementing proper defenses and selecting appropriate algorithms.</p>
                    
                    <div class="key-concepts">
                        <div class="concept-card">
                            <h5>📊 Statistical Attacks</h5>
                            <p>Exploit patterns in ciphertext or algorithm behavior</p>
                        </div>
                        <div class="concept-card">
                            <h5>🔍 Brute Force Attacks</h5>
                            <p>Systematically try all possible keys</p>
                        </div>
                        <div class="concept-card">
                            <h5>🧠 Mathematical Attacks</h5>
                            <p>Exploit algorithm mathematical properties</p>
                        </div>
                        <div class="concept-card">
                            <h5>📡 Side-Channel Attacks</h5>
                            <p>Exploit implementation characteristics</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🔗 Hash Function Attacks</h3>
                    <div class="grid">
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            <h4>💥 Collision Attacks</h4>
                            <p><strong>Goal:</strong> Find two inputs with same hash<br>
                            <strong>Success:</strong> MD5, SHA-1 compromised<br>
                            <strong>Impact:</strong> Digital signature forgery<br>
                            <strong>Defense:</strong> Use SHA-256 or SHA-3</p>
                        </div>
                        
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
                            <h4>🌈 Rainbow Table Attacks</h4>
                            <p><strong>Method:</strong> Precomputed hash tables<br>
                            <strong>Target:</strong> Unsalted password hashes<br>
                            <strong>Efficiency:</strong> Time-memory tradeoff<br>
                            <strong>Defense:</strong> Salt + slow hash functions</p>
                        </div>
                        
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                            <h4>⚛️ Quantum Attacks</h4>
                            <p><strong>Algorithm:</strong> Shor's algorithm<br>
                            <strong>Impact:</strong> Breaks current public key crypto<br>
                            <strong>Timeline:</strong> 10-15 years (estimated)<br>
                            <strong>Defense:</strong> Post-quantum cryptography</p>
                        </div>
                        
                        <div class="algorithm-card" style="background: linear-gradient(135deg, #27ae60, #229954);">
                            <h4>🛡️ Defense Strategies</h4>
                            <p><strong>Methods:</strong> bcrypt, scrypt, Argon2<br>
                            <strong>Principle:</strong> Intentionally slow hashing<br>
                            <strong>Parameters:</strong> Cost factors, memory hard<br>
                            <strong>Result:</strong> Resistant to parallel attacks</p>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <h4>🛡️ Defense Strategies</h4>
                    <ul>
                        <li><strong>Algorithm Selection:</strong> Use current standards (AES, RSA-2048+, SHA-256)</li>
                        <li><strong>Key Management:</strong> Secure generation, storage, and rotation</li>
                        <li><strong>Implementation Security:</strong> Constant-time algorithms, secure coding</li>
                        <li><strong>Future Planning:</strong> Prepare for post-quantum migration</li>
                    </ul>
                </div>
            </div>

            <!-- Tools Section -->
            <div id="tools" class="module-section">
                <h2 class="section-title">🔧 Cryptographic Tools</h2>
                
                <div class="card">
                    <h3>🛠️ Essential Cryptographic Tools</h3>
                    <p>Modern cryptographic operations rely on specialized tools for implementation, testing, and analysis. These tools range from command-line utilities to comprehensive cryptographic libraries.</p>
                </div>

                <div class="card">
                    <h3>🖥️ Command Line Tools</h3>
                    <div class="grid">
                        <div class="algorithm-card">
                            <h4>🔐 OpenSSL</h4>
                            <p><strong>Purpose:</strong> Comprehensive cryptographic toolkit<br>
                            <strong>Capabilities:</strong> Encryption, certificates, key generation<br>
                            <strong>Usage:</strong> Industry standard for SSL/TLS operations</p>
                            <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace;">
                                openssl enc -aes-256-cbc -in file.txt -out encrypted.bin
                            </div>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔒 GnuPG (GPG)</h4>
                            <p><strong>Purpose:</strong> Email and file encryption<br>
                            <strong>Standard:</strong> OpenPGP implementation<br>
                            <strong>Features:</strong> Digital signatures, web of trust</p>
                            <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace;">
                                gpg --encrypt --recipient user@email.com file.txt
                            </div>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔐 VeraCrypt</h4>
                            <p><strong>Purpose:</strong> Disk encryption software<br>
                            <strong>Features:</strong> Full disk encryption, hidden volumes<br>
                            <strong>Security:</strong> Multiple encryption algorithms</p>
                            <p><em>Successor to TrueCrypt with enhanced security</em></p>
                        </div>
                        
                        <div class="algorithm-card">
                            <h4>🔍 Hashcat</h4>
                            <p><strong>Purpose:</strong> Advanced password recovery<br>
                            <strong>Methods:</strong> Dictionary, brute force, hybrid<br>
                            <strong>Hardware:</strong> GPU acceleration support</p>
                            <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace;">
                                hashcat -m 0 -a 0 hashes.txt wordlist.txt
                            </div>
                        </div>
                    </div>
                </div>

                <div class="lab-exercise">
                    <h4>🧪 Practical Exercise: Tool Mastery</h4>
                    <p><strong>Objective:</strong> Master essential cryptographic tools</p>
                    <ol>
                        <li>Generate certificates using OpenSSL</li>
                        <li>Create encrypted volumes with VeraCrypt</li>
                        <li>Implement PGP email encryption with GPG</li>
                        <li>Test password strength with hashcat</li>
                        <li>Develop cryptographic application with Python</li>
                        <li>Analyze ciphertext with CyberChef</li>
                    </ol>
                </div>
            </div>

            <!-- Quiz Section -->
            <div id="quiz" class="module-section">
                <h2 class="section-title">📝 Comprehensive Assessment</h2>
                
                <div class="card">
                    <h3>🎯 Module 20 Assessment</h3>
                    <p>Test your understanding of cryptographic concepts, algorithms, and implementation techniques. This comprehensive assessment covers all major topics from the module.</p>
                    
                    <div style="background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(41, 128, 185, 0.1)); padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <strong>Assessment Details:</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>30 multiple-choice questions</li>
                            <li>Passing score: 80% (24/30 correct)</li>
                            <li>Time limit: 45 minutes</li>
                            <li>Covers all Module 20 topics</li>
                        </ul>
                    </div>
                </div>

                <div class="quiz-container" id="quizContainer">
                    <!-- Quiz questions will be populated by JavaScript -->
                </div>

                <div class="card" id="quizResults" style="display: none;">
                    <h3>📊 Assessment Results</h3>
                    <div id="resultsContent">
                        <!-- Results will be populated by JavaScript -->
                    </div>
                </div>

                <button class="btn btn-success" onclick="startQuiz()">🎯 Start Assessment</button>
            </div>
        </div>
    </div>

    <!-- Modal for detailed information -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 'overview';
        let completedSections = new Set();
        let sectionOrder = ['overview', 'fundamentals', 'symmetric', 'asymmetric', 'hashing', 'pki', 'modern-crypto', 'attacks', 'tools', 'quiz'];
        let quizAnswers = {};
        let quizScore = 0;
        let quizStartTime = 0;
        let quizTimeLimit = 45 * 60 * 1000; // 45 minutes in milliseconds
        let quizTimer = null;

        // Quiz questions database
        const quizQuestions = [
            {
                question: "What is the primary advantage of symmetric encryption over asymmetric encryption?",
                options: [
                    "Better key distribution",
                    "Faster processing speed",
                    "No key management required",
                    "Stronger security"
                ],
                correct: 1,
                explanation: "Symmetric encryption is significantly faster (up to 1000x) than asymmetric encryption because it uses simpler mathematical operations."
            },
            {
                question: "Which cryptographic principle ensures that a small change in plaintext results in a significant change in ciphertext?",
                options: [
                    "Confusion",
                    "Diffusion",
                    "Non-repudiation",
                    "Kerckhoff's Principle"
                ],
                correct: 1,
                explanation: "Diffusion spreads the influence of plaintext bits across ciphertext bits, ensuring that small changes in input produce large changes in output."
            },
            {
                question: "What is the output size of SHA-256?",
                options: [
                    "128 bits",
                    "160 bits",
                    "256 bits",
                    "512 bits"
                ],
                correct: 2,
                explanation: "SHA-256 produces a fixed output size of 256 bits regardless of input size."
            },
            {
                question: "Which algorithm is currently considered broken due to collision vulnerabilities?",
                options: [
                    "SHA-256",
                    "MD5",
                    "SHA-3",
                    "HMAC"
                ],
                correct: 1,
                explanation: "MD5 has been cryptographically broken with collision attacks demonstrated, making it unsuitable for security applications."
            },
            {
                question: "In RSA cryptography, what mathematical problem provides the security foundation?",
                options: [
                    "Discrete logarithm problem",
                    "Elliptic curve discrete logarithm",
                    "Integer factorization problem",
                    "Traveling salesman problem"
                ],
                correct: 2,
                explanation: "RSA security relies on the difficulty of factoring large composite numbers into their prime factors."
            },
            {
                question: "What does PKI stand for?",
                options: [
                    "Private Key Infrastructure",
                    "Public Key Infrastructure",
                    "Protected Key Implementation",
                    "Primary Key Identification"
                ],
                correct: 1,
                explanation: "PKI stands for Public Key Infrastructure, a framework for managing digital certificates and public-key encryption."
            },
            {
                question: "Which of the following is NOT a component of the CIA triad in cryptography?",
                options: [
                    "Confidentiality",
                    "Integrity",
                    "Availability",
                    "Authorization"
                ],
                correct: 3,
                explanation: "The CIA triad consists of Confidentiality, Integrity, and Availability. Authorization is a separate security concept."
            },
            {
                question: "What is the key size of AES-256?",
                options: [
                    "128 bits",
                    "192 bits",
                    "256 bits",
                    "512 bits"
                ],
                correct: 2,
                explanation: "AES-256 uses a 256-bit key size, providing the highest security level in the AES standard."
            },
            {
                question: "Which mode of operation should NOT be used for encrypting multiple blocks?",
                options: [
                    "CBC",
                    "ECB",
                    "GCM",
                    "CFB"
                ],
                correct: 1,
                explanation: "ECB (Electronic Codebook) mode reveals patterns in plaintext and should not be used for encrypting multiple blocks."
            },
            {
                question: "What is the primary purpose of HMAC?",
                options: [
                    "Key exchange",
                    "Data encryption",
                    "Message authentication",
                    "Random number generation"
                ],
                correct: 2,
                explanation: "HMAC (Hash-based Message Authentication Code) provides message authentication and integrity verification."
            },
            {
                question: "Which quantum algorithm threatens current public-key cryptography?",
                options: [
                    "Grover's algorithm",
                    "Shor's algorithm",
                    "Deutsch's algorithm",
                    "Simon's algorithm"
                ],
                correct: 1,
                explanation: "Shor's algorithm can efficiently factor large integers and compute discrete logarithms, breaking RSA and ECC."
            },
            {
                question: "What is the minimum recommended RSA key size for current security?",
                options: [
                    "1024 bits",
                    "2048 bits",
                    "3072 bits",
                    "4096 bits"
                ],
                correct: 1,
                explanation: "2048 bits is the current minimum recommendation for RSA, though 3072+ bits is preferred for long-term security."
            },
            {
                question: "Which of the following is a stream cipher?",
                options: [
                    "AES",
                    "DES",
                    "ChaCha20",
                    "3DES"
                ],
                correct: 2,
                explanation: "ChaCha20 is a stream cipher that encrypts data bit by bit or byte by byte."
            },
            {
                question: "What does CRL stand for in PKI?",
                options: [
                    "Certificate Revocation List",
                    "Cryptographic Resource Library",
                    "Certificate Registration Log",
                    "Central Repository Listing"
                ],
                correct: 0,
                explanation: "CRL stands for Certificate Revocation List, which contains certificates that have been revoked before expiration."
            },
            {
                question: "Which elliptic curve is commonly used in modern cryptography?",
                options: [
                    "secp256k1",
                    "Curve25519",
                    "P-384",
                    "All of the above"
                ],
                correct: 3,
                explanation: "All these curves are widely used: secp256k1 (Bitcoin), Curve25519 (modern applications), and P-384 (NIST standard)."
            },
            {
                question: "What is the primary weakness of using ECB mode for encryption?",
                options: [
                    "Slow performance",
                    "Large key size required",
                    "Reveals patterns in plaintext",
                    "Requires initialization vector"
                ],
                correct: 2,
                explanation: "ECB mode encrypts identical plaintext blocks to identical ciphertext blocks, revealing patterns in the original data."
            },
            {
                question: "Which hash function is part of the SHA-3 family?",
                options: [
                    "SHA-224",
                    "SHA-512",
                    "Keccak",
                    "BLAKE2"
                ],
                correct: 2,
                explanation: "Keccak is the algorithm that became SHA-3, representing a different approach from the SHA-2 family."
            },
            {
                question: "What is homomorphic encryption primarily used for?",
                options: [
                    "Faster encryption",
                    "Computation on encrypted data",
                    "Key exchange",
                    "Digital signatures"
                ],
                correct: 1,
                explanation: "Homomorphic encryption allows computations to be performed on encrypted data without decrypting it first."
            },
            {
                question: "Which attack is prevented by using salt in password hashing?",
                options: [
                    "Brute force attack",
                    "Rainbow table attack",
                    "Dictionary attack",
                    "Social engineering attack"
                ],
                correct: 1,
                explanation: "Salt prevents rainbow table attacks by making each password hash unique, even for identical passwords."
            },
            {
                question: "What is the key characteristic of a one-way hash function?",
                options: [
                    "Uses symmetric keys",
                    "Computationally irreversible",
                    "Requires two keys",
                    "Provides perfect security"
                ],
                correct: 1,
                explanation: "One-way hash functions are designed to be computationally infeasible to reverse, making them ideal for password storage and integrity checks."
            },
            {
                question: "Which protocol is used for real-time certificate status checking?",
                options: [
                    "CRL",
                    "OCSP",
                    "LDAP",
                    "DNS"
                ],
                correct: 1,
                explanation: "OCSP (Online Certificate Status Protocol) allows real-time checking of certificate revocation status."
            },
            {
                question: "What is the main advantage of Elliptic Curve Cryptography (ECC)?",
                options: [
                    "Faster than RSA",
                    "Same security with smaller key sizes",
                    "No mathematical assumptions",
                    "Quantum resistant"
                ],
                correct: 1,
                explanation: "ECC provides equivalent security to RSA with much smaller key sizes, making it efficient for resource-constrained environments."
            },
            {
                question: "Which is NOT a post-quantum cryptography algorithm standardized by NIST?",
                options: [
                    "CRYSTALS-Kyber",
                    "CRYSTALS-Dilithium",
                    "Falcon",
                    "RSA-4096"
                ],
                correct: 3,
                explanation: "RSA-4096 is a current public-key algorithm that will be vulnerable to quantum computers. The others are NIST's post-quantum standards."
            },
            {
                question: "What does 'perfect forward secrecy' provide?",
                options: [
                    "Unbreakable encryption",
                    "Session key independence",
                    "Quantum resistance",
                    "Faster key exchange"
                ],
                correct: 1,
                explanation: "Perfect forward secrecy ensures that compromise of long-term keys doesn't compromise past session keys."
            },
            {
                question: "Which attack exploits implementation characteristics rather than algorithm weaknesses?",
                options: [
                    "Brute force attack",
                    "Side-channel attack",
                    "Birthday attack",
                    "Dictionary attack"
                ],
                correct: 1,
                explanation: "Side-channel attacks exploit physical implementation characteristics like timing, power consumption, or electromagnetic emissions."
            },
            {
                question: "What is the purpose of key stretching in password hashing?",
                options: [
                    "Increase key length",
                    "Slow down brute force attacks",
                    "Improve randomness",
                    "Enable key recovery"
                ],
                correct: 1,
                explanation: "Key stretching intentionally slows down the hashing process to make brute force attacks computationally expensive."
            },
            {
                question: "Which consensus mechanism is used in Bitcoin's blockchain?",
                options: [
                    "Proof of Stake",
                    "Proof of Work",
                    "Delegated Proof of Stake",
                    "Proof of Authority"
                ],
                correct: 1,
                explanation: "Bitcoin uses Proof of Work consensus, where miners compete to solve cryptographic puzzles."
            },
            {
                question: "What is the primary security concern with quantum computing for cryptography?",
                options: [
                    "Faster symmetric encryption breaking",
                    "Breaking current public-key algorithms",
                    "Compromising hash functions",
                    "Eliminating the need for encryption"
                ],
                correct: 1,
                explanation: "Quantum computers threaten current public-key algorithms like RSA and ECC but have less impact on symmetric encryption and hash functions."
            },
            {
                question: "Which tool is commonly used for disk encryption?",
                options: [
                    "OpenSSL",
                    "GPG",
                    "VeraCrypt",
                    "Hashcat"
                ],
                correct: 2,
                explanation: "VeraCrypt is a popular tool for disk encryption, providing full disk encryption with multiple algorithm options."
            },
            {
                question: "What is the recommended approach for cryptographic agility?",
                options: [
                    "Use only one algorithm",
                    "Hardcode algorithm choices",
                    "Design systems to easily change algorithms",
                    "Avoid algorithm updates"
                ],
                correct: 2,
                explanation: "Cryptographic agility means designing systems that can easily transition to new algorithms when current ones become obsolete or compromised."
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            showSection('overview');
            updateProgress();
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                } else if (e.key === 'ArrowLeft') {
                    navigateSection(-1);
                } else if (e.key === 'ArrowRight') {
                    navigateSection(1);
                }
            });
        });

        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.module-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                currentSection = sectionId;
                
                // Update navigation buttons
                const navButtons = document.querySelectorAll('.nav-btn');
                navButtons.forEach(btn => btn.classList.remove('active'));
                
                const activeButton = Array.from(navButtons).find(btn => 
                    btn.getAttribute('onclick').includes(sectionId)
                );
                if (activeButton) {
                    activeButton.classList.add('active');
                }
                
                // Mark section as completed
                completedSections.add(sectionId);
                updateProgress();
                
                // Scroll to top
                window.scrollTo(0, 0);
            }
        }

        function navigateSection(direction) {
            const currentIndex = sectionOrder.indexOf(currentSection);
            let newIndex = currentIndex + direction;
            
            if (newIndex >= 0 && newIndex < sectionOrder.length) {
                showSection(sectionOrder[newIndex]);
            }
        }

        function updateProgress() {
            const completionRate = (completedSections.size / sectionOrder.length) * 100;
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            progressBar.style.width = completionRate + '%';
            progressBar.textContent = Math.round(completionRate) + '%';
            progressText.textContent = `Progress: ${Math.round(completionRate)}% Complete`;
        }

        function startQuiz() {
            quizStartTime = Date.now();
            quizAnswers = {};
            displayQuiz();
            startQuizTimer();
        }

        function displayQuiz() {
            const container = document.getElementById('quizContainer');
            let html = '<div style="margin-bottom: 20px;"><h4>🎯 Cryptography Assessment</h4>';
            html += '<div id="timerDisplay" style="font-weight: bold; color: #e74c3c; margin: 10px 0;"></div></div>';
            
            quizQuestions.forEach((q, index) => {
                html += `
                    <div class="question">
                        <h4>${index + 1}. ${q.question}</h4>
                        <div class="options">
                            ${q.options.map((option, optIndex) => `
                                <div class="option" onclick="selectAnswer(${index}, ${optIndex})" id="q${index}_opt${optIndex}">
                                    ${String.fromCharCode(65 + optIndex)}. ${option}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += '<button class="btn btn-success" onclick="submitQuiz()" style="margin: 20px 0;">Submit Assessment</button>';
            container.innerHTML = html;
        }

        function startQuizTimer() {
            updateTimerDisplay();
            quizTimer = setInterval(() => {
                const elapsed = Date.now() - quizStartTime;
                const remaining = quizTimeLimit - elapsed;
                
                if (remaining <= 0) {
                    clearInterval(quizTimer);
                    submitQuiz();
                } else {
                    updateTimerDisplay();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const elapsed = Date.now() - quizStartTime;
            const remaining = Math.max(0, quizTimeLimit - elapsed);
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            
            const timerDisplay = document.getElementById('timerDisplay');
            if (timerDisplay) {
                timerDisplay.textContent = `⏰ Time Remaining: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (remaining < 5 * 60 * 1000) { // Less than 5 minutes
                    timerDisplay.style.color = '#e74c3c';
                } else if (remaining < 10 * 60 * 1000) { // Less than 10 minutes
                    timerDisplay.style.color = '#f39c12';
                }
            }
        }

        function selectAnswer(questionIndex, optionIndex) {
            quizAnswers[questionIndex] = optionIndex;
            
            // Clear previous selection
            const allOptions = document.querySelectorAll(`[id^="q${questionIndex}_opt"]`);
            allOptions.forEach(opt => opt.classList.remove('selected'));
            
            // Mark selected option
            document.getElementById(`q${questionIndex}_opt${optionIndex}`).classList.add('selected');
        }

        function submitQuiz() {
            if (quizTimer) {
                clearInterval(quizTimer);
            }
            
            let correctAnswers = 0;
            const totalQuestions = quizQuestions.length;
            
            // Calculate score
            quizQuestions.forEach((question, index) => {
                if (quizAnswers[index] === question.correct) {
                    correctAnswers++;
                }
            });
            
            quizScore = (correctAnswers / totalQuestions) * 100;
            
            // Show results
            displayQuizResults(correctAnswers, totalQuestions);
            
            // Mark quiz as completed
            completedSections.add('quiz');
            updateProgress();
        }

        function displayQuizResults(correct, total) {
            const container = document.getElementById('quizContainer');
            const resultsDiv = document.getElementById('quizResults');
            
            let html = `
                <div style="text-align: center; margin: 30px 0;">
                    <h3 style="color: ${quizScore >= 80 ? '#27ae60' : '#e74c3c'};">
                        ${quizScore >= 80 ? '🎉 Congratulations!' : '📚 Keep Learning!'}
                    </h3>
                    <div style="font-size: 2em; margin: 20px 0;">
                        Score: ${correct}/${total} (${Math.round(quizScore)}%)
                    </div>
                    <div style="margin: 20px 0;">
                        ${quizScore >= 80 ? 
                            '<p style="color: #27ae60;">✅ Excellent work! You have mastered the cryptographic concepts.</p>' : 
                            '<p style="color: #e74c3c;">❌ Score below 80%. Review the material and try again.</p>'
                        }
                    </div>
                </div>
            `;

            // Show detailed results
            html += '<div style="text-align: left;"><h4>📋 Detailed Results:</h4>';
            
            quizQuestions.forEach((question, index) => {
                const userAnswer = quizAnswers[index];
                const isCorrect = userAnswer === question.correct;
                
                html += `
                    <div style="margin: 15px 0; padding: 15px; border-radius: 8px; background: ${isCorrect ? '#d5f4e6' : '#fdeaea'};">
                        <h5>${index + 1}. ${question.question}</h5>
                        <p><strong>Your answer:</strong> ${userAnswer !== undefined ? question.options[userAnswer] : 'Not answered'} ${isCorrect ? '✅' : '❌'}</p>
                        ${!isCorrect ? `<p><strong>Correct answer:</strong> ${question.options[question.correct]} ✅</p>` : ''}
                        <p><strong>Explanation:</strong> ${question.explanation}</p>
                    </div>
                `;
            });
            
            html += '</div>';
            
            html += `
                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-warning" onclick="startQuiz()">🔄 Retake Assessment</button>
                    <button class="btn btn-success" onclick="showSection('overview')" style="margin-left: 10px;">📚 Review Material</button>
                </div>
            `;

            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            container.style.display = 'none';
        }

        function openModal(title, content) {
            document.getElementById('modalContent').innerHTML = `<h2>${title}</h2>${content}`;
            document.getElementById('detailModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>