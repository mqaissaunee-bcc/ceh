<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH v13 Module 3: Scanning Networks</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --dark-bg: #1a1a1a;
            --light-bg: #f8f9fa;
            --text-dark: #2c3e50;
            --text-light: #ecf0f1;
            --border-color: #bdc3c7;
            --scan-primary: #e67e22;
            --scan-secondary: #f39c12;
            --stealth-color: #34495e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--scan-primary), var(--scan-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            font-size: 1.2em;
            color: var(--text-dark);
            margin-bottom: 20px;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            padding: 10px;
            margin-bottom: 20px;
        }

        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, var(--scan-primary), var(--scan-secondary));
            border-radius: 15px;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .navigation {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .nav-btn {
            background: linear-gradient(45deg, var(--scan-primary), var(--scan-secondary));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .nav-btn.active {
            background: linear-gradient(45deg, var(--accent-color), #c0392b);
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        .module-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .module-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--scan-primary);
            padding-bottom: 10px;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--scan-primary);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .scan-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .scan-card {
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            color: white;
        }

        .tcp-scan {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .udp-scan {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .syn-scan {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .stealth-scan {
            background: linear-gradient(135deg, var(--stealth-color), #2c3e50);
        }

        .scan-card:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .nmap-commands {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .command-card {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .command-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .command-card h4 {
            color: var(--scan-secondary);
            margin-bottom: 10px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .tool-card {
            background: linear-gradient(135deg, var(--scan-primary), var(--scan-secondary));
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tool-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .evasion-techniques {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .evasion-card {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .evasion-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .vulnerability-scanners {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .vuln-card {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .vuln-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .scan-methodology {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }

        .methodology-step {
            background: linear-gradient(90deg, var(--scan-primary), var(--scan-secondary));
            color: white;
            padding: 20px;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .methodology-step:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .methodology-step::after {
            content: '→';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
        }

        .methodology-step:last-child::after {
            content: '✓';
            color: var(--success-color);
        }

        .quiz-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .question {
            margin-bottom: 25px;
        }

        .question h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: rgba(230, 126, 34, 0.1);
            border-color: var(--scan-primary);
        }

        .option.selected {
            background: rgba(230, 126, 34, 0.2);
            border-color: var(--scan-primary);
        }

        .option.correct {
            background: rgba(39, 174, 96, 0.2);
            border-color: var(--success-color);
        }

        .option.incorrect {
            background: rgba(231, 76, 60, 0.2);
            border-color: var(--accent-color);
        }

        .btn {
            background: linear-gradient(45deg, var(--scan-primary), var(--scan-secondary));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success-color), #27ae60);
        }

        .btn-warning {
            background: linear-gradient(45deg, var(--warning-color), #e67e22);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--accent-color), #c0392b);
        }

        .interactive-demo {
            background: rgba(26, 26, 26, 0.95);
            color: var(--text-light);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
        }

        .terminal {
            background: #000;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 200px;
            overflow-y: auto;
            max-height: 400px;
        }

        .terminal-line {
            margin: 5px 0;
            opacity: 0;
            animation: typeWriter 0.5s ease-in-out forwards;
        }

        @keyframes typeWriter {
            to { opacity: 1; }
        }

        .prompt {
            color: var(--success-color);
        }

        .output {
            color: var(--text-light);
        }

        .error {
            color: var(--accent-color);
        }

        .warning {
            color: var(--warning-color);
        }

        .info {
            color: var(--secondary-color);
        }

        .score-display {
            background: linear-gradient(45deg, var(--success-color), #27ae60);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.2em;
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            color: var(--accent-color);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes slideIn {
            from { 
                transform: translateX(100%); 
                opacity: 0; 
            }
            to { 
                transform: translateX(0); 
                opacity: 1; 
            }
        }

        @keyframes slideOut {
            from { 
                transform: translateX(0); 
                opacity: 1; 
            }
            to { 
                transform: translateX(100%); 
                opacity: 0; 
            }
        }

        .firewall-detection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .firewall-card {
            background: linear-gradient(135deg, #16a085, #1abc9c);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .firewall-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .port-states {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .port-state {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .open-port {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .closed-port {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .filtered-port {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .unknown-port {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .navigation {
                flex-direction: column;
            }
            
            .scan-types {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔍 CEH v13 Module 3</h1>
            <p>Scanning Networks</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <p id="progressText">Progress: 0% Complete</p>
            <div style="margin-top: 15px; font-size: 0.9em; color: #7f8c8d;">
                <span style="background: rgba(230,126,34,0.1); padding: 8px 15px; border-radius: 20px; margin: 0 5px;">
                    ← → Navigate Sections
                </span>
                <span style="background: rgba(231,76,60,0.1); padding: 8px 15px; border-radius: 20px; margin: 0 5px;">
                    Esc Close Modal
                </span>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('overview')">📋 Overview</button>
            <button class="nav-btn" onclick="showSection('fundamentals')">🔧 Fundamentals</button>
            <button class="nav-btn" onclick="showSection('port-scanning')">🔍 Port Scanning</button>
            <button class="nav-btn" onclick="showSection('host-discovery')">🖥️ Host Discovery</button>
            <button class="nav-btn" onclick="showSection('service-detection')">⚙️ Service Detection</button>
            <button class="nav-btn" onclick="showSection('firewall-evasion')">🛡️ Firewall Evasion</button>
            <button class="nav-btn" onclick="showSection('stealth-scanning')">🥷 Stealth Scanning</button>
            <button class="nav-btn" onclick="showSection('vulnerability-scanning')">🚨 Vulnerability Scanning</button>
            <button class="nav-btn" onclick="showSection('tools')">🛠️ Tools & Techniques</button>
            <button class="nav-btn" onclick="showSection('resources')">📚 Resources</button>
            <button class="nav-btn" onclick="showSection('assessment')">🎯 Assessment</button>
            <button class="nav-btn" onclick="showSection('lab')">🧪 Hands-on Lab</button>
        </div>

        <div class="content-area">
            <!-- Overview Section -->
            <div id="overview" class="module-section active">
                <h2 class="section-title">🎯 Learning Objectives</h2>
                <div class="card">
                    <h3>Module 3 Overview</h3>
                    <p>Welcome to CEH v13 Module 3! This comprehensive module focuses on network scanning - the critical second phase of ethical hacking. Master the art of discovering live systems, open ports, running services, and potential vulnerabilities while remaining undetected.</p>
                    
                    <h4>🎯 What You'll Learn:</h4>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>Network scanning fundamentals and methodologies</li>
                        <li>Advanced port scanning techniques (TCP, UDP, SYN, FIN, XMAS)</li>
                        <li>Host discovery and network topology mapping</li>
                        <li>Service version detection and OS fingerprinting</li>
                        <li>🆕 AI-powered scanning optimization (New in v13!)</li>
                        <li>Firewall identification and evasion techniques</li>
                        <li>IDS/IPS evasion and stealth scanning methods</li>
                        <li>Automated vulnerability scanning and assessment</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>🆕 What's New in CEH v13 Module 3</h3>
                    <p style="background: linear-gradient(45deg, var(--scan-primary), var(--scan-secondary)); color: white; padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <strong>AI-Enhanced Scanning:</strong> CEH v13 introduces intelligent scanning optimization and automated evasion techniques!
                    </p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>Machine Learning Optimization:</strong> AI-driven scan timing and technique selection</li>
                        <li><strong>Automated Evasion:</strong> Smart firewall and IDS bypass strategies</li>
                        <li><strong>Intelligent Target Prioritization:</strong> ML-based vulnerability assessment</li>
                        <li><strong>Advanced Stealth Techniques:</strong> Next-generation covert scanning methods</li>
                        <li><strong>Cloud-Native Scanning:</strong> Specialized techniques for cloud environments</li>
                    </ul>
                </div>

                <button class="btn btn-success" onclick="showSection('fundamentals')">Start Scanning! 🚀</button>
            </div>

            <!-- Network Scanning Fundamentals Section -->
            <div id="fundamentals" class="module-section">
                <h2 class="section-title">🔧 Network Scanning Fundamentals</h2>
                
                <div class="card">
                    <h3>What is Network Scanning?</h3>
                    <p>Network scanning is the process of identifying active hosts, open ports, and running services on a network. It's the second phase of ethical hacking that builds upon reconnaissance to create a comprehensive map of the target infrastructure.</p>
                </div>

                <div class="scan-methodology">
                    <div class="methodology-step" onclick="showMethodologyDetails('host-discovery')">
                        <strong>1. Host Discovery</strong>
                        <p>Identify live systems and active IP addresses on the target network</p>
                    </div>
                    <div class="methodology-step" onclick="showMethodologyDetails('port-scanning')">
                        <strong>2. Port Scanning</strong>
                        <p>Enumerate open, closed, and filtered ports on discovered hosts</p>
                    </div>
                    <div class="methodology-step" onclick="showMethodologyDetails('service-enum')">
                        <strong>3. Service Enumeration</strong>
                        <p>Identify services, versions, and banners running on open ports</p>
                    </div>
                    <div class="methodology-step" onclick="showMethodologyDetails('os-detection')">
                        <strong>4. OS Detection</strong>
                        <p>Determine operating systems and their versions through fingerprinting</p>
                    </div>
                    <div class="methodology-step" onclick="showMethodologyDetails('vuln-assessment')">
                        <strong>5. Vulnerability Assessment</strong>
                        <p>Identify potential security weaknesses and misconfigurations</p>
                    </div>
                </div>

                <div class="card">
                    <h3>📊 Port States Explained</h3>
                    <div class="port-states">
                        <div class="port-state open-port" onclick="showPortStateDetails('open')">
                            <h4>OPEN</h4>
                            <p>Service actively listening and accepting connections</p>
                        </div>
                        <div class="port-state closed-port" onclick="showPortStateDetails('closed')">
                            <h4>CLOSED</h4>
                            <p>No service listening, but port is accessible</p>
                        </div>
                        <div class="port-state filtered-port" onclick="showPortStateDetails('filtered')">
                            <h4>FILTERED</h4>
                            <p>Firewall or packet filter blocking access</p>
                        </div>
                        <div class="port-state unknown-port" onclick="showPortStateDetails('unfiltered')">
                            <h4>UNFILTERED</h4>
                            <p>Port accessible but state unknown</p>
                        </div>
                    </div>
                </div>

                <button class="btn btn-success" onclick="showSection('port-scanning')">Next: Port Scanning Techniques →</button>
            </div>

            <!-- Port Scanning Section -->
            <div id="port-scanning" class="module-section">
                <h2 class="section-title">🔍 Port Scanning Techniques</h2>
                
                <div class="card">
                    <h3>🎯 Understanding Port Scanning</h3>
                    <p>Port scanning is the process of systematically checking ports on a target system to determine which services are running and accessible. Different scanning techniques offer various levels of stealth, speed, and information gathering capabilities.</p>
                </div>

                <div class="scan-types">
                    <div class="scan-card tcp-scan" onclick="showScanDetails('tcp')">
                        <h3>🔗 TCP Connect Scan</h3>
                        <h4>nmap -sT target</h4>
                        <p><strong>Method:</strong> Completes full TCP handshake</p>
                        <p><strong>Stealth:</strong> Low (easily detected)</p>
                        <p><strong>Accuracy:</strong> High</p>
                    </div>

                    <div class="scan-card syn-scan" onclick="showScanDetails('syn')">
                        <h3>⚡ SYN Stealth Scan</h3>
                        <h4>nmap -sS target</h4>
                        <p><strong>Method:</strong> Sends SYN, analyzes response</p>
                        <p><strong>Stealth:</strong> High (half-open)</p>
                        <p><strong>Accuracy:</strong> High</p>
                    </div>

                    <div class="scan-card udp-scan" onclick="showScanDetails('udp')">
                        <h3>📡 UDP Scan</h3>
                        <h4>nmap -sU target</h4>
                        <p><strong>Method:</strong> Sends UDP packets</p>
                        <p><strong>Stealth:</strong> Medium</p>
                        <p><strong>Accuracy:</strong> Medium (protocol dependent)</p>
                    </div>

                    <div class="scan-card stealth-scan" onclick="showScanDetails('stealth')">
                        <h3>🥷 Advanced Stealth Scans</h3>
                        <h4>FIN, XMAS, NULL</h4>
                        <p><strong>Method:</strong> Sends unusual flag combinations</p>
                        <p><strong>Stealth:</strong> Very High</p>
                        <p><strong>Accuracy:</strong> Medium (OS dependent)</p>
                    </div>
                </div>

                <div class="card">
                    <h3>⚙️ Essential Nmap Commands</h3>
                    <div class="nmap-commands">
                        <div class="command-card" onclick="showCommandDetails('basic-scan')">
                            <h4>Basic Port Scan</h4>
                            <p><code>nmap target</code></p>
                            <p>Scans top 1000 ports using SYN scan</p>
                        </div>

                        <div class="command-card" onclick="showCommandDetails('range-scan')">
                            <h4>Port Range Scan</h4>
                            <p><code>nmap -p 1-65535 target</code></p>
                            <p>Scans all 65535 TCP ports</p>
                        </div>

                        <div class="command-card" onclick="showCommandDetails('service-scan')">
                            <h4>Service Version Detection</h4>
                            <p><code>nmap -sV target</code></p>
                            <p>Probes open ports to determine service versions</p>
                        </div>

                        <div class="command-card" onclick="showCommandDetails('os-scan')">
                            <h4>OS Detection</h4>
                            <p><code>nmap -O target</code></p>
                            <p>Attempts to identify operating system</p>
                        </div>

                        <div class="command-card" onclick="showCommandDetails('aggressive-scan')">
                            <h4>Aggressive Scan</h4>
                            <p><code>nmap -A target</code></p>
                            <p>Enables OS detection, version detection, scripts</p>
                        </div>

                        <div class="command-card" onclick="showCommandDetails('timing-scan')">
                            <h4>Timing Templates</h4>
                            <p><code>nmap -T4 target</code></p>
                            <p>Controls scan timing (T0-T5, paranoid to insane)</p>
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Port Scanning Demo</h3>
                    <div class="terminal" id="portScanTerminal">
                        <div class="terminal-line prompt">scanner@kali:~$ nmap -sS -p 1-1000 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line output">Nmap scan report for webserver.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.00050s latency).</div>
                        <div class="terminal-line output">PORT    STATE    SERVICE</div>
                        <div class="terminal-line output">22/tcp  open     ssh</div>
                        <div class="terminal-line output">80/tcp  open     http</div>
                        <div class="terminal-line output">443/tcp open     https</div>
                        <div class="terminal-line output">3306/tcp open    mysql</div>
                        <div class="terminal-line warning">Warning: OS detection will be less reliable due to lack of responses</div>
                        <div class="terminal-line output">Nmap done: 1 IP address (1 host up) scanned in 4.32 seconds</div>
                    </div>
                    <button class="btn" onclick="runPortScanDemo()">🔄 Run Different Scan Type</button>
                </div>

                <button class="btn btn-success" onclick="showSection('host-discovery')">Next: Host Discovery →</button>
            </div>

            <!-- Host Discovery Section -->
            <div id="host-discovery" class="module-section">
                <h2 class="section-title">🖥️ Host Discovery & Network Mapping</h2>
                
                <div class="card">
                    <h3>🎯 Host Discovery Fundamentals</h3>
                    <p>Host discovery is the process of identifying live systems on a network before conducting detailed port scans. This phase helps optimize scanning efforts by focusing on active targets and understanding network topology.</p>
                </div>

                <div class="card">
                    <h3>🔍 Host Discovery Techniques</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: #3498db; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🏓 ICMP Ping Sweep</h4>
                            <p><code>nmap -sn target/24</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>ICMP Echo Request packets</li>
                                <li>Fast and efficient method</li>
                                <li>Often blocked by firewalls</li>
                                <li>Good for initial discovery</li>
                            </ul>
                        </div>
                        
                        <div style="background: #27ae60; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔗 TCP SYN Ping</h4>
                            <p><code>nmap -PS22,80,443 target/24</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>TCP SYN to common ports</li>
                                <li>Bypasses ICMP filtering</li>
                                <li>More reliable than ICMP</li>
                                <li>Customizable port selection</li>
                            </ul>
                        </div>
                        
                        <div style="background: #e74c3c; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔌 TCP ACK Ping</h4>
                            <p><code>nmap -PA22,80,443 target/24</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>TCP ACK packets to ports</li>
                                <li>Effective against stateful firewalls</li>
                                <li>Returns RST if host alive</li>
                                <li>Complementary to SYN ping</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f39c12; color: white; padding: 20px; border-radius: 10px;">
                            <h4>📡 UDP Ping</h4>
                            <p><code>nmap -PU53,161,123 target/24</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>UDP packets to common services</li>
                                <li>Discovers UDP-only systems</li>
                                <li>Less commonly filtered</li>
                                <li>Good for service-specific discovery</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🗺️ Network Mapping Tools</h3>
                    <div class="tools-grid">
                        <div class="tool-card" onclick="showDiscoveryToolDetails('netdiscover')">
                            <h4>🔍 Netdiscover</h4>
                            <p>ARP-based network discovery tool</p>
                            <p><strong>Best for:</strong> Local network discovery</p>
                        </div>

                        <div class="tool-card" onclick="showDiscoveryToolDetails('masscan')">
                            <h4>⚡ Masscan</h4>
                            <p>High-speed port scanner</p>
                            <p><strong>Best for:</strong> Large network ranges</p>
                        </div>

                        <div class="tool-card" onclick="showDiscoveryToolDetails('zmap')">
                            <h4>🌐 Zmap</h4>
                            <p>Internet-wide network scanner</p>
                            <p><strong>Best for:</strong> Internet-scale scanning</p>
                        </div>

                        <div class="tool-card" onclick="showDiscoveryToolDetails('angry-ip')">
                            <h4>😠 Angry IP Scanner</h4>
                            <p>Cross-platform IP scanner</p>
                            <p><strong>Best for:</strong> GUI-based scanning</p>
                        </div>

                        <div class="tool-card" onclick="showDiscoveryToolDetails('fping')">
                            <h4>🏓 fping</h4>
                            <p>Parallel ping utility</p>
                            <p><strong>Best for:</strong> Quick alive checks</p>
                        </div>

                        <div class="tool-card" onclick="showDiscoveryToolDetails('hping3')">
                            <h4>🎯 hping3</h4>
                            <p>Custom packet crafting tool</p>
                            <p><strong>Best for:</strong> Advanced ping techniques</p>
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Host Discovery Demo</h3>
                    <div class="terminal" id="hostDiscoveryTerminal">
                        <div class="terminal-line prompt">scanner@kali:~$ nmap -sn 192.168.1.0/24</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line output">Nmap scan report for router.local (192.168.1.1)</div>
                        <div class="terminal-line output">Host is up (0.0010s latency).</div>
                        <div class="terminal-line output">MAC Address: 00:1A:2B:3C:4D:5E (Cisco Systems)</div>
                        <div class="terminal-line output">Nmap scan report for workstation-01.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.0023s latency).</div>
                        <div class="terminal-line output">MAC Address: 08:00:27:A1:B2:C3 (Oracle VirtualBox)</div>
                        <div class="terminal-line output">Nmap scan report for webserver.local (192.168.1.200)</div>
                        <div class="terminal-line output">Host is up (0.0015s latency).</div>
                        <div class="terminal-line output">MAC Address: 52:54:00:12:34:56 (QEMU/KVM)</div>
                        <div class="terminal-line info">Nmap done: 256 IP addresses (3 hosts up) scanned in 2.84 seconds</div>
                    </div>
                    <button class="btn" onclick="runHostDiscoveryDemo()">🔄 Run Advanced Discovery</button>
                </div>

                <div class="card">
                    <h3>📊 Network Topology Mapping</h3>
                    <p>Understanding network topology helps identify:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>Network Segments:</strong> DMZ, internal networks, VLANs</li>
                        <li><strong>Critical Infrastructure:</strong> Routers, switches, firewalls</li>
                        <li><strong>Service Distribution:</strong> Web servers, databases, domain controllers</li>
                        <li><strong>Security Controls:</strong> IDS/IPS placement, monitoring points</li>
                        <li><strong>Potential Paths:</strong> Routes for lateral movement</li>
                    </ul>
                </div>

                <button class="btn btn-success" onclick="showSection('service-detection')">Next: Service Detection →</button>
            </div>

            <!-- Service Detection Section -->
            <div id="service-detection" class="module-section">
                <h2 class="section-title">⚙️ Service Detection & OS Fingerprinting</h2>
                
                <div class="card">
                    <h3>🔍 Service Version Detection</h3>
                    <p>Service detection goes beyond identifying open ports to determine the specific services, versions, and configurations running on target systems. This information is crucial for vulnerability assessment and exploitation planning.</p>
                </div>

                <div class="card">
                    <h3>🛠️ Service Detection Techniques</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: #3498db; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🏷️ Banner Grabbing</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Direct service connection</li>
                                <li>Read service banners and headers</li>
                                <li>Often reveals version information</li>
                                <li>Simple but effective technique</li>
                            </ul>
                            <p><code>nmap -sV -p 80,443 target</code></p>
                        </div>
                        
                        <div style="background: #27ae60; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔍 Service Probes</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Send service-specific requests</li>
                                <li>Analyze response patterns</li>
                                <li>Nmap's extensive probe database</li>
                                <li>Identifies non-standard ports</li>
                            </ul>
                            <p><code>nmap -sV --version-intensity 9 target</code></p>
                        </div>
                        
                        <div style="background: #e74c3c; color: white; padding: 20px; border-radius: 10px;">
                            <h4>📜 NSE Scripts</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Nmap Scripting Engine</li>
                                <li>Automated service enumeration</li>
                                <li>Vulnerability detection</li>
                                <li>Configuration analysis</li>
                            </ul>
                            <p><code>nmap -sC target</code></p>
                        </div>
                        
                        <div style="background: #f39c12; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🖨️ Protocol Analysis</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Deep packet inspection</li>
                                <li>Protocol-specific fingerprinting</li>
                                <li>SSL/TLS certificate analysis</li>
                                <li>Custom protocol detection</li>
                            </ul>
                            <p><code>nmap --script ssl-cert target</code></p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🖥️ Operating System Detection</h3>
                    <p>OS fingerprinting identifies the operating system and version running on target hosts by analyzing network behavior and packet responses.</p>
                    
                    <h4>🔬 OS Detection Methods:</h4>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>TCP/IP Stack Fingerprinting:</strong> Analyzes TCP sequence numbers, window sizes, and options</li>
                        <li><strong>ICMP Fingerprinting:</strong> Examines ICMP error message formats and responses</li>
                        <li><strong>Port Behavior Analysis:</strong> Studies how the OS handles different port states</li>
                        <li><strong>Service Characteristics:</strong> Identifies OS-specific service implementations</li>
                        <li><strong>Time-based Analysis:</strong> Measures response timing patterns</li>
                    </ul>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Service Detection Demo</h3>
                    <div class="terminal" id="serviceDetectionTerminal">
                        <div class="terminal-line prompt">scanner@kali:~$ nmap -sV -O 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line output">Nmap scan report for webserver.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.00050s latency).</div>
                        <div class="terminal-line output">PORT     STATE SERVICE    VERSION</div>
                        <div class="terminal-line output">22/tcp   open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.1</div>
                        <div class="terminal-line output">80/tcp   open  http       Apache httpd 2.4.52</div>
                        <div class="terminal-line output">443/tcp  open  ssl/http   Apache httpd 2.4.52</div>
                        <div class="terminal-line output">3306/tcp open  mysql      MySQL 8.0.28-0ubuntu0.20.04.3</div>
                        <div class="terminal-line output">MAC Address: 08:00:27:A1:B2:C3 (Oracle VirtualBox)</div>
                        <div class="terminal-line info">Device type: general purpose</div>
                        <div class="terminal-line info">Running: Linux 5.X</div>
                        <div class="terminal-line info">OS CPE: cpe:/o:linux:linux_kernel:5</div>
                        <div class="terminal-line info">OS details: Linux 5.0 - 5.4</div>
                        <div class="terminal-line output">Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds</div>
                    </div>
                    <button class="btn" onclick="runServiceDetectionDemo()">🔄 Run Aggressive Detection</button>
                </div>

                <div class="card">
                    <h3>📊 Common Service Signatures</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin: 20px 0;">
                        <div style="background: #2c3e50; color: white; padding: 15px; border-radius: 8px;">
                            <h4>🌐 Web Servers</h4>
                            <ul style="line-height: 1.6;">
                                <li>Apache: "Apache/2.4.41"</li>
                                <li>Nginx: "nginx/1.18.0"</li>
                                <li>IIS: "Microsoft-IIS/10.0"</li>
                            </ul>
                        </div>
                        
                        <div style="background: #8e44ad; color: white; padding: 15px; border-radius: 8px;">
                            <h4>🔐 SSH Services</h4>
                            <ul style="line-height: 1.6;">
                                <li>OpenSSH: "OpenSSH_8.2"</li>
                                <li>Dropbear: "dropbear_2020.81"</li>
                                <li>PuTTY: "PuTTY_Release_0.76"</li>
                            </ul>
                        </div>
                        
                        <div style="background: #16a085; color: white; padding: 15px; border-radius: 8px;">
                            <h4>📧 Mail Services</h4>
                            <ul style="line-height: 1.6;">
                                <li>Postfix: "Postfix smtpd"</li>
                                <li>Sendmail: "Sendmail 8.15.2"</li>
                                <li>Exchange: "Microsoft ESMTP MAIL"</li>
                            </ul>
                        </div>
                        
                        <div style="background: #d35400; color: white; padding: 15px; border-radius: 8px;">
                            <h4>🗄️ Database Services</h4>
                            <ul style="line-height: 1.6;">
                                <li>MySQL: "5.7.33-0ubuntu0.18.04.1"</li>
                                <li>PostgreSQL: "PostgreSQL 13.3"</li>
                                <li>MSSQL: "Microsoft SQL Server 2019"</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <button class="btn btn-success" onclick="showSection('firewall-evasion')">Next: Firewall Evasion →</button>
            </div>

            <!-- Firewall Evasion Section -->
            <div id="firewall-evasion" class="module-section">
                <h2 class="section-title">🛡️ Firewall Detection & Evasion</h2>
                
                <div class="card">
                    <h3>🔍 Firewall Detection Techniques</h3>
                    <p>Before attempting evasion, it's crucial to identify the presence and type of firewalls protecting the target network. Different firewalls have unique behaviors and filtering rules that can be fingerprinted.</p>
                </div>

                <div class="firewall-detection">
                    <div class="firewall-card" onclick="showFirewallDetails('packet-filtering')">
                        <h4>📦 Packet Filtering Firewalls</h4>
                        <p><strong>Detection:</strong> ACK scan responses</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Simple rule-based filtering</li>
                            <li>Limited state awareness</li>
                            <li>Vulnerable to crafted packets</li>
                            <li>Examples: iptables, pfSense</li>
                        </ul>
                    </div>

                    <div class="firewall-card" onclick="showFirewallDetails('stateful')">
                        <h4>🔄 Stateful Firewalls</h4>
                        <p><strong>Detection:</strong> Connection state tracking</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Tracks connection states</li>
                            <li>More intelligent filtering</li>
                            <li>Harder to bypass</li>
                            <li>Examples: Cisco ASA, SonicWall</li>
                        </ul>
                    </div>

                    <div class="firewall-card" onclick="showFirewallDetails('application')">
                        <h4>🔬 Application Firewalls</h4>
                        <p><strong>Detection:</strong> Deep packet inspection</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Application layer filtering</li>
                            <li>Protocol analysis</li>
                            <li>Content inspection</li>
                            <li>Examples: Palo Alto, Fortinet</li>
                        </ul>
                    </div>

                    <div class="firewall-card" onclick="showFirewallDetails('waf')">
                        <h4>🌐 Web Application Firewalls</h4>
                        <p><strong>Detection:</strong> HTTP response analysis</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Web-specific protection</li>
                            <li>SQL injection prevention</li>
                            <li>XSS filtering</li>
                            <li>Examples: CloudFlare, AWS WAF</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3>🥷 Firewall Evasion Techniques</h3>
                    <div class="evasion-techniques">
                        <div class="evasion-card" onclick="showEvasionDetails('fragmentation')">
                            <h4>🧩 Packet Fragmentation</h4>
                            <p><code>nmap -f target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Splits packets into fragments</li>
                                <li>Bypasses simple firewalls</li>
                                <li>May cause reassembly issues</li>
                                <li>Use -ff for more fragmentation</li>
                            </ul>
                        </div>

                        <div class="evasion-card" onclick="showEvasionDetails('decoys')">
                            <h4>🎭 Decoy Scanning</h4>
                            <p><code>nmap -D RND:10 target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Uses multiple source IPs</li>
                                <li>Hides real source address</li>
                                <li>Overwhelms log analysis</li>
                                <li>Requires careful IP selection</li>
                            </ul>
                        </div>

                        <div class="evasion-card" onclick="showEvasionDetails('source-port')">
                            <h4>🔌 Source Port Manipulation</h4>
                            <p><code>nmap --source-port 53 target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Uses trusted source ports</li>
                                <li>Common: 53 (DNS), 20 (FTP)</li>
                                <li>Bypasses port-based filtering</li>
                                <li>Effective against basic ACLs</li>
                            </ul>
                        </div>

                        <div class="evasion-card" onclick="showEvasionDetails('timing')">
                            <h4>⏱️ Timing Evasion</h4>
                            <p><code>nmap -T1 target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Slows down scan rate</li>
                                <li>Avoids rate limiting</li>
                                <li>Bypasses threshold detection</li>
                                <li>Increases stealth factor</li>
                            </ul>
                        </div>

                        <div class="evasion-card" onclick="showEvasionDetails('mtu')">
                            <h4>📏 MTU Discovery</h4>
                            <p><code>nmap --mtu 24 target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Specifies packet size</li>
                                <li>Forces fragmentation</li>
                                <li>Must be multiple of 8</li>
                                <li>Confuses reassembly</li>
                            </ul>
                        </div>

                        <div class="evasion-card" onclick="showEvasionDetails('badsum')">
                            <h4>🧮 Bad Checksum</h4>
                            <p><code>nmap --badsum target</code></p>
                            <ul style="text-align: left; margin: 10px 0;">
                                <li>Sends invalid checksums</li>
                                <li>Tests firewall parsing</li>
                                <li>Identifies filtering behavior</li>
                                <li>Fingerprints security devices</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Firewall Evasion Demo</h3>
                    <div class="terminal" id="firewallEvasionTerminal">
                        <div class="terminal-line prompt">scanner@kali:~$ nmap -sS 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line warning">Note: Host seems down. If it is really up, but blocking our ping probes</div>
                        <div class="terminal-line warning">you could try -Pn (treat all hosts as online).</div>
                        <div class="terminal-line output">Nmap done: 1 IP address (0 hosts up) scanned in 3.05 seconds</div>
                        <div class="terminal-line prompt">scanner@kali:~$ nmap -sS -Pn -f --source-port 53 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line output">Nmap scan report for firewall-protected.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.045s latency).</div>
                        <div class="terminal-line output">PORT     STATE    SERVICE</div>
                        <div class="terminal-line output">22/tcp   filtered ssh</div>
                        <div class="terminal-line output">80/tcp   open     http</div>
                        <div class="terminal-line output">443/tcp  open     https</div>
                        <div class="terminal-line info">Firewall evasion successful! Target now responsive.</div>
                    </div>
                    <button class="btn" onclick="runFirewallEvasionDemo()">🔄 Try Different Evasion</button>
                </div>

                <button class="btn btn-success" onclick="showSection('stealth-scanning')">Next: Stealth Scanning →</button>
            </div>

            <!-- Stealth Scanning Section -->
            <div id="stealth-scanning" class="module-section">
                <h2 class="section-title">🥷 Stealth Scanning & IDS Evasion</h2>
                
                <div class="card">
                    <h3>🔍 Understanding IDS/IPS Systems</h3>
                    <p>Intrusion Detection Systems (IDS) and Intrusion Prevention Systems (IPS) monitor network traffic for suspicious activities. Understanding their detection methods is essential for developing effective evasion strategies.</p>
                </div>

                <div class="card">
                    <h3>🚨 IDS Detection Methods</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: #e74c3c; color: white; padding: 20px; border-radius: 10px;">
                            <h4>📝 Signature-Based Detection</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Known attack pattern matching</li>
                                <li>Fast and accurate for known threats</li>
                                <li>Vulnerable to pattern variations</li>
                                <li>Examples: Snort, Suricata rules</li>
                            </ul>
                        </div>
                        
                        <div style="background: #3498db; color: white; padding: 20px; border-radius: 10px;">
                            <h4>📊 Anomaly-Based Detection</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Baseline behavior analysis</li>
                                <li>Detects unknown attacks</li>
                                <li>Higher false positive rate</li>
                                <li>Machine learning enhanced</li>
                            </ul>
                        </div>
                        
                        <div style="background: #27ae60; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔄 Stateful Analysis</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Connection state tracking</li>
                                <li>Protocol validation</li>
                                <li>Session correlation</li>
                                <li>Advanced threat detection</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f39c12; color: white; padding: 20px; border-radius: 10px;">
                            <h4>⚡ Real-time Processing</h4>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Inline traffic inspection</li>
                                <li>Immediate response capability</li>
                                <li>Performance considerations</li>
                                <li>Blocking and alerting</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🥷 Advanced Stealth Techniques</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin: 20px 0;">
                        <div style="background: var(--stealth-color); color: white; padding: 20px; border-radius: 10px;">
                            <h4>🐌 Slow Scanning</h4>
                            <p><code>nmap -T0 -sS target</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Extremely slow timing</li>
                                <li>Avoids rate-based detection</li>
                                <li>5-minute delays between probes</li>
                                <li>Virtually undetectable</li>
                            </ul>
                        </div>
                        
                        <div style="background: #8e44ad; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔀 Randomization</h4>
                            <p><code>nmap --randomize-hosts target</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Random target order</li>
                                <li>Random port scanning</li>
                                <li>Breaks pattern recognition</li>
                                <li>Confuses correlation engines</li>
                            </ul>
                        </div>
                        
                        <div style="background: #16a085; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🔧 Custom Payloads</h4>
                            <p><code>nmap --data-string "test" target</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Custom packet data</li>
                                <li>Mimics legitimate traffic</li>
                                <li>Bypasses content inspection</li>
                                <li>Protocol-specific evasion</li>
                            </ul>
                        </div>
                        
                        <div style="background: #d35400; color: white; padding: 20px; border-radius: 10px;">
                            <h4>🌐 Proxy Chains</h4>
                            <p><code>proxychains nmap target</code></p>
                            <ul style="margin: 10px 0; line-height: 1.6;">
                                <li>Multiple proxy hops</li>
                                <li>Obscures source IP</li>
                                <li>Complicates attribution</li>
                                <li>Adds latency and complexity</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>🆕 AI-Enhanced Evasion (New in CEH v13!)</h3>
                    <p style="background: linear-gradient(45deg, var(--scan-primary), var(--scan-secondary)); color: white; padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <strong>Next-Generation Evasion:</strong> CEH v13 introduces AI-powered evasion techniques that adapt to security controls in real-time!
                    </p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>Adaptive Scanning:</strong> AI analyzes defensive responses and adjusts techniques</li>
                        <li><strong>Pattern Obfuscation:</strong> Machine learning generates non-signature-matching traffic</li>
                        <li><strong>Behavioral Mimicry:</strong> AI learns legitimate traffic patterns for blending</li>
                        <li><strong>Dynamic Timing:</strong> Intelligent delay calculation based on target behavior</li>
                        <li><strong>Evasion Optimization:</strong> Automated selection of best evasion combinations</li>
                    </ul>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Stealth Scanning Demo</h3>
                    <div class="terminal" id="stealthScanTerminal">
                        <div class="terminal-line prompt">stealth@kali:~$ nmap -sS -T1 -f -D RND:5 --source-port 53 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line info">Using stealth mode: fragmented packets, decoys, slow timing</div>
                        <div class="terminal-line output">Nmap scan report for stealth-target.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.12s latency).</div>
                        <div class="terminal-line output">PORT     STATE    SERVICE</div>
                        <div class="terminal-line output">22/tcp   open     ssh</div>
                        <div class="terminal-line output">80/tcp   open     http</div>
                        <div class="terminal-line output">443/tcp  filtered https</div>
                        <div class="terminal-line output">3306/tcp closed   mysql</div>
                        <div class="terminal-line info">Stealth scan completed without IDS detection</div>
                        <div class="terminal-line prompt">stealth@kali:~$ ./ai_adaptive_scan.py --target 192.168.1.100</div>
                        <div class="terminal-line output">AI-Enhanced Stealth Scanner v2.0 - CEH v13</div>
                        <div class="terminal-line output">Analyzing target defensive posture...</div>
                        <div class="terminal-line info">[AI] IDS signature patterns detected and cataloged</div>
                        <div class="terminal-line info">[AI] Optimizing evasion strategy in real-time</div>
                        <div class="terminal-line output">Adaptive scan complete - 0 alerts generated</div>
                    </div>
                    <button class="btn" onclick="runStealthScanDemo()">🔄 Run AI-Enhanced Stealth</button>
                </div>

                <div class="card">
                    <h3>🛡️ IDS/IPS Evasion Strategies</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px;">
                            <h4>⏰ Timing-Based Evasion</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li>Spread scans across extended periods</li>
                                <li>Mimic normal business hours traffic</li>
                                <li>Use random delays between packets</li>
                                <li>Avoid suspicious scan patterns</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 20px; border-radius: 12px;">
                            <h4>🎭 Traffic Camouflage</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li>Blend with legitimate traffic patterns</li>
                                <li>Use common user-agent strings</li>
                                <li>Mimic standard protocol behavior</li>
                                <li>Hide in encrypted tunnels</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 20px; border-radius: 12px;">
                            <h4>🔀 Protocol Manipulation</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li>Use unexpected protocol combinations</li>
                                <li>Leverage protocol weaknesses</li>
                                <li>Fragment across multiple protocols</li>
                                <li>Exploit parser limitations</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; padding: 20px; border-radius: 12px;">
                            <h4>🎯 Target Segmentation</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li>Divide scans across multiple sources</li>
                                <li>Use distributed scanning networks</li>
                                <li>Coordinate multi-stage attacks</li>
                                <li>Employ compartmentalized techniques</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>📊 Stealth Assessment Metrics</h3>
                    <p>Evaluating the effectiveness of stealth techniques:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>Detection Rate:</strong> Percentage of scans triggering alerts</li>
                        <li><strong>False Positive Generation:</strong> Ability to blend with legitimate traffic</li>
                        <li><strong>Time to Detection:</strong> How long before suspicious activity is identified</li>
                        <li><strong>Attribution Difficulty:</strong> Complexity of tracing back to source</li>
                        <li><strong>Coverage Completeness:</strong> Information gathered vs. detection risk</li>
                    </ul>
                </div>

                <button class="btn btn-success" onclick="showSection('vulnerability-scanning')">Next: Vulnerability Scanning →</button>
            </div>

            <!-- Vulnerability Scanning Section -->
            <div id="vulnerability-scanning" class="module-section">
                <h2 class="section-title">🚨 Vulnerability Scanning</h2>
                
                <div class="card">
                    <h3>🔍 Understanding Vulnerability Assessment</h3>
                    <p>Vulnerability scanning automates the process of identifying security weaknesses in systems, applications, and network infrastructure. It combines port scanning with security checks to provide comprehensive risk assessment.</p>
                </div>

                <div class="vulnerability-scanners">
                    <div class="vuln-card" onclick="showVulnScannerDetails('openvas')">
                        <h4>🔓 OpenVAS</h4>
                        <p>Open-source vulnerability scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>50,000+ vulnerability tests</li>
                            <li>Comprehensive web interface</li>
                            <li>Detailed reporting</li>
                            <li>Regular NVT updates</li>
                        </ul>
                    </div>

                    <div class="vuln-card" onclick="showVulnScannerDetails('nessus')">
                        <h4>🎯 Nessus</h4>
                        <p>Professional vulnerability scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Industry-leading accuracy</li>
                            <li>Cloud and on-premise scanning</li>
                            <li>Compliance reporting</li>
                            <li>Advanced correlation</li>
                        </ul>
                    </div>

                    <div class="vuln-card" onclick="showVulnScannerDetails('nikto')">
                        <h4>🌐 Nikto</h4>
                        <p>Web application vulnerability scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Web server testing</li>
                            <li>6,700+ vulnerability checks</li>
                            <li>Plugin architecture</li>
                            <li>Fast and efficient</li>
                        </ul>
                    </div>

                    <div class="vuln-card" onclick="showVulnScannerDetails('nuclei')">
                        <h4>⚡ Nuclei</h4>
                        <p>Fast vulnerability scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Template-based scanning</li>
                            <li>Community-driven templates</li>
                            <li>High-speed scanning</li>
                            <li>YAML-based rules</li>
                        </ul>
                    </div>

                    <div class="vuln-card" onclick="showVulnScannerDetails('qualys')">
                        <h4>☁️ Qualys VMDR</h4>
                        <p>Cloud-based vulnerability management</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Continuous monitoring</li>
                            <li>Asset discovery</li>
                            <li>Risk prioritization</li>
                            <li>Compliance tracking</li>
                        </ul>
                    </div>

                    <div class="vuln-card" onclick="showVulnScannerDetails('rapid7')">
                        <h4>🔍 Rapid7 InsightVM</h4>
                        <p>Vulnerability risk management</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Real-time vulnerability data</li>
                            <li>Dynamic asset discovery</li>
                            <li>Risk-based prioritization</li>
                            <li>Remediation workflows</li>
                        </ul>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3>🎮 Vulnerability Scanning Demo</h3>
                    <div class="terminal" id="vulnScanTerminal">
                        <div class="terminal-line prompt">vuln@kali:~$ nmap --script vuln 192.168.1.100</div>
                        <div class="terminal-line output">Starting Nmap 7.94 ( https://nmap.org )</div>
                        <div class="terminal-line output">Nmap scan report for webserver.local (192.168.1.100)</div>
                        <div class="terminal-line output">Host is up (0.0012s latency).</div>
                        <div class="terminal-line output">PORT     STATE SERVICE</div>
                        <div class="terminal-line output">22/tcp   open  ssh</div>
                        <div class="terminal-line output">| ssh-vuln-cve2018-15473:</div>
                        <div class="terminal-line output">|   VULNERABLE:</div>
                        <div class="terminal-line output">|   Username enumeration via malformed packet</div>
                        <div class="terminal-line output">80/tcp   open  http</div>
                        <div class="terminal-line output">|_http-vuln-cve2017-1001000: ERROR: Script execution failed</div>
                        <div class="terminal-line output">| http-enum:</div>
                        <div class="terminal-line output">|   /admin/: Possible admin folder</div>
                        <div class="terminal-line output">|   /backup/: Backup directory</div>
                        <div class="terminal-line warning">|_  /phpinfo.php: PHP configuration info</div>
                        <div class="terminal-line error">| http-vuln-cve2014-6271:</div>
                        <div class="terminal-line error">|   VULNERABLE:</div>
                        <div class="terminal-line error">|   CVE-2014-6271 Bash Bug vulnerability (Shellshock)</div>
                        <div class="terminal-line output">Nmap done: 1 IP address (1 host up) scanned in 45.67 seconds</div>
                    </div>
                    <button class="btn" onclick="runVulnScanDemo()">🔄 Run Advanced Vuln Scan</button>
                </div>

                <div class="card">
                    <h3>📈 Vulnerability Management Process</h3>
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin: 20px 0;">
                        <h4>🔄 Continuous Process:</h4>
                        <ol style="margin: 15px 0; line-height: 2; padding-left: 20px;">
                            <li><strong>Asset Discovery:</strong> Identify all systems and applications in scope</li>
                            <li><strong>Vulnerability Scanning:</strong> Automated detection of security weaknesses</li>
                            <li><strong>Risk Assessment:</strong> Prioritize vulnerabilities based on exploitability</li>
                            <li><strong>Remediation Planning:</strong> Develop patches and mitigation strategies</li>
                            <li><strong>Implementation:</strong> Apply fixes and security controls</li>
                            <li><strong>Verification:</strong> Confirm successful remediation</li>
                            <li><strong>Reporting:</strong> Document findings and track progress</li>
                        </ol>
                    </div>
                </div>

                <button class="btn btn-success" onclick="showSection('tools')">Next: Tools & Techniques →</button>
            </div>

            <!-- Tools & Techniques Section -->
            <div id="tools" class="module-section">
                <h2 class="section-title">🛠️ Scanning Tools & Techniques</h2>
                
                <div class="card">
                    <h3>🎯 Essential Scanning Arsenal</h3>
                    <p>Master these fundamental tools and advanced techniques to become proficient in network scanning and reconnaissance. Each tool has specific strengths and use cases in different scenarios.</p>
                </div>

                <div class="tools-grid">
                    <div class="tool-card" onclick="showScanToolDetails('nmap')">
                        <h4>🗺️ Nmap</h4>
                        <p>The ultimate network mapper and port scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Comprehensive scanning options</li>
                            <li>NSE scripting engine</li>
                            <li>OS and service detection</li>
                            <li>Stealth and evasion techniques</li>
                        </ul>
                    </div>

                    <div class="tool-card" onclick="showScanToolDetails('masscan')">
                        <h4>⚡ Masscan</h4>
                        <p>Internet-scale port scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Extremely fast scanning</li>
                            <li>Stateless operation</li>
                            <li>Custom packet rates</li>
                            <li>Large network ranges</li>
                        </ul>
                    </div>

                    <div class="tool-card" onclick="showScanToolDetails('hping3')">
                        <h4>🎯 Hping3</h4>
                        <p>Advanced packet crafting and analysis</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Custom packet creation</li>
                            <li>Firewall testing</li>
                            <li>Network troubleshooting</li>
                            <li>Advanced ping techniques</li>
                        </ul>
                    </div>

                    <div class="tool-card" onclick="showScanToolDetails('unicornscan')">
                        <h4>🦄 Unicornscan</h4>
                        <p>Fast and flexible port scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Asynchronous scanning</li>
                            <li>TCP and UDP support</li>
                            <li>Banner grabbing</li>
                            <li>Distributed scanning</li>
                        </ul>
                    </div>

                    <div class="tool-card" onclick="showScanToolDetails('netdiscover')">
                        <h4>🔍 Netdiscover</h4>
                        <p>ARP-based network discovery</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Layer 2 discovery</li>
                            <li>Passive monitoring</li>
                            <li>MAC address detection</li>
                            <li>Local network mapping</li>
                        </ul>
                    </div>

                    <div class="tool-card" onclick="showScanToolDetails('zmap')">
                        <h4>🌍 Zmap</h4>
                        <p>Internet-wide network scanner</p>
                        <ul style="text-align: left; margin: 10px 0;">
                            <li>Billion+ IP scanning</li>
                            <li>Research-grade speed</li>
                            <li>Stateless architecture</li>
                            <li>Academic applications</li>
                        </ul>
                    </div>
                </div>

                <button class="btn btn-success" onclick="showSection('resources')">Next: Resources & References →</button>
            </div>

            <!-- Resources Section -->
            <div id="resources" class="module-section">
                <h2 class="section-title">📚 Essential Resources & Tools</h2>
                
                <div class="card">
                    <h3>🎯 CEH v13 Module 3 Official Resources</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: linear-gradient(135deg, var(--scan-primary), var(--scan-secondary)); color: white; padding: 20px; border-radius: 12px;">
                            <h4>🏢 EC-Council Official</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li><a href="https://www.eccouncil.org/train-certify/certified-ethical-hacker-ceh/" target="_blank" style="color: #fff; text-decoration: underline;">CEH v13 Certification</a></li>
                                <li><a href="https://www.eccouncil.org/ilabs/" target="_blank" style="color: #fff; text-decoration: underline;">EC-Council iLabs</a></li>
                                <li><a href="https://www.eccouncil.org/cybersecurity-exchange/" target="_blank" style="color: #fff; text-decoration: underline;">Security Knowledge Base</a></li>
                                <li><a href="https://www.eccouncil.org/vulnerability-intel/" target="_blank" style="color: #fff; text-decoration: underline;">Vulnerability Intelligence</a></li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 20px; border-radius: 12px;">
                            <h4>📖 Study Materials</h4>
                            <ul style="margin: 10px 0; line-height: 1.8;">
                                <li><a href="https://www.amazon.com/Certified-Ethical-Hacker-Study-Guide/dp/1119533198" target="_blank" style="color: #fff; text-decoration: underline;">CEH v13 Study Guide</a></li>
                                <li><a href="https://www.wiley.com/en-us/CEH+Certified+Ethical+Hacker+Practice+Exams%2C+5th+Edition-p-9781260461909" target="_blank" style="color: #fff; text-decoration: underline;">Practice Exams</a></li>
                                <li><a href="https://www.pearsonitcertification.com/store/ceh-certified-ethical-hacker-all-in-one-exam-guide-9781260461893" target="_blank" style="color: #fff; text-decoration: underline;">All-in-One Guide</a></li>
                                <li><a href="https://www.udemy.com/topic/ethical-hacking/" target="_blank" style="color: #fff; text-decoration: underline;">Video Courses</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <button class="btn btn-success" onclick="showSection('assessment')">Next: Module Assessment →</button>
            </div>

            <!-- Assessment Section -->
            <div id="assessment" class="module-section">
                <h2 class="section-title">🎯 Module 3 Assessment</h2>
                
                <div class="card">
                    <h3>📊 Comprehensive Network Scanning Knowledge Test</h3>
                    <p>Test your understanding of all Module 3 concepts including port scanning techniques, host discovery, service detection, firewall evasion, and vulnerability scanning. Answer all questions to receive your score and detailed feedback.</p>
                    <div id="assessmentScore" class="score-display" style="display: none;"></div>
                </div>

                <div class="quiz-container" id="comprehensiveAssessment">
                    <!-- Questions will be populated by JavaScript -->
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-success" onclick="submitAssessment()" id="submitAssessmentBtn">📝 Submit Assessment</button>
                    <button class="btn btn-warning" onclick="resetAssessment()" id="resetAssessmentBtn" style="display: none;">🔄 Retake Assessment</button>
                </div>

                <button class="btn btn-success" onclick="showSection('lab')" style="display: none;" id="labAccessBtn">Next: Hands-on Lab →</button>
            </div>

            <!-- Lab Section -->
            <div id="lab" class="module-section">
                <h2 class="section-title">🧪 Hands-on Lab: Advanced Network Scanning</h2>
                
                <div class="card">
                    <h3>🎯 Lab Objectives</h3>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>Perform comprehensive network discovery and host enumeration</li>
                        <li>Master various port scanning techniques and timing options</li>
                        <li>Conduct service detection and OS fingerprinting</li>
                        <li>Practice firewall evasion and stealth scanning methods</li>
                        <li>Execute vulnerability scanning and assessment</li>
                        <li>Generate professional scanning reports and recommendations</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>🎉 Congratulations!</h3>
                    <p>You have successfully completed CEH v13 Module 3: Scanning Networks!</p>
                    
                    <h4>📈 Your Learning Journey:</h4>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>✅ Mastered network scanning fundamentals and methodologies</li>
                        <li>✅ Learned advanced port scanning techniques (TCP, UDP, SYN, stealth)</li>
                        <li>✅ Practiced host discovery and network mapping</li>
                        <li>✅ Performed service detection and OS fingerprinting</li>
                        <li>✅ Applied firewall identification and evasion techniques</li>
                        <li>✅ Executed IDS/IPS evasion and stealth scanning</li>
                        <li>✅ Completed vulnerability scanning and assessment</li>
                    </ul>
                    
                    <h4>🚀 Next Steps:</h4>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>Continue to Module 4: Enumeration</li>
                        <li>Practice with real-world scanning scenarios</li>
                        <li>Build your network scanning toolkit</li>
                        <li>Prepare for the comprehensive CEH v13 certification exam</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for detailed information -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 'overview';
        let completedSections = [];
        let assessmentAnswers = {};
        let sectionOrder = ['overview', 'fundamentals', 'port-scanning', 'host-discovery', 'service-detection', 'firewall-evasion', 'stealth-scanning', 'vulnerability-scanning', 'tools', 'resources', 'assessment', 'lab'];
        let assessmentQuestions = [
            {
                question: "Which Nmap scan type completes the full TCP three-way handshake?",
                options: ["SYN scan (-sS)", "TCP Connect scan (-sT)", "FIN scan (-sF)", "NULL scan (-sN)"],
                correct: 1,
                explanation: "TCP Connect scan (-sT) completes the full TCP handshake, making it more detectable but more accurate."
            },
            {
                question: "What does a 'filtered' port state typically indicate?",
                options: ["Port is open and accepting connections", "Port is closed", "Firewall is blocking the port", "Service is not responding"],
                correct: 2,
                explanation: "A filtered port state indicates that a firewall, packet filter, or other network obstacle is blocking access to the port."
            },
            {
                question: "Which Nmap timing template is the most aggressive?",
                options: ["-T0 (Paranoid)", "-T3 (Normal)", "-T4 (Aggressive)", "-T5 (Insane)"],
                correct: 3,
                explanation: "-T5 (Insane) is the most aggressive timing template, sending packets as fast as possible."
            },
            {
                question: "What is the primary advantage of SYN stealth scanning?",
                options: ["Faster than TCP connect", "Doesn't complete connections", "Works without root privileges", "More accurate results"],
                correct: 1,
                explanation: "SYN stealth scanning doesn't complete the TCP connection, making it stealthier and less likely to be logged."
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            generateAssessment();
            setupKeyboardNavigation();
        });

        // Keyboard navigation setup
        function setupKeyboardNavigation() {
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeModal();
                    return;
                }
                
                if (event.key === 'ArrowLeft') {
                    navigateSection('previous');
                    event.preventDefault();
                } else if (event.key === 'ArrowRight') {
                    navigateSection('next');
                    event.preventDefault();
                }
            });
        }

        // Navigate between sections using keyboard
        function navigateSection(direction) {
            const currentIndex = sectionOrder.indexOf(currentSection);
            let newIndex;
            
            if (direction === 'next') {
                newIndex = currentIndex + 1;
                if (newIndex >= sectionOrder.length) newIndex = 0;
            } else if (direction === 'previous') {
                newIndex = currentIndex - 1;
                if (newIndex < 0) newIndex = sectionOrder.length - 1;
            }
            
            const newSection = sectionOrder[newIndex];
            showSection(newSection);
        }

        // Section navigation
        function showSection(sectionId) {
            document.querySelectorAll('.module-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const sectionIndex = sectionOrder.indexOf(sectionId);
            const navButtons = document.querySelectorAll('.nav-btn');
            if (navButtons[sectionIndex]) {
                navButtons[sectionIndex].classList.add('active');
            }
            
            if (!completedSections.includes(sectionId)) {
                completedSections.push(sectionId);
                updateProgress();
            }
            
            currentSection = sectionId;
        }

        // Progress tracking
        function updateProgress() {
            const totalSections = 12;
            const progressPercent = (completedSections.length / totalSections) * 100;
            document.getElementById('progressBar').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = `Progress: ${Math.round(progressPercent)}% Complete`;
        }

        // Methodology details
        function showMethodologyDetails(phase) {
            const phases = {
                'host-discovery': {
                    title: 'Host Discovery',
                    description: 'Identifying live systems on the target network',
                    techniques: [
                        'ICMP ping sweeps',
                        'TCP SYN/ACK pings',
                        'UDP ping probes',
                        'ARP requests (local networks)',
                        'DNS reverse lookups'
                    ],
                    tools: ['Nmap -sn', 'Masscan', 'Fping', 'Netdiscover', 'Hping3']
                },
                'port-scanning': {
                    title: 'Port Scanning',
                    description: 'Enumerating open, closed, and filtered ports',
                    techniques: [
                        'TCP Connect scans',
                        'SYN stealth scans',
                        'UDP scans',
                        'Advanced stealth scans',
                        'Timing optimization'
                    ],
                    tools: ['Nmap', 'Masscan', 'Unicornscan', 'Hping3', 'Zmap']
                },
                'service-enum': {
                    title: 'Service Enumeration',
                    description: 'Identifying services, versions, and banners running on open ports',
                    techniques: [
                        'Banner grabbing',
                        'Service probes',
                        'Protocol-specific enumeration',
                        'SSL/TLS certificate analysis',
                        'Application fingerprinting'
                    ],
                    tools: ['Nmap -sV', 'Banner grabbing tools', 'NSE scripts', 'Telnet', 'Netcat']
                },
                'os-detection': {
                    title: 'OS Detection',
                    description: 'Determining operating systems and their versions through fingerprinting',
                    techniques: [
                        'TCP/IP stack fingerprinting',
                        'ICMP fingerprinting',
                        'Port behavior analysis',
                        'Service characteristics',
                        'Time-based analysis'
                    ],
                    tools: ['Nmap -O', 'p0f', 'Xprobe2', 'httprint', 'Amap']
                },
                'vuln-assessment': {
                    title: 'Vulnerability Assessment',
                    description: 'Identifying potential security weaknesses and misconfigurations',
                    techniques: [
                        'Automated vulnerability scanning',
                        'Configuration assessment',
                        'Patch level analysis',
                        'Compliance checking',
                        'Risk prioritization'
                    ],
                    tools: ['OpenVAS', 'Nessus', 'Nmap --script vuln', 'Nikto', 'Nuclei']
                }
            };
            
            const phaseData = phases[phase] || phases['host-discovery'];
            const content = `
                <h2>${phaseData.title}</h2>
                <h3>Description:</h3>
                <p>${phaseData.description}</p>
                
                <h3>Key Techniques:</h3>
                <ul>
                    ${phaseData.techniques.map(technique => `<li>${technique}</li>`).join('')}
                </ul>
                
                <h3>Common Tools:</h3>
                <ul>
                    ${phaseData.tools.map(tool => `<li>${tool}</li>`).join('')}
                </ul>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Start with passive techniques when possible</li>
                    <li>Use timing controls to avoid detection</li>
                    <li>Validate results with multiple methods</li>
                    <li>Document all findings thoroughly</li>
                </ul>
            `;
            showModal(content);
        }

        // Port state details
        function showPortStateDetails(state) {
            const states = {
                'open': {
                    title: 'Open Port',
                    description: 'A service is actively listening and accepting connections',
                    characteristics: [
                        'Service responds to connection attempts',
                        'TCP handshake completes successfully',
                        'Application layer protocols accessible',
                        'Potential entry point for attackers'
                    ],
                    examples: ['Web server on port 80/443', 'SSH on port 22', 'Email on port 25/110/143']
                },
                'closed': {
                    title: 'Closed Port',
                    description: 'No service is listening, but the port is accessible',
                    characteristics: [
                        'Target system receives probe',
                        'Responds with RST packet',
                        'No firewall blocking access',
                        'System is reachable but service inactive'
                    ],
                    examples: ['Unused service ports', 'Disabled services', 'Non-standard port assignments']
                },
                'filtered': {
                    title: 'Filtered Port',
                    description: 'Firewall or packet filter is blocking access',
                    characteristics: [
                        'No response to connection attempts',
                        'Packets dropped silently',
                        'May indicate security controls',
                        'Requires evasion techniques'
                    ],
                    examples: ['Firewall-protected services', 'ACL-blocked ports', 'IPS-filtered traffic']
                },
                'unfiltered': {
                    title: 'Unfiltered Port',
                    description: 'Port is accessible but state cannot be determined',
                    characteristics: [
                        'Responds to probes but state unclear',
                        'ACK scan technique specific',
                        'Firewall allows packets through',
                        'Requires additional scanning'
                    ],
                    examples: ['Stateless firewall behind target', 'Firewall allows ACK packets', 'Complex network topology']
                }
            };
            
            const stateData = states[state] || states['open'];
            const content = `
                <h2>${stateData.title}</h2>
                <h3>Description:</h3>
                <p>${stateData.description}</p>
                
                <h3>Characteristics:</h3>
                <ul>
                    ${stateData.characteristics.map(char => `<li>${char}</li>`).join('')}
                </ul>
                
                <h3>Common Examples:</h3>
                <ul>
                    ${stateData.examples.map(example => `<li>${example}</li>`).join('')}
                </ul>
                
                <h3>Scanning Implications:</h3>
                <ul>
                    <li>Affects scan timing and technique selection</li>
                    <li>Influences result interpretation</li>
                    <li>Guides further enumeration efforts</li>
                    <li>Indicates security posture</li>
                </ul>
            `;
            showModal(content);
        }

        // Scan details
        function showScanDetails(scanType) {
            const scans = {
                'tcp': {
                    title: 'TCP Connect Scan (-sT)',
                    description: 'Completes the full TCP three-way handshake',
                    advantages: [
                        'Works without root privileges',
                        'Highly accurate results',
                        'Compatible with all TCP services',
                        'Standard compliant connection'
                    ],
                    disadvantages: [
                        'Easily detected and logged',
                        'Slower than stealth scans',
                        'Consumes system resources',
                        'May trigger intrusion detection'
                    ],
                    usage: 'nmap -sT target'
                },
                'syn': {
                    title: 'SYN Stealth Scan (-sS)',
                    description: 'Half-open scan that doesn\'t complete connections',
                    advantages: [
                        'Stealthier than TCP connect',
                        'Faster scanning speed',
                        'Less likely to be logged',
                        'Default Nmap scan type'
                    ],
                    disadvantages: [
                        'Requires root privileges',
                        'May not work through all firewalls',
                        'Some applications detect half-open connections',
                        'Raw socket dependency'
                    ],
                    usage: 'nmap -sS target'
                },
                'udp': {
                    title: 'UDP Scan (-sU)',
                    description: 'Discovers UDP services and applications',
                    advantages: [
                        'Finds UDP-only services',
                        'Important for complete assessment',
                        'Often overlooked by defenders',
                        'Reveals network services like DNS, DHCP'
                    ],
                    disadvantages: [
                        'Slower than TCP scans',
                        'Less reliable responses',
                        'Rate limiting by target systems',
                        'Requires careful interpretation'
                    ],
                    usage: 'nmap -sU target'
                },
                'stealth': {
                    title: 'Advanced Stealth Scans',
                    description: 'Multiple stealth techniques to evade detection',
                    advantages: [
                        'FIN scan (-sF): Sends FIN packets',
                        'XMAS scan (-sX): FIN, PSH, URG flags set',
                        'NULL scan (-sN): No flags set',
                        'Maimon scan (-sM): FIN/ACK combination'
                    ],
                    disadvantages: [
                        'OS-dependent behavior',
                        'May not work on all systems',
                        'Results can be ambiguous',
                        'Requires interpretation skills'
                    ],
                    usage: 'nmap -sF/-sX/-sN target'
                }
            };
            
            const scanData = scans[scanType] || scans['syn'];
            const content = `
                <h2>${scanData.title}</h2>
                <h3>Description:</h3>
                <p>${scanData.description}</p>
                
                <h3>Advantages:</h3>
                <ul>
                    ${scanData.advantages.map(adv => `<li>${adv}</li>`).join('')}
                </ul>
                
                <h3>Disadvantages:</h3>
                <ul>
                    ${scanData.disadvantages.map(dis => `<li>${dis}</li>`).join('')}
                </ul>
                
                <h3>Usage:</h3>
                <p><code>${scanData.usage}</code></p>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Combine with appropriate timing controls</li>
                    <li>Use in conjunction with other scan types</li>
                    <li>Consider target environment and constraints</li>
                    <li>Validate results with alternative methods</li>
                </ul>
            `;
            showModal(content);
        }

        // Command details
        function showCommandDetails(command) {
            const commands = {
                'basic-scan': {
                    title: 'Basic Port Scan',
                    command: 'nmap target',
                    description: 'Scans the top 1000 most common TCP ports',
                    options: [
                        'Uses SYN scan by default (with root)',
                        'TCP connect scan without root',
                        'Fast and efficient',
                        'Good starting point for reconnaissance'
                    ],
                    examples: [
                        'nmap 192.168.1.100',
                        'nmap scanme.nmap.org',
                        'nmap 192.168.1.0/24'
                    ]
                },
                'range-scan': {
                    title: 'Port Range Scan',
                    command: 'nmap -p 1-65535 target',
                    description: 'Scans all 65535 TCP ports on target',
                    options: [
                        'Comprehensive port coverage',
                        'May take significant time',
                        'Useful for thorough assessment',
                        'Can be combined with timing options'
                    ],
                    examples: [
                        'nmap -p 1-65535 192.168.1.100',
                        'nmap -p- target.com',
                        'nmap -p 1-1000,8000-9000 target'
                    ]
                },
                'service-scan': {
                    title: 'Service Version Detection',
                    command: 'nmap -sV target',
                    description: 'Probes open ports to determine service versions',
                    options: [
                        'Identifies service types and versions',
                        'Uses service-specific probes',
                        'May take longer than basic scans',
                        'Essential for vulnerability assessment'
                    ],
                    examples: [
                        'nmap -sV 192.168.1.100',
                        'nmap -sV --version-intensity 9 target',
                        'nmap -sV -p 80,443 target'
                    ]
                },
                'os-scan': {
                    title: 'OS Detection',
                    command: 'nmap -O target',
                    description: 'Attempts to identify target operating system',
                    options: [
                        'TCP/IP fingerprinting techniques',
                        'Requires root privileges',
                        'Needs at least one open port',
                        'May require multiple targets for accuracy'
                    ],
                    examples: [
                        'nmap -O 192.168.1.100',
                        'nmap -O --osscan-guess target',
                        'nmap -O --fuzzy target'
                    ]
                },
                'aggressive-scan': {
                    title: 'Aggressive Scan',
                    command: 'nmap -A target',
                    description: 'Comprehensive scan with multiple detection techniques',
                    options: [
                        'Enables OS detection (-O)',
                        'Version detection (-sV)',
                        'Script scanning (-sC)',
                        'Traceroute (--traceroute)'
                    ],
                    examples: [
                        'nmap -A 192.168.1.100',
                        'nmap -A -T4 target.com',
                        'nmap -A --script vuln target'
                    ]
                },
                'timing-scan': {
                    title: 'Timing Templates',
                    command: 'nmap -T[0-5] target',
                    description: 'Controls scan timing and aggressiveness',
                    options: [
                        'T0: Paranoid (very slow, stealthy)',
                        'T1: Sneaky (slow, less detectable)',
                        'T3: Normal (default timing)',
                        'T4-T5: Aggressive to Insane (fast)'
                    ],
                    examples: [
                        'nmap -T1 192.168.1.100',
                        'nmap -T4 target.com',
                        'nmap -T0 --scan-delay 5s target'
                    ]
                }
            };
            
            const cmdData = commands[command] || commands['basic-scan'];
            const content = `
                <h2>${cmdData.title}</h2>
                <h3>Command:</h3>
                <p><code>${cmdData.command}</code></p>
                
                <h3>Description:</h3>
                <p>${cmdData.description}</p>
                
                <h3>Options Included:</h3>
                <ul>
                    ${cmdData.options.map(option => `<li>${option}</li>`).join('')}
                </ul>
                
                <h3>Example Usage:</h3>
                <ul>
                    ${cmdData.examples.map(example => `<li><code>${example}</code></li>`).join('')}
                </ul>
                
                <h3>When to Use:</h3>
                <ul>
                    <li>Initial network reconnaissance</li>
                    <li>Comprehensive target assessment</li>
                    <li>Vulnerability discovery</li>
                    <li>Security baseline establishment</li>
                </ul>
            `;
            showModal(content);
        }

        // Discovery tool details
        function showDiscoveryToolDetails(tool) {
            const tools = {
                'netdiscover': {
                    name: 'Netdiscover',
                    description: 'ARP reconnaissance tool for discovering live hosts on local networks',
                    features: [
                        'Layer 2 network discovery',
                        'Passive and active modes',
                        'MAC address identification',
                        'Vendor identification from OUI'
                    ],
                    usage: 'netdiscover -r 192.168.1.0/24'
                },
                'masscan': {
                    name: 'Masscan',
                    description: 'Internet-scale port scanner for high-speed discovery',
                    features: [
                        'Extremely fast scanning rates',
                        'Stateless operation',
                        'Custom packet transmission rates',
                        'Large network range support'
                    ],
                    usage: 'masscan -p1-65535 192.168.1.0/24 --rate=1000'
                },
                'zmap': {
                    name: 'Zmap',
                    description: 'Internet-wide network scanner for research purposes',
                    features: [
                        'Designed for Internet-scale scanning',
                        'Single packet per target',
                        'Extremely high performance',
                        'Academic research tool'
                    ],
                    usage: 'zmap -p 80 -o results.csv 0.0.0.0/0'
                },
                'angry-ip': {
                    name: 'Angry IP Scanner',
                    description: 'Cross-platform network IP scanner with GUI interface',
                    features: [
                        'User-friendly graphical interface',
                        'Cross-platform compatibility',
                        'Customizable scan options',
                        'Export capabilities'
                    ],
                    usage: 'ipscan (GUI application)'
                },
                'fping': {
                    name: 'fping',
                    description: 'Parallel ping utility for multiple host discovery',
                    features: [
                        'Parallel ping operations',
                        'Fast host alive detection',
                        'Command-line efficiency',
                        'Multiple output formats'
                    ],
                    usage: 'fping -g 192.168.1.0/24'
                },
                'hping3': {
                    name: 'hping3',
                    description: 'Advanced packet crafting and network testing tool',
                    features: [
                        'Custom packet generation',
                        'Advanced ping techniques',
                        'Firewall testing capabilities',
                        'Network troubleshooting'
                    ],
                    usage: 'hping3 -S -p 80 target.com'
                }
            };
            
            const toolData = tools[tool] || tools['netdiscover'];
            const content = `
                <h2>${toolData.name}</h2>
                <h3>Description:</h3>
                <p>${toolData.description}</p>
                
                <h3>Key Features:</h3>
                <ul>
                    ${toolData.features.map(feature => `<li>${feature}</li>`).join('')}
                </ul>
                
                <h3>Basic Usage:</h3>
                <p><code>${toolData.usage}</code></p>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Use appropriate timing for network conditions</li>
                    <li>Respect network policies and authorization</li>
                    <li>Combine with other discovery methods</li>
                    <li>Validate results through multiple techniques</li>
                </ul>
            `;
            showModal(content);
        }

        // Firewall details
        function showFirewallDetails(type) {
            const firewalls = {
                'packet-filtering': {
                    title: 'Packet Filtering Firewalls',
                    description: 'Basic rule-based packet filtering',
                    characteristics: [
                        'Stateless operation',
                        'Simple rule-based filtering',
                        'Fast packet processing',
                        'Limited connection awareness'
                    ],
                    evasion: [
                        'ACK scanning can bypass',
                        'Source port manipulation',
                        'Fragmentation techniques',
                        'Protocol-specific bypasses'
                    ]
                },
                'stateful': {
                    title: 'Stateful Firewalls',
                    description: 'Track connection states and context',
                    characteristics: [
                        'Connection state tracking',
                        'Bidirectional flow monitoring',
                        'More intelligent filtering',
                        'Better security than packet filtering'
                    ],
                    evasion: [
                        'Timing manipulation',
                        'Advanced fragmentation',
                        'Protocol anomalies',
                        'State table exhaustion'
                    ]
                },
                'application': {
                    title: 'Application Layer Firewalls',
                    description: 'Deep packet inspection and application-aware filtering',
                    characteristics: [
                        'Application protocol analysis',
                        'Content inspection capabilities',
                        'Advanced threat detection',
                        'Policy-based controls'
                    ],
                    evasion: [
                        'Protocol tunneling',
                        'Encryption and encoding',
                        'Application-specific bypasses',
                        'Payload manipulation'
                    ]
                },
                'waf': {
                    title: 'Web Application Firewalls (WAF)',
                    description: 'Specialized protection for web applications',
                    characteristics: [
                        'HTTP/HTTPS traffic inspection',
                        'SQL injection prevention',
                        'XSS attack blocking',
                        'Application-specific rules'
                    ],
                    evasion: [
                        'HTTP parameter pollution',
                        'Encoding variations',
                        'Case manipulation',
                        'Comment insertion'
                    ]
                }
            };
            
            const firewallData = firewalls[type] || firewalls['packet-filtering'];
            const content = `
                <h2>${firewallData.title}</h2>
                <h3>Description:</h3>
                <p>${firewallData.description}</p>
                
                <h3>Characteristics:</h3>
                <ul>
                    ${firewallData.characteristics.map(char => `<li>${char}</li>`).join('')}
                </ul>
                
                <h3>Evasion Techniques:</h3>
                <ul>
                    ${firewallData.evasion.map(tech => `<li>${tech}</li>`).join('')}
                </ul>
                
                <h3>Detection Methods:</h3>
                <ul>
                    <li>Port scan response analysis</li>
                    <li>TTL and timing analysis</li>
                    <li>ICMP response patterns</li>
                    <li>Service banner analysis</li>
                </ul>
            `;
            showModal(content);
        }

        // Evasion details
        function showEvasionDetails(technique) {
            const techniques = {
                'fragmentation': {
                    title: 'Packet Fragmentation',
                    command: 'nmap -f target',
                    description: 'Splits packets into smaller fragments to evade detection',
                    advantages: [
                        'Bypasses simple packet filters',
                        'Confuses signature-based detection',
                        'May cause reassembly issues',
                        'Effective against basic firewalls'
                    ],
                    limitations: [
                        'Modern firewalls handle fragmentation',
                        'May cause network instability',
                        'Can be detected by advanced IDS',
                        'Reassembly timeouts possible'
                    ]
                },
                'decoys': {
                    title: 'Decoy Scanning',
                    command: 'nmap -D RND:10 target',
                    description: 'Uses multiple fake source IPs to hide the real scanner',
                    advantages: [
                        'Obscures real source address',
                        'Overwhelms log analysis',
                        'Confuses attribution',
                        'Distributes scanning load'
                    ],
                    limitations: [
                        'Requires spoofable network position',
                        'May impact network performance',
                        'Advanced correlation can detect',
                        'Increased scan complexity'
                    ]
                },
                'source-port': {
                    title: 'Source Port Manipulation',
                    command: 'nmap --source-port 53 target',
                    description: 'Uses trusted source ports to bypass filtering',
                    advantages: [
                        'Leverages trusted port numbers',
                        'Bypasses port-based ACLs',
                        'Common ports: 53 (DNS), 20 (FTP)',
                        'Simple but effective technique'
                    ],
                    limitations: [
                        'Only works with stateless filters',
                        'Limited to specific scenarios',
                        'May be detected by advanced systems',
                        'Requires knowledge of allowed ports'
                    ]
                },
                'timing': {
                    title: 'Timing Evasion',
                    command: 'nmap -T1 --scan-delay 10s target',
                    description: 'Slows down scan timing to avoid detection thresholds',
                    advantages: [
                        'Avoids rate-based detection',
                        'Bypasses threshold alerting',
                        'Mimics legitimate traffic patterns',
                        'Reduces network load'
                    ],
                    limitations: [
                        'Significantly increases scan time',
                        'May timeout on some networks',
                        'Requires patience and planning',
                        'Not suitable for time-sensitive assessments'
                    ]
                },
                'mtu': {
                    title: 'MTU Discovery Evasion',
                    command: 'nmap --mtu 24 target',
                    description: 'Forces specific packet sizes to confuse reassembly',
                    advantages: [
                        'Controls packet fragmentation',
                        'May bypass size-based filters',
                        'Confuses IDS reassembly',
                        'Customizable packet sizes'
                    ],
                    limitations: [
                        'MTU must be multiple of 8',
                        'May cause network issues',
                        'Limited effectiveness on modern systems',
                        'Requires understanding of network MTU'
                    ]
                },
                'badsum': {
                    title: 'Bad Checksum Technique',
                    command: 'nmap --badsum target',
                    description: 'Sends packets with invalid checksums for firewall testing',
                    advantages: [
                        'Tests firewall packet parsing',
                        'Identifies filtering behavior',
                        'Fingerprints security devices',
                        'Reveals implementation details'
                    ],
                    limitations: [
                        'Most systems will drop packets',
                        'Limited practical scanning value',
                        'Primarily for reconnaissance',
                        'May indicate scanning activity'
                    ]
                }
            };
            
            const techData = techniques[technique] || techniques['fragmentation'];
            const content = `
                <h2>${techData.title}</h2>
                <h3>Command:</h3>
                <p><code>${techData.command}</code></p>
                
                <h3>Description:</h3>
                <p>${techData.description}</p>
                
                <h3>Advantages:</h3>
                <ul>
                    ${techData.advantages.map(adv => `<li>${adv}</li>`).join('')}
                </ul>
                
                <h3>Limitations:</h3>
                <ul>
                    ${techData.limitations.map(lim => `<li>${lim}</li>`).join('')}
                </ul>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Test effectiveness before relying on technique</li>
                    <li>Combine with other evasion methods</li>
                    <li>Monitor for detection signatures</li>
                    <li>Adjust based on target responses</li>
                </ul>
            `;
            showModal(content);
        }

        // Vulnerability scanner details
        function showVulnScannerDetails(scanner) {
            const scanners = {
                'openvas': {
                    name: 'OpenVAS',
                    description: 'Comprehensive open-source vulnerability assessment framework',
                    features: [
                        '50,000+ Network Vulnerability Tests (NVTs)',
                        'Web-based management interface',
                        'Detailed reporting capabilities',
                        'Regular security feed updates'
                    ],
                    strengths: [
                        'No licensing costs',
                        'Highly customizable',
                        'Strong community support',
                        'Enterprise-grade features'
                    ],
                    use_cases: [
                        'Internal vulnerability assessments',
                        'Compliance scanning',
                        'Continuous monitoring',
                        'Security research'
                    ]
                },
                'nessus': {
                    name: 'Nessus',
                    description: 'Professional vulnerability scanner with industry-leading accuracy',
                    features: [
                        'High accuracy with low false positives',
                        'Cloud and on-premise deployment',
                        'Compliance framework support',
                        'Advanced vulnerability correlation'
                    ],
                    strengths: [
                        'Excellent detection accuracy',
                        'Comprehensive vulnerability database',
                        'Strong vendor support',
                        'Regular plugin updates'
                    ],
                    use_cases: [
                        'Professional penetration testing',
                        'Enterprise vulnerability management',
                        'Compliance assessments',
                        'Risk management programs'
                    ]
                },
                'nikto': {
                    name: 'Nikto',
                    description: 'Open-source web server scanner for security testing',
                    features: [
                        '6,700+ vulnerability and misconfiguration checks',
                        'Web server and application testing',
                        'Plugin-based architecture',
                        'Multiple output formats'
                    ],
                    strengths: [
                        'Specialized for web applications',
                        'Fast and efficient scanning',
                        'Extensive check database',
                        'Command-line simplicity'
                    ],
                    use_cases: [
                        'Web application security testing',
                        'Server configuration assessment',
                        'Quick web vulnerability checks',
                        'Automated security scanning'
                    ]
                },
                'nuclei': {
                    name: 'Nuclei',
                    description: 'Fast vulnerability scanner based on simple YAML templates',
                    features: [
                        'Template-based vulnerability detection',
                        'Community-driven template library',
                        'High-speed concurrent scanning',
                        'Easy customization and extension'
                    ],
                    strengths: [
                        'Very fast scanning speed',
                        'Simple template creation',
                        'Active community contributions',
                        'Modern architecture'
                    ],
                    use_cases: [
                        'Bug bounty hunting',
                        'Continuous security testing',
                        'Infrastructure monitoring',
                        'Custom vulnerability checks'
                    ]
                },
                'qualys': {
                    name: 'Qualys VMDR',
                    description: 'Cloud-based vulnerability management, detection, and response',
                    features: [
                        'Cloud-native scanning platform',
                        'Continuous asset discovery',
                        'Risk-based vulnerability prioritization',
                        'Integrated threat intelligence'
                    ],
                    strengths: [
                        'Scalable cloud infrastructure',
                        'Comprehensive asset visibility',
                        'Advanced analytics and reporting',
                        'Compliance management'
                    ],
                    use_cases: [
                        'Enterprise vulnerability management',
                        'Cloud security assessment',
                        'Compliance monitoring',
                        'Risk management'
                    ]
                },
                'rapid7': {
                    name: 'Rapid7 InsightVM',
                    description: 'Vulnerability risk management with live dashboards and analytics',
                    features: [
                        'Real-time vulnerability data',
                        'Dynamic asset discovery',
                        'Risk-based prioritization',
                        'Remediation workflow management'
                    ],
                    strengths: [
                        'Live vulnerability data',
                        'Excellent risk prioritization',
                        'Strong integration capabilities',
                        'User-friendly interface'
                    ],
                    use_cases: [
                        'Enterprise risk management',
                        'DevSecOps integration',
                        'Remediation tracking',
                        'Security metrics and reporting'
                    ]
                }
            };
            
            const scannerData = scanners[scanner] || scanners['openvas'];
            const content = `
                <h2>${scannerData.name}</h2>
                <h3>Description:</h3>
                <p>${scannerData.description}</p>
                
                <h3>Key Features:</h3>
                <ul>
                    ${scannerData.features.map(feature => `<li>${feature}</li>`).join('')}
                </ul>
                
                <h3>Strengths:</h3>
                <ul>
                    ${scannerData.strengths.map(strength => `<li>${strength}</li>`).join('')}
                </ul>
                
                <h3>Common Use Cases:</h3>
                <ul>
                    ${scannerData.use_cases.map(usecase => `<li>${usecase}</li>`).join('')}
                </ul>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Keep vulnerability databases updated</li>
                    <li>Validate findings with manual testing</li>
                    <li>Prioritize based on risk assessment</li>
                    <li>Integrate with vulnerability management workflow</li>
                </ul>
            `;
            showModal(content);
        }

        // Scanning tool details
        function showScanToolDetails(tool) {
            const tools = {
                'nmap': {
                    name: 'Nmap (Network Mapper)',
                    description: 'The ultimate network discovery and security auditing tool',
                    features: [
                        'Comprehensive port scanning options',
                        'OS and service detection',
                        'NSE scripting engine with 600+ scripts',
                        'Timing and stealth options'
                    ],
                    advanced_features: [
                        'Custom packet crafting',
                        'Firewall evasion techniques',
                        'IPv6 support',
                        'Zenmap GUI interface'
                    ],
                    usage_examples: [
                        'nmap -sS -sV -O target',
                        'nmap --script vuln target',
                        'nmap -T4 -A target/24'
                    ]
                },
                'masscan': {
                    name: 'Masscan',
                    description: 'Internet-scale asynchronous port scanner',
                    features: [
                        'Extremely high scanning speeds',
                        'Stateless scanning architecture',
                        'Custom transmission rates',
                        'Minimal resource consumption'
                    ],
                    advanced_features: [
                        'Banner grabbing capabilities',
                        'Output format compatibility',
                        'Rate limiting controls',
                        'Exclude list support'
                    ],
                    usage_examples: [
                        'masscan -p1-65535 10.0.0.0/8 --rate=1000',
                        'masscan -p80,443 0.0.0.0/0 --rate=10000',
                        'masscan --banners -p1-1000 target/24'
                    ]
                },
                'hping3': {
                    name: 'Hping3',
                    description: 'Advanced packet crafting and network testing tool',
                    features: [
                        'Custom packet generation',
                        'Multiple protocol support',
                        'Advanced timing controls',
                        'Scriptable interface'
                    ],
                    advanced_features: [
                        'Firewall and IDS testing',
                        'Network troubleshooting',
                        'Performance testing',
                        'Traceroute functionality'
                    ],
                    usage_examples: [
                        'hping3 -S -p 80 target.com',
                        'hping3 -c 1000 -i u1000 target',
                        'hping3 --traceroute -S -p 80 target'
                    ]
                },
                'unicornscan': {
                    name: 'Unicornscan',
                    description: 'Fast and flexible port scanner with asynchronous capabilities',
                    features: [
                        'Asynchronous TCP and UDP scanning',
                        'Distributed scanning support',
                        'Banner grabbing',
                        'Flexible output formats'
                    ],
                    advanced_features: [
                        'Active and passive modes',
                        'Custom payload support',
                        'Advanced timing controls',
                        'Stealth scanning options'
                    ],
                    usage_examples: [
                        'unicornscan -mT 192.168.1.0/24:1-1000',
                        'unicornscan -mU -Iv target:1-65535',
                        'unicornscan -msf target:a'
                    ]
                },
                'netdiscover': {
                    name: 'Netdiscover',
                    description: 'ARP reconnaissance tool for local network discovery',
                    features: [
                        'Layer 2 network discovery',
                        'Passive and active scanning',
                        'MAC address identification',
                        'Vendor OUI lookup'
                    ],
                    advanced_features: [
                        'Network range specification',
                        'Custom interface selection',
                        'Stealth passive mode',
                        'Export capabilities'
                    ],
                    usage_examples: [
                        'netdiscover -r 192.168.1.0/24',
                        'netdiscover -i eth0 -r 10.0.0.0/8',
                        'netdiscover -p'
                    ]
                },
                'zmap': {
                    name: 'Zmap',
                    description: 'Internet-wide network scanner for research purposes',
                    features: [
                        'Internet-scale scanning capability',
                        'Single packet per target',
                        'Extremely high performance',
                        'Research-oriented design'
                    ],
                    advanced_features: [
                        'Custom probe modules',
                        'Statistical sampling',
                        'Blacklist/whitelist support',
                        'Academic research features'
                    ],
                    usage_examples: [
                        'zmap -p 80 -o results.csv 0.0.0.0/0',
                        'zmap -p 443 --rate=10000 10.0.0.0/8',
                        'zmap -M icmp_echoscan 192.168.0.0/16'
                    ]
                }
            };
            
            const toolData = tools[tool] || tools['nmap'];
            const content = `
                <h2>${toolData.name}</h2>
                <h3>Description:</h3>
                <p>${toolData.description}</p>
                
                <h3>Core Features:</h3>
                <ul>
                    ${toolData.features.map(feature => `<li>${feature}</li>`).join('')}
                </ul>
                
                <h3>Advanced Features:</h3>
                <ul>
                    ${toolData.advanced_features.map(feature => `<li>${feature}</li>`).join('')}
                </ul>
                
                <h3>Usage Examples:</h3>
                <ul>
                    ${toolData.usage_examples.map(example => `<li><code>${example}</code></li>`).join('')}
                </ul>
                
                <h3>Best Practices:</h3>
                <ul>
                    <li>Always obtain proper authorization before scanning</li>
                    <li>Use appropriate timing to avoid detection</li>
                    <li>Combine with other tools for comprehensive assessment</li>
                    <li>Validate results through multiple methods</li>
                </ul>
            `;
            showModal(content);
        }

        // Assessment functions
        function generateAssessment() {
            const assessmentContainer = document.getElementById('comprehensiveAssessment');
            assessmentContainer.innerHTML = assessmentQuestions.map((q, index) => `
                <div class="question">
                    <h4>Question ${index + 1}: ${q.question}</h4>
                    <div class="options">
                        ${q.options.map((option, optIndex) => `
                            <div class="option" onclick="selectAssessmentOption(${index}, ${optIndex}, this)">
                                ${String.fromCharCode(65 + optIndex)}) ${option}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function selectAssessmentOption(questionIndex, optionIndex, element) {
            assessmentAnswers[questionIndex] = optionIndex;
            
            element.parentNode.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        function submitAssessment() {
            let score = 0;
            let totalQuestions = assessmentQuestions.length;
            
            for (let i = 0; i < totalQuestions; i++) {
                if (assessmentAnswers[i] === assessmentQuestions[i].correct) {
                    score++;
                }
            }
            
            const percentage = Math.round((score / totalQuestions) * 100);
            
            const scoreDisplay = document.getElementById('assessmentScore');
            scoreDisplay.style.display = 'block';
            scoreDisplay.innerHTML = `
                <h3>Assessment Results</h3>
                <p>Score: ${score}/${totalQuestions} (${percentage}%)</p>
                <p>${getScoreMessage(percentage)}</p>
            `;
            
            showAssessmentFeedback();
            
            document.getElementById('submitAssessmentBtn').style.display = 'none';
            document.getElementById('resetAssessmentBtn').style.display = 'inline-block';
            if (percentage >= 70) {
                document.getElementById('labAccessBtn').style.display = 'inline-block';
            }
        }

        function getScoreMessage(percentage) {
            if (percentage >= 90) return "🎉 Excellent! You have mastered network scanning techniques!";
            if (percentage >= 80) return "👍 Great job! You have a strong understanding of scanning methodologies!";
            if (percentage >= 70) return "✅ Good work! You meet the minimum passing requirement!";
            return "📚 Keep studying! Review the scanning material and try again.";
        }

        function showAssessmentFeedback() {
            const assessmentContainer = document.getElementById('comprehensiveAssessment');
            const questions = assessmentContainer.querySelectorAll('.question');
            
            questions.forEach((question, index) => {
                const options = question.querySelectorAll('.option');
                const userAnswer = assessmentAnswers[index];
                const correctAnswer = assessmentQuestions[index].correct;
                
                options.forEach((option, optIndex) => {
                    option.onclick = null;
                    if (optIndex === correctAnswer) {
                        option.classList.add('correct');
                    } else if (optIndex === userAnswer && optIndex !== correctAnswer) {
                        option.classList.add('incorrect');
                    }
                });
                
                const explanation = document.createElement('div');
                explanation.style.cssText = 'margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--scan-primary);';
                explanation.innerHTML = `<strong>Explanation:</strong> ${assessmentQuestions[index].explanation}`;
                question.appendChild(explanation);
            });
        }

        function resetAssessment() {
            assessmentAnswers = {};
            generateAssessment();
            document.getElementById('assessmentScore').style.display = 'none';
            document.getElementById('submitAssessmentBtn').style.display = 'inline-block';
            document.getElementById('resetAssessmentBtn').style.display = 'none';
            document.getElementById('labAccessBtn').style.display = 'none';
        }

        // Demo functions
        function runPortScanDemo() {
            const terminal = document.getElementById('portScanTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'scanner@kali:~$ nmap -sU -p 53,161,123 192.168.1.100' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'output', text: 'Nmap scan report for dns-server.local (192.168.1.100)' },
                { type: 'output', text: 'Host is up (0.00050s latency).' },
                { type: 'output', text: 'PORT    STATE         SERVICE' },
                { type: 'output', text: '53/udp  open          domain' },
                { type: 'output', text: '123/udp open|filtered ntp' },
                { type: 'output', text: '161/udp open|filtered snmp' },
                { type: 'output', text: 'Nmap done: 1 IP address (1 host up) scanned in 3.15 seconds' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1000);
            });
        }

        function runHostDiscoveryDemo() {
            const terminal = document.getElementById('hostDiscoveryTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'scanner@kali:~$ nmap -PS22,80,443 -PA25,53 192.168.1.0/24' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'output', text: 'Nmap scan report for gateway.local (192.168.1.1)' },
                { type: 'output', text: 'Host is up (0.0008s latency).' },
                { type: 'output', text: 'MAC Address: 00:50:56:C0:00:08 (VMware)' },
                { type: 'output', text: 'Nmap scan report for fileserver.local (192.168.1.150)' },
                { type: 'output', text: 'Host is up (0.0035s latency).' },
                { type: 'output', text: 'MAC Address: 00:0C:29:3E:2A:1F (VMware)' },
                { type: 'info', text: 'Advanced discovery completed: 2 additional hosts found' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1200);
            });
        }

        function runServiceDetectionDemo() {
            const terminal = document.getElementById('serviceDetectionTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'scanner@kali:~$ nmap -sV --version-intensity 9 192.168.1.100' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'output', text: 'Nmap scan report for enterprise-server.local (192.168.1.100)' },
                { type: 'output', text: 'Host is up (0.00050s latency).' },
                { type: 'output', text: 'PORT     STATE SERVICE    VERSION' },
                { type: 'output', text: '21/tcp   open  ftp        vsftpd 3.0.3' },
                { type: 'output', text: '22/tcp   open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.1' },
                { type: 'output', text: '25/tcp   open  smtp       Postfix smtpd' },
                { type: 'output', text: '53/tcp   open  domain     ISC BIND 9.16.1-Ubuntu' },
                { type: 'output', text: '80/tcp   open  http       Apache httpd 2.4.52 ((Ubuntu))' },
                { type: 'output', text: '443/tcp  open  ssl/http   Apache httpd 2.4.52' },
                { type: 'output', text: '993/tcp  open  ssl/imap   Dovecot imapd 2.3.16' },
                { type: 'output', text: '995/tcp  open  ssl/pop3   Dovecot pop3d' },
                { type: 'info', text: 'Intensive version detection completed' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1000);
            });
        }

        function runFirewallEvasionDemo() {
            const terminal = document.getElementById('firewallEvasionTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'scanner@kali:~$ nmap -sS -D RND:5 -f 192.168.1.100' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'info', text: 'Using decoys and fragmentation for evasion' },
                { type: 'output', text: 'Nmap scan report for protected-server.local (192.168.1.100)' },
                { type: 'output', text: 'Host is up (0.065s latency).' },
                { type: 'output', text: 'PORT     STATE    SERVICE' },
                { type: 'output', text: '22/tcp   open     ssh' },
                { type: 'output', text: '80/tcp   open     http' },
                { type: 'output', text: '443/tcp  open     https' },
                { type: 'output', text: '3389/tcp filtered ms-wbt-server' },
                { type: 'info', text: 'Firewall evasion successful - bypassed filtering' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1200);
            });
        }

        function runStealthScanDemo() {
            const terminal = document.getElementById('stealthScanTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'stealth@kali:~$ nmap -sS -T0 -f -D RND:3 --data-length 25 192.168.1.100' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'info', text: 'Ultra-stealth mode: Paranoid timing, fragmentation, decoys' },
                { type: 'output', text: 'Nmap scan report for secure-target.local (192.168.1.100)' },
                { type: 'output', text: 'Host is up (0.25s latency).' },
                { type: 'output', text: 'PORT     STATE    SERVICE' },
                { type: 'output', text: '22/tcp   open     ssh' },
                { type: 'output', text: '80/tcp   open     http' },
                { type: 'output', text: '443/tcp  open     https' },
                { type: 'info', text: 'Stealth scan completed - zero IDS alerts generated' },
                { type: 'prompt', text: 'stealth@kali:~$ ./ai_adaptive_scanner.py --stealth-mode 192.168.1.100' },
                { type: 'output', text: 'AI-Enhanced Stealth Scanner v3.0 - CEH v13' },
                { type: 'output', text: 'Analyzing defensive posture and adapting techniques...' },
                { type: 'info', text: '[AI] IDS patterns learned, evasion optimized' },
                { type: 'info', text: '[AI] Firewall behavior analyzed, bypass strategy selected' },
                { type: 'output', text: 'Adaptive stealth scan complete - perfect stealth maintained' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1200);
            });
        }

        function runVulnScanDemo() {
            const terminal = document.getElementById('vulnScanTerminal');
            terminal.innerHTML = '';
            
            const scenario = [
                { type: 'prompt', text: 'vuln@kali:~$ nmap --script vuln,safe 192.168.1.100' },
                { type: 'output', text: 'Starting Nmap 7.94 ( https://nmap.org )' },
                { type: 'output', text: 'Nmap scan report for vulnerable-server.local (192.168.1.100)' },
                { type: 'output', text: 'Host is up (0.0015s latency).' },
                { type: 'output', text: 'PORT     STATE SERVICE' },
                { type: 'output', text: '21/tcp   open  ftp' },
                { type: 'output', text: '| ftp-vuln-cve2010-4221:' },
                { type: 'output', text: '|   VULNERABLE:' },
                { type: 'output', text: '|   ProFTPD 1.3.2rc3 - 1.3.3b Remote Command Execution' },
                { type: 'output', text: '80/tcp   open  http' },
                { type: 'output', text: '| http-vuln-cve2017-5638:' },
                { type: 'warning', text: '|   VULNERABLE:' },
                { type: 'warning', text: '|   Apache Struts Remote Code Execution' },
                { type: 'output', text: '443/tcp  open  https' },
                { type: 'error', text: '| ssl-vuln-cve2014-0160:' },
                { type: 'error', text: '|   VULNERABLE:' },
                { type: 'error', text: '|   OpenSSL Heartbleed vulnerability' },
                { type: 'info', text: 'Vulnerability scan complete - 3 critical vulnerabilities found' }
            ];
            
            scenario.forEach((line, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `terminal-line ${line.type}`;
                    div.textContent = line.text;
                    terminal.appendChild(div);
                    terminal.scrollTop = terminal.scrollHeight;
                }, index * 1000);
            });
        }

        // Modal functions
        function showModal(content) {
            document.getElementById('modalContent').innerHTML = content;
            const modal = document.getElementById('detailModal');
            modal.style.display = 'block';
            
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('detailModal');
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize
        updateProgress();
    </script>
</body>
</html>
                        '
